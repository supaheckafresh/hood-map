<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Neighborhood Map</title>

    <link rel="stylesheet" href="build/css/css-deps.css">
    <link rel="stylesheet" href="build/css/app.css">


</head>
<body>


<!-- TODO: Separate views into knockout components -->

    <!-- Google Map -->
    <div id="map"></div>

    <!-- Search UI -->
    <div id="overlay-search" class="ui-widget-content container">
        <section id="search-view" class="row">

            <!-- Location searchActivityLocations form -->
            <section data-bind="with: MapViewModel" id="search-location" class="col-xs-6">
                <form data-bind="submit: updateLocation" class="form-inline">
                    <fieldset class="form-group">
                        <input data-bind="value: locationName"
                               class="form-control"
                               type="text"
                               placeholder="Hey, I need a location!"/>
                        <button type="submit" class="btn btn-info search-form">Go</button>
                        <div><small class="text-muted search-form">Where do you want to go?</small></div>
                    </fieldset>
                </form>
            </section>

            <!-- Activities searchActivityLocations form -->
            <section data-bind="with: ActivitiesViewModel" id="search-activities" class="col-xs-6">
                <form data-bind="submit: addActivity" class="form-inline">
                    <fieldset class="form-group">
                        <input data-bind="value: activityQuery"
                               class="form-control"
                               type="text"
                               placeholder="Let's go out!"/>
                        <button type="submit" class="btn btn-success btn-search">Do</button>
                        <div><small class="text-muted">What do you want to do?</small></div>
                    </fieldset>
                </form>
            </section>
        </section>

    </div>


    <!-- Sidebar UI -->
    <div id="overlay-sidebar" class="ui-widget-content container">
        <section id="sidebar" class="col-xs-12">

            <!-- Location overview header -->
            <section data-bind="with: MapViewModel" id="location-overview-view" class="row">
                <section id="location-overview" class="col-xs-12">
                    <h3>Explore <span data-bind="text: locationName"></span></h3>
                </section>
            </section>

            <!-- Filter results -->
            <section id="filter" data-bind="with: LocationsViewModel">
                <form data-bind="submit: preventDefault" class="form-inline">
                    <fieldset class="form-group" data-bind="if: ( $root.ActivitiesViewModel.activities().length > 0 )">
                        <input data-bind="value: filterQuery, valueUpdate: 'afterkeydown'"
                               class="form-control"
                               type="text"
                               placeholder="Filter results"/>
                    </fieldset>
                </form>
            </section>

            <!-- Activities list -->
            <section data-bind="with: ActivitiesViewModel" id="activities-list-view">
                <!-- Reverse a copy of the array to display the newest activity search term at the top -->
                <ul data-bind="foreach: { data: activities().slice().reverse(), as: 'activity' }">
                    <li>
                        <input type="checkbox" data-bind="checked: visible">
                        <span data-bind="text: activity.title"></span>
                    </li>
                </ul>
            </section>


            <section data-bind="with: ActivitiesViewModel" id="activity-location-results">

                <!-- If the filter input is empty, display all of the results -->
                <div id="all-location-results">

                <!-- Reverse a copy of the observable array display the newest activity locations a the top -->
                    <div data-bind="foreach: { data: activities.slice().reverse(), as: 'activity' }"
                         class="location-groups">

                        <div data-bind="if: visible" class="activity-location-group">
                            <h4 data-bind="text: activity.title" class="activity-title"></h4>
                            <ul data-bind="foreach: { data: results, as: 'location' }" class="locations">

                                <li class="location"
                                    data-bind="visible: location.visible,
                                    click: function () { return $root.LocationsViewModel.selectLocation($data) },
                                    css: { 'selected': location.selected }">

                                    <span data-bind="text: ($index() + 1) + '. '"></span>
                                    <a href="#"><span data-bind="text: location.name"></span></a>
                                    <small data-bind="text: location.formatted_address" class="text-muted"></small>
                                </li>

                            </ul>
                        </div>

                    </div>
                </div>
            </section>

        </section>
    </div>


<script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBRiTb3Puay9dUb5VVxiOrlMQ8H-PkVXLw&libraries=places&signed_in=true&callback=initMap">
</script>

<script src="build/js/deps.js" type="text/javascript"></script>
<script src="build/js/app.js" type="text/javascript"></script>


</body>
</html>