!function(){"use strict";var e=function(e){this.title=e,this.results=ko.observableArray(),this.visible=ko.observable(!0),this.checked=ko.observable(!0),this.hasFilterResults=ko.observable()};e.prototype.toggleMarkersVisible=function(){var e=this;if(e.toggleChecked(),e.results().length>0){var o=_.head(e.results());null!==o().marker.getMap()&&(e.mapReference=o().marker.getMap()),_.each(e.results(),function(o){null===o().marker.getMap()?o().marker.setMap(e.mapReference):o().marker.setMap(null)})}return!0},e.prototype.toggleChecked=function(){var e=this;return e.checked(!e.checked()),!0},window.Activity=e}(),function(){"use strict";var e=function(e){this.name=ko.observable(e.name),this.visible=ko.observable(!0),this.selected=ko.observable(!1),this.place_id=ko.observable(e.place_id),this.formatted_address=ko.observable(e.formatted_address),this.geometry=ko.observable(e.geometry),this.types=ko.observableArray(e.types),this.marker=null,this.foursquare_id="",this.foursquareQueryUrl=ko.observable(""),this.checkins=ko.observable()};e.prototype.contains=function(e,o){return o===!0?this.name().includes(e):this.name().toLowerCase().indexOf(e.toLowerCase())>-1},e.prototype.shortLatLng=function(){return Math.round(1e3*this.geometry().location.lat())/1e3+","+Math.round(1e3*this.geometry().location.lng())/1e3},e.prototype.getColor=function(){var e=this.checkins();switch(!0){case e>1e3:return"1";case e>600:return"2";case e>350:return"3";case e>120:return"4";case e>60:return"5";case e>30:return"6";case e>16:return"7";default:return"7"}},e.prototype.foursquareVenueUrl=function(){return this.foursquare_id?"http://foursquare.com/v/"+this.foursquare_id:void 0},window.Location=e}(),function(){"use strict";var e=function(e){var o=this;window.map=null;var t;o.infoWindow=ko.observable(),o.readyState=ko.observable(!1);var i={searchStr:"Long Beach, CA",center:{lat:33.77,lng:-118.194}};o.geolocationName=ko.observable(i.searchStr),o.cachedgeolocationName=ko.observable(i.searchStr),o.currentGeolocation=ko.observable(),o.locationsVm={},o.selectedLocation=ko.observable(),o.updateGeolocation=function(){""!==o.geolocationName().trim()?o.geo(o.geolocationName()):o.geolocationName(o.cachedgeolocationName())},window.initMap=function(){window.map=new google.maps.Map(document.getElementById("map"),{zoom:15,mapTypeId:google.maps.MapTypeId.TERRAIN}),console.log("Google Maps API has been called."),console.log(google.maps),t=new google.maps.Geocoder,o.geo(o.geolocationName()),o.initInfoWindow(),o.placesService=new google.maps.places.PlacesService(map),o.placesService?(console.log("Google Places service has been initialized."),google.maps.event.addListenerOnce(map,"idle",function(){map.center?(o.readyState(!0),console.log("Google Maps has loaded successfully.")):alert("There was a problem loading the map.")})):alert("There was an error initializing Google Places service.")},window.mapInitErrorHandler=function(){console.log(),alert("There was a problem loading Google Maps.")},o.geo=function(e){t.geocode({address:e},function(t,i){i==google.maps.GeocoderStatus.OK?(o.cachedgeolocationName(e),map.setCenter(t[0].geometry.location),o.currentGeolocation({center:{lat:t[0].geometry.location.lat(),lng:t[0].geometry.location.lng()}}),o.initInfoWindow(),console.log("Location has been set to: "+e)):(o.geolocationName(o.cachedgeolocationName()),alert("Geocoding was unsuccessful for the following reason: "+i))})},o.initInfoWindow=function(){o.infoWindow(new google.maps.InfoWindow),$.ajax("./build/components/infowindow/infowindow.html").done(function(e){o.infoWindow().setContent(e),o.infoWindow().open(null);var t=!1;google.maps.event.addListener(o.infoWindow(),"domready",function(){t===!1&&(ko.applyBindings(o,document.getElementById("infowindow-overlay")),t=!0)}),google.maps.event.addListener(o.infoWindow(),"closeclick",function(){t=!1,o.initInfoWindow()})})},o.resetInfoWindow=function(){o.infoWindow().open(null),o.initInfoWindow()},o.centerMapAt=function(e){var o=new google.maps.LatLng(e.geometry().location.lat(),e.geometry().location.lng());map.panTo(o)},o.addMarker=function(e,t,i){var n=t().visible()?map:null,a=new google.maps.Marker({map:n,title:e().name(),icon:"build/images/markers/marker_"+i+".png",position:e().geometry().location,id:e().place_id(),animation:google.maps.Animation.DROP});return function(t){google.maps.event.addListener(t,"click",function(){o.locationsVm.selectLocation(e()),o.showInfoWindow(e()),o.bounceAnimate(this)})}(a),a},o.showInfoWindow=function(e){o.infoWindow().open(map,e.marker)},o.showMarkersForVisibleActivities=function(e){_.each(e(),function(e){e().visible()===!0&&_.each(e().results(),function(e){o.showMarker(e)})})},o.hideMarker=function(e){e().marker.setMap(null)},o.showMarker=function(e){e().marker.getMap()!=map&&o.dropAnimate(e().marker)},o.dropAnimate=function(e){e.setMap(map),e.setAnimation(google.maps.Animation.DROP)},o.bounceAnimate=function(e){e.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){e.setAnimation(null)},2125)}};window.MapViewModel=e}(),function(){"use strict";var e=function(){var e=this;e.makeQueryUrl=function(e){var o="https://api.foursquare.com/v2/venues/search",t="?client_id=PUXBJCP4B4HB2KIDIGQPHXEBAKWZPZO4HOWJZAJT45MOYWDO",i="&client_secret=D3NFA3PT5NC5440E5SJEOBJYYDN1BY20AASGXGF012F5Y1ND",n="&v=20130815",a="&ll="+e().shortLatLng(),s="&query="+e().name().split(" ").join("%20"),r="&limit=1";e().foursquareQueryUrl(o+t+i+n+a+s+r)},e.getCheckinsCountFor=function(e,o,t){ko.computed(function(){$.getJSON(e().foursquareQueryUrl()).then(function(i){if(i.response.venues.length>0){e().foursquare_id=i.response.venues[0].id;var n=i.response.venues[0].stats.checkinsCount;n?e().checkins(n):e().checkins(0)}else e().checkins(0);var a=e().getColor();e().marker=t(e,o,a)}).fail(function(){alert("There was a problem retrieving Foursquare check-ins for "+e().name())})},this)}};window.foursquareService=e}(),function(){"use strict";var e=function(e,o){var t=this;t.filterQuery=ko.observable(""),t.selectedLocation=ko.observable("hello"),t.activities=ko.observableArray([]),t.searchLocations=function(o){function i(i,a){if(a===google.maps.places.PlacesServiceStatus.OK&&i.length>0){var s=n(i);s.length>0?(_.each(s,function(i){var n=ko.observable(new Location(i));t.requestFoursquareData(n,o,e.addMarker),o().results.push(n)}),o().noResultsForLastGeolocation&&(o().noResultsForLastGeolocation=!1,o().visible(!0)),t.activities.push(o)):(o().visible(!1),o().noResultsForLastGeolocation=!0,t.activities.push(o),alert("Sorry, there are no locations for "+o().title+" in the current map bounds."))}else alert("Sorry, there was a problem retrieving results for the following reason: "+a)}function n(e){var o,t,i=[];return _.each(e,function(e){o=e.geometry.location.lat(),t=e.geometry.location.lng(),a.H.H<o&&o<a.H.j&&a.j.H>t&&t>a.j.j&&i.push(e)}),i}var a=window.map.getBounds();e.placesService.textSearch({bounds:a,query:o().title},i)},t.requestFoursquareData=function(e,t,i){o.makeQueryUrl(e),o.getCheckinsCountFor(e,t,i)},t.filterQuery.subscribe(function(){function o(){var o;_.each(t.activities(),function(i){i().results().length>0&&(_.each(i().results(),function(n){n().contains(t.filterQuery())?(n().visible(!0),i().hasFilterResults(!0),i().checked()===!0&&(e.showMarker(n),n().selected()===!0&&e.infoWindow().open(window.map,n().marker))):(n().visible(!1),e.hideMarker(n),n().selected()===!0&&e.resetInfoWindow(),o=!1,i().hasFilterResults(!1))}),_.some(i().results(),function(e){e().visible()&&i().checked()===!0&&(o=!0,i().hasFilterResults(!0))}),i().visible(o))})}function i(){return""===t.filterQuery().trim()}function n(){function e(e){0===e().results().length&&e().visible(!1),e().checked()===!0?e().results().length>0&&(e().visible(!0),e().hasFilterResults(!0)):e().results().length>0&&e().hasFilterResults(!0)}_.each(t.activities(),function(o){_.each(o().results(),function(e){e().visible(!0)}),e(o)})}i()?(n(),e.showMarkersForVisibleActivities(t.activities)):o()}),t.preventDefault=function(){},e.currentGeolocation.subscribe(function(){var e;t.activities()&&(e=t.activities()),_.each(t.activities(),function(e){_.each(e().results(),function(e){e().marker.setMap(null)}),e().results([])}),t.activities([]),_.each(e,function(e){t.searchLocations(e)})}),t.selectLocation=function(o){t.clearCurrentSelections(),o.selected(!0),t.selectedLocation(o),e.showInfoWindow(o),e.centerMapAt(o),e.bounceAnimate(o.marker)},t.clearCurrentSelections=function(){_.each(t.activities(),function(e){_.each(e().results(),function(e){e().selected(!1)})})},t.assignColorsToLocations=function(){},t.getReferenceToActivitiesObject=function(e){t.activities=e},t.passSelfToMapVm=function(){e.locationsVm=t},t.passSelfToMapVm(),t.passSelectedLocationToMapVm=function(){e.selectedLocation(t.selectedLocation)},t.selectedLocation.subscribe(function(){t.passSelectedLocationToMapVm()})};window.LocationsViewModel=e}(),function(){"use strict";var e=function(e,o){var t=this;t.defaultActivities=["Coffee","Vegetarian","Park","Mexican","Art Gallery"],t.activities=ko.observableArray(),t.activityQuery=ko.observable(),e.readyState.subscribe(function(){e.readyState()===!0&&t.displayDefaultActivities()}),t.displayDefaultActivities=function(){t.passReferenceToLocationsVm(),_.each(t.defaultActivities,function(e){var t=ko.observable(new Activity(e));o.searchLocations(t)})},t.addActivity=function(){var e=ko.observable(new Activity(t.activityQuery()));o.searchLocations(e),t.activityQuery("")},t.passReferenceToLocationsVm=function(){o.getReferenceToActivitiesObject(t.activities)},t.activities.subscribe(function(){t.passReferenceToLocationsVm()}),t.resetInfoWindowWhenSelectedLocationToggledVisible=function(o){return _.each(o.results(),function(t){if(t().selected()===!0)switch(o.checked()){case!1:e.resetInfoWindow();break;case!0:e.infoWindow().open(window.map,t().marker)}}),!0}};window.ActivitiesViewModel=e}(),function(){"use strict";var e=function(){var e=this;e.foursquareService=new foursquareService,e.MapViewModel=new MapViewModel(e.foursquareService),e.LocationsViewModel=new LocationsViewModel(e.MapViewModel,e.foursquareService),e.ActivitiesViewModel=new ActivitiesViewModel(e.MapViewModel,e.LocationsViewModel)};window.AppViewModel=e}(),function(){"use strict";function e(e){var t,i,n,a;_.each(e,function(e){var s="#overlay-"+e;t=$("<div>"),i="./build/components/"+e+"/"+e+".html",n="#"+e,t.load(i,n,function(){a=$(this).prop("outerHTML"),$(s).append(a),ko.applyBindings(o,document.getElementById(e))})})}var o=new AppViewModel;e(["searchbar","sidebar"]),$(document).ready(function(){$("#overlay-searchbar").draggable(),$("#overlay-sidebar").draggable(),$(document).on("click","#toggle-minimize-sidebar",function(){$(this).parent().toggleClass("show")})})}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFjdGl2aXRpZXMvYWN0aXZpdHkuY29uc3RydWN0b3IuanMiLCJsb2NhdGlvbnMvbG9jYXRpb24uY29uc3RydWN0b3IuanMiLCJtYXAudmlld21vZGVsLmpzIiwiZm91cnNxdWFyZS5zZXJ2aWNlLmpzIiwibG9jYXRpb25zLnZpZXdtb2RlbC5qcyIsImFjdGl2aXRpZXMudmlld21vZGVsLmpzIiwiYXBwLnZpZXdtb2RlbC5qcyIsImFwcC5pbml0LmpzIl0sIm5hbWVzIjpbIkFjdGl2aXR5IiwiYWN0aXZpdHlRdWVyeSIsInRoaXMiLCJ0aXRsZSIsInJlc3VsdHMiLCJrbyIsIm9ic2VydmFibGVBcnJheSIsInZpc2libGUiLCJvYnNlcnZhYmxlIiwiY2hlY2tlZCIsImhhc0ZpbHRlclJlc3VsdHMiLCJwcm90b3R5cGUiLCJ0b2dnbGVNYXJrZXJzVmlzaWJsZSIsInNlbGYiLCJ0b2dnbGVDaGVja2VkIiwibGVuZ3RoIiwiZmlyc3RMb2NhdGlvbiIsIl8iLCJoZWFkIiwibWFya2VyIiwiZ2V0TWFwIiwibWFwUmVmZXJlbmNlIiwiZWFjaCIsImxvY2F0aW9uIiwic2V0TWFwIiwid2luZG93IiwiTG9jYXRpb24iLCJkYXRhIiwibmFtZSIsInNlbGVjdGVkIiwicGxhY2VfaWQiLCJmb3JtYXR0ZWRfYWRkcmVzcyIsImdlb21ldHJ5IiwidHlwZXMiLCJmb3Vyc3F1YXJlX2lkIiwiZm91cnNxdWFyZVF1ZXJ5VXJsIiwiY2hlY2tpbnMiLCJjb250YWlucyIsInN0ciIsImNhc2VTZW5zaXRpdmUiLCJpbmNsdWRlcyIsInRvTG93ZXJDYXNlIiwiaW5kZXhPZiIsInNob3J0TGF0TG5nIiwiTWF0aCIsInJvdW5kIiwibGF0IiwibG5nIiwiZ2V0Q29sb3IiLCJmb3Vyc3F1YXJlVmVudWVVcmwiLCJNYXBWaWV3TW9kZWwiLCJmb3Vyc3F1YXJlU2VydmljZSIsInZtIiwibWFwIiwiZ2VvY29kZXIiLCJpbmZvV2luZG93IiwicmVhZHlTdGF0ZSIsImxvbmdCZWFjaENBIiwic2VhcmNoU3RyIiwiY2VudGVyIiwiZ2VvbG9jYXRpb25OYW1lIiwiY2FjaGVkZ2VvbG9jYXRpb25OYW1lIiwiY3VycmVudEdlb2xvY2F0aW9uIiwibG9jYXRpb25zVm0iLCJzZWxlY3RlZExvY2F0aW9uIiwidXBkYXRlR2VvbG9jYXRpb24iLCJ0cmltIiwiZ2VvIiwiaW5pdE1hcCIsImdvb2dsZSIsIm1hcHMiLCJNYXAiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiem9vbSIsIm1hcFR5cGVJZCIsIk1hcFR5cGVJZCIsIlRFUlJBSU4iLCJjb25zb2xlIiwibG9nIiwiR2VvY29kZXIiLCJpbml0SW5mb1dpbmRvdyIsInBsYWNlc1NlcnZpY2UiLCJwbGFjZXMiLCJQbGFjZXNTZXJ2aWNlIiwiZXZlbnQiLCJhZGRMaXN0ZW5lck9uY2UiLCJhbGVydCIsIm1hcEluaXRFcnJvckhhbmRsZXIiLCJnZW9jb2RlIiwiYWRkcmVzcyIsInN0YXR1cyIsIkdlb2NvZGVyU3RhdHVzIiwiT0siLCJzZXRDZW50ZXIiLCJJbmZvV2luZG93IiwiJCIsImFqYXgiLCJkb25lIiwidGVtcGxhdGUiLCJzZXRDb250ZW50Iiwib3BlbiIsImtvQm91bmQiLCJhZGRMaXN0ZW5lciIsImFwcGx5QmluZGluZ3MiLCJyZXNldEluZm9XaW5kb3ciLCJjZW50ZXJNYXBBdCIsImxhdExuZyIsIkxhdExuZyIsInBhblRvIiwiYWRkTWFya2VyIiwiYWN0aXZpdHkiLCJjb2xvciIsInZpc2libGVTdGF0ZSIsIk1hcmtlciIsImljb24iLCJwb3NpdGlvbiIsImlkIiwiYW5pbWF0aW9uIiwiQW5pbWF0aW9uIiwiRFJPUCIsIm1hcmtlckNvcHkiLCJzZWxlY3RMb2NhdGlvbiIsInNob3dJbmZvV2luZG93IiwiYm91bmNlQW5pbWF0ZSIsInNob3dNYXJrZXJzRm9yVmlzaWJsZUFjdGl2aXRpZXMiLCJhY3Rpdml0aWVzIiwic2hvd01hcmtlciIsImhpZGVNYXJrZXIiLCJkcm9wQW5pbWF0ZSIsInNldEFuaW1hdGlvbiIsIkJPVU5DRSIsInNldFRpbWVvdXQiLCJmb3Vyc3F1YXJlIiwibWFrZVF1ZXJ5VXJsIiwiYmFzZVVybCIsImNsaWVudElkIiwiY2xpZW50U2VjcmV0IiwidmVyc2lvbiIsInF1ZXJ5Iiwic3BsaXQiLCJqb2luIiwibGltaXQiLCJnZXRDaGVja2luc0NvdW50Rm9yIiwiY2FsbGJhY2siLCJjb21wdXRlZCIsImdldEpTT04iLCJ0aGVuIiwicmVzIiwicmVzcG9uc2UiLCJ2ZW51ZXMiLCJsb2NhdGlvbkNoZWNraW5zIiwic3RhdHMiLCJjaGVja2luc0NvdW50IiwiZmFpbCIsIkxvY2F0aW9uc1ZpZXdNb2RlbCIsIm1hcFZtIiwiZmlsdGVyUXVlcnkiLCJzZWFyY2hMb2NhdGlvbnMiLCJQbGFjZXNTZXJ2aWNlU3RhdHVzIiwiaW5Cb3VuZExvY2F0aW9ucyIsInN1cHByZXNzT3V0T2ZCb3VuZHNMb2NhdGlvbnMiLCJsb2NhdGlvbkRhdGEiLCJsb2MiLCJyZXF1ZXN0Rm91cnNxdWFyZURhdGEiLCJwdXNoIiwibm9SZXN1bHRzRm9yTGFzdEdlb2xvY2F0aW9uIiwibG9jYXRpb25zIiwibG9jTGF0IiwibG9jTG5nIiwibWFwQm91bmRzIiwiSCIsImoiLCJnZXRCb3VuZHMiLCJ0ZXh0U2VhcmNoIiwiYm91bmRzIiwic3Vic2NyaWJlIiwiZmlsdGVyUmVzdWx0cyIsImFjdGl2aXR5VmlzaWJpbGl0eUR1cmluZ0ZpbHRlciIsInNvbWUiLCJmaWx0ZXJJbnB1dElzRW1wdHkiLCJ1bmZpbHRlclJlc3VsdHMiLCJyZXNldEluaXRpYWxWaXNpYmlsaXR5IiwicHJldmVudERlZmF1bHQiLCJjb3B5IiwiY2xlYXJDdXJyZW50U2VsZWN0aW9ucyIsImFzc2lnbkNvbG9yc1RvTG9jYXRpb25zIiwiZ2V0UmVmZXJlbmNlVG9BY3Rpdml0aWVzT2JqZWN0IiwicGFzc1NlbGZUb01hcFZtIiwicGFzc1NlbGVjdGVkTG9jYXRpb25Ub01hcFZtIiwiQWN0aXZpdGllc1ZpZXdNb2RlbCIsImRlZmF1bHRBY3Rpdml0aWVzIiwiZGlzcGxheURlZmF1bHRBY3Rpdml0aWVzIiwicGFzc1JlZmVyZW5jZVRvTG9jYXRpb25zVm0iLCJhY3Rpdml0eU5hbWUiLCJhZGRBY3Rpdml0eSIsInJlc2V0SW5mb1dpbmRvd1doZW5TZWxlY3RlZExvY2F0aW9uVG9nZ2xlZFZpc2libGUiLCJBcHBWaWV3TW9kZWwiLCJkaXNwbGF5Q29tcG9uZW50cyIsImNvbXBvbmVudHMiLCIkY29tcG9uZW50IiwidGVtcGxhdGVVcmwiLCJodG1sIiwiY29tcG9uZW50IiwiY29udGFpbmVyIiwibG9hZCIsInByb3AiLCJhcHBlbmQiLCJhcHAiLCJyZWFkeSIsImRyYWdnYWJsZSIsIm9uIiwicGFyZW50IiwidG9nZ2xlQ2xhc3MiXSwibWFwcGluZ3MiOiJDQUNBLFdBRUEsWUFFQSxJQUFBQSxHQUFBLFNBQUFDLEdBRUFDLEtBQUFDLE1BQUFGLEVBQ0FDLEtBQUFFLFFBQUFDLEdBQUFDLGtCQUNBSixLQUFBSyxRQUFBRixHQUFBRyxZQUFBLEdBR0FOLEtBQUFPLFFBQUFKLEdBQUFHLFlBQUEsR0FHQU4sS0FBQVEsaUJBQUFMLEdBQUFHLGFBR0FSLEdBQUFXLFVBQUFDLHFCQUFBLFdBRUEsR0FBQUMsR0FBQVgsSUFHQSxJQUZBVyxFQUFBQyxnQkFFQUQsRUFBQVQsVUFBQVcsT0FBQSxFQUFBLENBRUEsR0FBQUMsR0FBQUMsRUFBQUMsS0FBQUwsRUFBQVQsVUFDQSxRQUFBWSxJQUFBRyxPQUFBQyxXQUNBUCxFQUFBUSxhQUFBTCxJQUFBRyxPQUFBQyxVQUdBSCxFQUFBSyxLQUFBVCxFQUFBVCxVQUFBLFNBQUFtQixHQUNBLE9BQUFBLElBQUFKLE9BQUFDLFNBQ0FHLElBQUFKLE9BQUFLLE9BQUFYLEVBQUFRLGNBR0FFLElBQUFKLE9BQUFLLE9BQUEsUUFJQSxPQUFBLEdBR0F4QixFQUFBVyxVQUFBRyxjQUFBLFdBQ0EsR0FBQUQsR0FBQVgsSUFFQSxPQURBVyxHQUFBSixTQUFBSSxFQUFBSixZQUNBLEdBS0FnQixPQUFBekIsU0FBQUEsS0NqREEsV0FFQSxZQUVBLElBQUEwQixHQUFBLFNBQUFDLEdBRUF6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QUUsRUFBQUQsbUJBQ0FDLEVBQUEwSSxvQkFBQSxHQUFBQSxxQkFBQTFJLEVBQUFGLGFBQUFFLEVBQUF1RyxvQkFJQWxJLFFBQUE0SyxhQUFBQSxLQ2xCQSxXQUVBLFlBaUJBLFNBQUFDLEdBQUFDLEdBRUEsR0FBQUMsR0FBQUMsRUFBQXBGLEVBQUFxRixDQUNBekwsR0FBQUssS0FBQWlMLEVBQUEsU0FBQUksR0FFQSxHQUFBQyxHQUFBLFlBQUFELENBQ0FILEdBQUF4RyxFQUFBLFNBQ0F5RyxFQUFBLHNCQUFBRSxFQUFBLElBQUFBLEVBQUEsUUFDQXRGLEVBQUEsSUFBQXNGLEVBRUFILEVBQUFLLEtBQUFKLEVBQUFwRixFQUFBLFdBQ0FxRixFQUFBMUcsRUFBQTlGLE1BQUE0TSxLQUFBLGFBQ0E5RyxFQUFBNEcsR0FBQUcsT0FBQUwsR0FFQXJNLEdBQUFtRyxjQUFBd0csRUFBQXhJLFNBQUFDLGVBQUFrSSxRQTFCQSxHQUFBSyxHQUFBLEdBQUFYLGFBTUFDLElBQUEsWUFBQSxZQThCQXRHLEVBQUF4QixVQUFBeUksTUFDQSxXQUVBakgsRUFBQSxzQkFBQWtILFlBQ0FsSCxFQUFBLG9CQUFBa0gsWUFFQWxILEVBQUF4QixVQUFBMkksR0FBQSxRQUFBLDJCQUFBLFdBQ0FuSCxFQUFBOUYsTUFBQWtOLFNBQUFDLFlBQUEiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXHJcbihmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIHZhciBBY3Rpdml0eSA9IGZ1bmN0aW9uIEFjdGl2aXR5KGFjdGl2aXR5UXVlcnkpIHtcclxuXHJcbiAgICAgICAgdGhpcy50aXRsZSA9IGFjdGl2aXR5UXVlcnk7XHJcbiAgICAgICAgdGhpcy5yZXN1bHRzID0ga28ub2JzZXJ2YWJsZUFycmF5KCk7XHJcbiAgICAgICAgdGhpcy52aXNpYmxlID0ga28ub2JzZXJ2YWJsZSh0cnVlKTtcclxuXHJcbiAgICAgICAgLy8gV2UgdXNlIGBjaGVja2VkYCB0byBkZXRlcm1pbmUgaWYgYW4gYWN0aXZpdHkgd2FzIGluaXRpYWxseSB2aXNpYmxlIHdoZW4gcHJpb3IgdG8gYXBwbHlpbmcgdGhlIGZpbHRlciBxdWVyeS5cclxuICAgICAgICB0aGlzLmNoZWNrZWQgPSBrby5vYnNlcnZhYmxlKHRydWUpO1xyXG5cclxuICAgICAgICAvLyBXZSB1c2UgYGhhc0ZpbHRlclJlc3VsdHNgIHRvIGRldGVybWluZSBpZiB0aGUgYWN0aXZpdHkgY2hlY2tib3ggc2hvdWxkIGJlIGRpc2FibGVkLlxyXG4gICAgICAgIHRoaXMuaGFzRmlsdGVyUmVzdWx0cyA9IGtvLm9ic2VydmFibGUoKTtcclxuICAgIH07XHJcblxyXG4gICAgQWN0aXZpdHkucHJvdG90eXBlLnRvZ2dsZU1hcmtlcnNWaXNpYmxlID0gZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgc2VsZi50b2dnbGVDaGVja2VkKCk7XHJcblxyXG4gICAgICAgIGlmIChzZWxmLnJlc3VsdHMoKS5sZW5ndGggPiAwKSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgZmlyc3RMb2NhdGlvbiA9IF8uaGVhZChzZWxmLnJlc3VsdHMoKSk7XHJcbiAgICAgICAgICAgIGlmICggZmlyc3RMb2NhdGlvbigpLm1hcmtlci5nZXRNYXAoKSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5tYXBSZWZlcmVuY2UgPSBmaXJzdExvY2F0aW9uKCkubWFya2VyLmdldE1hcCgpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfLmVhY2goc2VsZi5yZXN1bHRzKCksIGZ1bmN0aW9uIChsb2NhdGlvbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGxvY2F0aW9uKCkubWFya2VyLmdldE1hcCgpID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24oKS5tYXJrZXIuc2V0TWFwKHNlbGYubWFwUmVmZXJlbmNlKTtcclxuXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uKCkubWFya2VyLnNldE1hcChudWxsKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfTtcclxuXHJcbiAgICBBY3Rpdml0eS5wcm90b3R5cGUudG9nZ2xlQ2hlY2tlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgc2VsZi5jaGVja2VkKCAhKHNlbGYuY2hlY2tlZCgpKSk7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9O1xyXG5cclxuXHJcblxyXG4gICAgd2luZG93LkFjdGl2aXR5ID0gQWN0aXZpdHk7XHJcblxyXG59KSgpO1xyXG5cclxuXHJcbiIsIlxyXG4oZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICB2YXIgTG9jYXRpb24gPSBmdW5jdGlvbiBMb2NhdGlvbihkYXRhKSB7XHJcblxyXG4gICAgICAgIHRoaXMubmFtZSA9IGtvLm9ic2VydmFibGUoZGF0YS5uYW1lKTtcclxuICAgICAgICB0aGlzLnZpc2libGUgPSBrby5vYnNlcnZhYmxlKHRydWUpO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWQgPSBrby5vYnNlcnZhYmxlKGZhbHNlKTtcclxuICAgICAgICB0aGlzLnBsYWNlX2lkID0ga28ub2JzZXJ2YWJsZShkYXRhLnBsYWNlX2lkKTtcclxuICAgICAgICB0aGlzLmZvcm1hdHRlZF9hZGRyZXNzID0ga28ub2JzZXJ2YWJsZShkYXRhLmZvcm1hdHRlZF9hZGRyZXNzKTtcclxuICAgICAgICB0aGlzLmdlb21ldHJ5ID0ga28ub2JzZXJ2YWJsZShkYXRhLmdlb21ldHJ5KTtcclxuICAgICAgICB0aGlzLnR5cGVzID0ga28ub2JzZXJ2YWJsZUFycmF5KGRhdGEudHlwZXMpO1xyXG4gICAgICAgIHRoaXMubWFya2VyID0gbnVsbDtcclxuICAgICAgICB0aGlzLmZvdXJzcXVhcmVfaWQgPSAnJztcclxuXHJcbiAgICAgICAgdGhpcy5mb3Vyc3F1YXJlUXVlcnlVcmwgPSBrby5vYnNlcnZhYmxlKCcnKTtcclxuXHJcbiAgICAgICAgdGhpcy5jaGVja2lucyA9IGtvLm9ic2VydmFibGUoKTtcclxuICAgIH07XHJcblxyXG4vLyBUT0RPOiBBbHNvIHNlYXJjaCBmb3IgYHN0cmAgd2l0aGluIGBMb2NhdGlvbi50eXBlc2AuXHJcbiAgICBMb2NhdGlvbi5wcm90b3R5cGUuY29udGFpbnMgPSBmdW5jdGlvbiAoc3RyLCBjYXNlU2Vuc2l0aXZlKSB7XHJcbiAgICAgICAgaWYgKGNhc2VTZW5zaXRpdmUgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMubmFtZSgpLmluY2x1ZGVzKHN0cik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMubmFtZSgpLnRvTG93ZXJDYXNlKCkuaW5kZXhPZihzdHIudG9Mb3dlckNhc2UoKSkgPiAtMTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIExvY2F0aW9uLnByb3RvdHlwZS5zaG9ydExhdExuZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gKE1hdGgucm91bmQodGhpcy5nZW9tZXRyeSgpLmxvY2F0aW9uLmxhdCgpICogMTAwMCkgLyAxMDAwKSArICcsJyArXHJcbiAgICAgICAgICAgICAgICAoTWF0aC5yb3VuZCh0aGlzLmdlb21ldHJ5KCkubG9jYXRpb24ubG5nKCkgKiAxMDAwKSAvIDEwMDApO1xyXG4gICAgfTtcclxuXHJcbiAgICAvLyBJIGtub3cgdGhpcyBzd2l0Y2ggaXMgdGVycmlibGUsIGJ1dCBJIHVzZWQgaW4gcGxhY2Ugb2YgYSBmb3JtdWxhIGJlY2F1c2UgSSB3YW50ZWQgdG8gYmUgYWJsZSB0byBlYXNpbHkgdHdlYWsgdGhlXHJcbiAgICAvLyB0aHJlc2hvbGRzICh0aGVzZSBhcmUgYXJiaXRyYXJ5KSB3aGVyZSBkaWZmZXJlbnQgbWFya2VyIGNvbG9ycyBhcmUgdXNlZC5cclxuICAgIExvY2F0aW9uLnByb3RvdHlwZS5nZXRDb2xvciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgY2hlY2tpbnMgPSB0aGlzLmNoZWNraW5zKCk7XHJcbiAgICAgICAgc3dpdGNoICh0cnVlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgKGNoZWNraW5zID4gMTAwMCk6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJzEnO1xyXG4gICAgICAgICAgICBjYXNlIChjaGVja2lucyA+IDYwMCk6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJzInO1xyXG4gICAgICAgICAgICBjYXNlIChjaGVja2lucyA+IDM1MCk6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJzMnO1xyXG4gICAgICAgICAgICBjYXNlIChjaGVja2lucyA+IDEyMCk6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJzQnO1xyXG4gICAgICAgICAgICBjYXNlIChjaGVja2lucyA+IDYwKTpcclxuICAgICAgICAgICAgICAgIHJldHVybiAnNSc7XHJcbiAgICAgICAgICAgIGNhc2UgKGNoZWNraW5zID4gMzApOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICc2JztcclxuICAgICAgICAgICAgY2FzZSAoY2hlY2tpbnMgPiAxNik6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJzcnO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICc3JztcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIExvY2F0aW9uLnByb3RvdHlwZS5mb3Vyc3F1YXJlVmVudWVVcmwgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZm91cnNxdWFyZV9pZClcclxuICAgICAgICAgICAgcmV0dXJuICdodHRwOi8vZm91cnNxdWFyZS5jb20vdi8nICsgdGhpcy5mb3Vyc3F1YXJlX2lkO1xyXG4gICAgfTtcclxuXHJcbiAgICB3aW5kb3cuTG9jYXRpb24gPSBMb2NhdGlvbjtcclxuXHJcbn0pKCk7XHJcbiIsIlxyXG4oZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICB2YXIgTWFwVmlld01vZGVsID0gZnVuY3Rpb24oZm91cnNxdWFyZVNlcnZpY2UpIHtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVG9wLWxldmVsIHZhcmlhYmxlcyBhbmQgcHJvcGVydGllcyBmb3IgYE1hcFZpZXdNb2RlbCgpYFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XHJcblxyXG4gICAgICAgIC8vIEluaXRpYWxpemUgYG1hcGAsIGBpbmZvV2luZG93YCwgYW5kIGBnZW9jb2RlcmAgdmFyaWFibGVzIHdoaWNoIGFyZSBuZWVkZWQgaW4gb3VyIGBpbml0TWFwKClgIGNhbGxiYWNrIGZ1bmN0aW9uLlxyXG4gICAgICAgIHdpbmRvdy5tYXAgPSBudWxsO1xyXG4gICAgICAgIHZhciBnZW9jb2RlcjtcclxuXHJcbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBlbXB0eSBwcm9wZXJ0eSB0byBob2xkIHRoZSBtYXJrZXIgaW5mbyB3aW5kb3cuXHJcbiAgICAgICAgdm0uaW5mb1dpbmRvdyA9IGtvLm9ic2VydmFibGUoKTtcclxuXHJcbiAgICAgICAgLy8gYHJlYWR5U3RhdGVgIGlzIHNldCB0byBgdHJ1ZWAgaW5zaWRlIHRoZSBgaW5pdE1hcCgpYCBmdW5jdGlvbiBvbmx5IHdoZW4gdGhlIG1hcCBpcyBpbiBgaWRsZWAgc3RhdGUgKGluZGljYXRpbmdcclxuICAgICAgICAvLyB0aGF0IGl0IGhhcyBzdWNjZXNzZnVsbHkgbG9hZGVkKSwgYW5kIGFsc28gb25jZSBHb29nbGUgUGxhY2VzIFNlcnZpY2UgaXMgaW5pdGlhbGl6ZWQuIGBBY3Rpdml0aWVzVmlld01vZGVsYFxyXG4gICAgICAgIC8vIGxpc3RlbnMgZm9yIGEgY2hhbmdlIHRvIGByZWFkeVN0YXRlYCBpbiBvcmRlciB0byBleGVjdXRlIHRoZSBkZWZhdWx0IGFjdGl2aXRpZXMgR29vZ2xlIFBsYWNlcyBxdWVyeSAob3RoZXJ3aXNlXHJcbiAgICAgICAgLy8gdGhlIHNlYXJjaCBleGVjdXRlcyBiZWZvcmUgdGhlIG1hcCBhbmQgUGxhY2VzIFNlcnZpY2UgYXJlIGZ1bGx5IGluaXRpYWxpemVkICYgd2UnbGwgc2VlIGVycm9ycykuXHJcbiAgICAgICAgdm0ucmVhZHlTdGF0ZSA9IGtvLm9ic2VydmFibGUoZmFsc2UpO1xyXG5cclxuICAgICAgICAvLyBEZWZhdWx0IGxvY2F0aW9uXHJcbiAgICAgICAgdmFyIGxvbmdCZWFjaENBID0ge1xyXG4gICAgICAgICAgICBzZWFyY2hTdHI6ICdMb25nIEJlYWNoLCBDQScsXHJcbiAgICAgICAgICAgIGNlbnRlcjoge2xhdDogMzMuNzcwLCBsbmc6IC0xMTguMTk0fVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIEluaXRpYWxpemUgYGdlb2xvY2F0aW9uTmFtZWAgb2JzZXJ2YWJsZSB3aXRoIGEgZGVmYXVsdCBsb2NhdGlvbiB0ZXh0IHRvIGFwcGVhciBpbiB0aGUgbG9jYXRpb24gc2VhcmNoIGlucHV0LlxyXG4gICAgICAgIHZtLmdlb2xvY2F0aW9uTmFtZSA9IGtvLm9ic2VydmFibGUobG9uZ0JlYWNoQ0Euc2VhcmNoU3RyKTtcclxuICAgICAgICB2bS5jYWNoZWRnZW9sb2NhdGlvbk5hbWUgPSBrby5vYnNlcnZhYmxlKGxvbmdCZWFjaENBLnNlYXJjaFN0cik7XHJcblxyXG4gICAgICAgIC8vIEluaXRpYWxpemUgYW4gZW1wdHkga28ub2JzZXJ2YWJsZSBvYmplY3QgdG8gc3RvcmUgdGhlIGN1cnJlbnQgbG9jYXRpb24uXHJcbiAgICAgICAgdm0uY3VycmVudEdlb2xvY2F0aW9uID0ga28ub2JzZXJ2YWJsZSgpO1xyXG5cclxuICAgICAgICAvLyBXZSB3aWxsIHVzZSBgbG9jYXRpb25zVm1gIGFzIGEgcmVmZXJlbmNlIHRvIGBMb2NhdGlvbnNWaWV3TW9kZWwoKWAuIFRoZXNlIHByb3BlcnRpZXMgYXJlIHVzZWQgZm9yIGRhdGFcclxuICAgICAgICAvLyBiaW5kaW5nIGluc2lkZSBvZiBsb2NhdGlvbiBpbmZvIHdpbmRvd3MuXHJcbiAgICAgICAgdm0ubG9jYXRpb25zVm0gPSB7fTtcclxuICAgICAgICB2bS5zZWxlY3RlZExvY2F0aW9uID0ga28ub2JzZXJ2YWJsZSgpO1xyXG5cclxuXHJcbiAgICAgICAgLyoqKlxyXG4gICAgICAgICAqIEdvb2dsZSBNYXBzIEFQSSBjYWxsc1xyXG4gICAgICAgICAqL1xyXG5cclxuICAgICAgICAvLyBgdXBkYXRlR2VvbG9jYXRpb24oKWAgaXMgdGhlIHN1Ym1pdCBmdW5jdGlvbiBjYWxsZWQgZnJvbSB0aGUgbG9jYXRpb24gZm9ybSBpbiAnc2VhcmNoYmFyLmh0bWwuJ1xyXG4gICAgICAgIHZtLnVwZGF0ZUdlb2xvY2F0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAodm0uZ2VvbG9jYXRpb25OYW1lKCkudHJpbSgpICE9PSAnJykge1xyXG4gICAgICAgICAgICAgICAgdm0uZ2VvKHZtLmdlb2xvY2F0aW9uTmFtZSgpKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZtLmdlb2xvY2F0aW9uTmFtZSh2bS5jYWNoZWRnZW9sb2NhdGlvbk5hbWUoKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvLyBJbml0aWFsaXplIG91ciBtYXAuIFRoaXMgaXMgdGhlIGNhbGxiYWNrIGZ1bmN0aW9uIHBhcmFtZXRlciBpbiBvdXIgR29vZ2xlIE1hcHMgQVBJIHJlcXVlc3QgaW4gJ2luZGV4Lmh0bWwnLlxyXG4gICAgICAgIHdpbmRvdy5pbml0TWFwID0gZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgICAgICAvLyBJbml0aWFsaXplIHRoZSBgbWFwYC5cclxuICAgICAgICAgICAgd2luZG93Lm1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpLCB7XHJcbiAgICAgICAgICAgICAgICB6b29tOiAxNSxcclxuICAgICAgICAgICAgICAgIG1hcFR5cGVJZDogZ29vZ2xlLm1hcHMuTWFwVHlwZUlkLlRFUlJBSU5cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnR29vZ2xlIE1hcHMgQVBJIGhhcyBiZWVuIGNhbGxlZC4nKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGdvb2dsZS5tYXBzKTtcclxuXHJcbiAgICAgICAgICAgIC8vIEluaXRpYWxpemUgdGhlIGBnZW9jb2RlcmAuXHJcbiAgICAgICAgICAgIGdlb2NvZGVyID0gbmV3IGdvb2dsZS5tYXBzLkdlb2NvZGVyKCk7XHJcbiAgICAgICAgICAgIHZtLmdlbyh2bS5nZW9sb2NhdGlvbk5hbWUoKSk7XHJcblxyXG4gICAgICAgICAgICAvLyBJbml0aWFsaXplIHRoZSBtYXJrZXIgaW5mbyB3aW5kb3dzLlxyXG4gICAgICAgICAgICB2bS5pbml0SW5mb1dpbmRvdygpO1xyXG5cclxuICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSBQbGFjZXMgU2VydmljZS5cclxuICAgICAgICAgICAgdm0ucGxhY2VzU2VydmljZSA9IG5ldyBnb29nbGUubWFwcy5wbGFjZXMuUGxhY2VzU2VydmljZShtYXApO1xyXG5cclxuICAgICAgICAgICAgaWYgKHZtLnBsYWNlc1NlcnZpY2UpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdHb29nbGUgUGxhY2VzIHNlcnZpY2UgaGFzIGJlZW4gaW5pdGlhbGl6ZWQuJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gU2V0IGByZWFkeVN0YXRlYCBwcm9wZXJ0eSB0byBgdHJ1ZWAgb25jZSBQbGFjZXMgU2VydmljZSBpcyBhdmFpbGFibGUgYW5kIHRoZSBtYXAgaGFzIGxvYWRlZCBzdWNjZXNzZnVsbHkuXHJcbiAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lck9uY2UobWFwLCAnaWRsZScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobWFwLmNlbnRlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2bS5yZWFkeVN0YXRlKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnR29vZ2xlIE1hcHMgaGFzIGxvYWRlZCBzdWNjZXNzZnVsbHkuJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KCdUaGVyZSB3YXMgYSBwcm9ibGVtIGxvYWRpbmcgdGhlIG1hcC4nKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhbGVydCgnVGhlcmUgd2FzIGFuIGVycm9yIGluaXRpYWxpemluZyBHb29nbGUgUGxhY2VzIHNlcnZpY2UuJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB3aW5kb3cubWFwSW5pdEVycm9ySGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coKTtcclxuICAgICAgICAgICAgYWxlcnQoJ1RoZXJlIHdhcyBhIHByb2JsZW0gbG9hZGluZyBHb29nbGUgTWFwcy4nKTtcclxuICAgICAgICB9O1xyXG5cclxuXHJcbiAgICAgICAgdm0uZ2VvID0gZnVuY3Rpb24gKGdlb2xvY2F0aW9uTmFtZSkge1xyXG4gICAgICAgICAgICBnZW9jb2Rlci5nZW9jb2RlKCB7ICdhZGRyZXNzJzogZ2VvbG9jYXRpb25OYW1lIH0sIGZ1bmN0aW9uIChyZXN1bHRzLCBzdGF0dXMpIHtcclxuICAgICAgICAgICAgICAgIGlmIChzdGF0dXMgPT0gZ29vZ2xlLm1hcHMuR2VvY29kZXJTdGF0dXMuT0spIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdm0uY2FjaGVkZ2VvbG9jYXRpb25OYW1lKGdlb2xvY2F0aW9uTmFtZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIG1hcC5zZXRDZW50ZXIocmVzdWx0c1swXS5nZW9tZXRyeS5sb2NhdGlvbik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIFN0b3JlIHRoZSBzdWNjZXNzZnVsbHkgZ2VvY29kZWQgY29vcmRpbmF0ZXMuIExvY2F0aW9uc1ZpZXdNb2RlbCBzdWJzY3JpYmVzIHRvIHRoaXMgcHJvcGVydHkgaW5cclxuICAgICAgICAgICAgICAgICAgICAvLyBvcmRlciB0byBzZWFyY2ggZm9yIG5ldyBhY3Rpdml0eSBsb2NhdGlvbnMgd2hlbmV2ZXIgdGhlIG1hcCBnZW9sb2NhdGlvbiBjaGFuZ2VzLlxyXG4gICAgICAgICAgICAgICAgICAgIHZtLmN1cnJlbnRHZW9sb2NhdGlvbih7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlbnRlcjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGF0OiByZXN1bHRzWzBdLmdlb21ldHJ5LmxvY2F0aW9uLmxhdCgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG5nOiByZXN1bHRzWzBdLmdlb21ldHJ5LmxvY2F0aW9uLmxuZygpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gUmVsb2FkIG1hcmtlciBpbmZvIHdpbmRvd3Mgd2hlbmV2ZXIgdGhlIGdlb2xvY2F0aW9uIGNoYW5nZXMuXHJcbiAgICAgICAgICAgICAgICAgICAgdm0uaW5pdEluZm9XaW5kb3coKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0xvY2F0aW9uIGhhcyBiZWVuIHNldCB0bzogJyArIGdlb2xvY2F0aW9uTmFtZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB2bS5nZW9sb2NhdGlvbk5hbWUodm0uY2FjaGVkZ2VvbG9jYXRpb25OYW1lKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwiR2VvY29kaW5nIHdhcyB1bnN1Y2Nlc3NmdWwgZm9yIHRoZSBmb2xsb3dpbmcgcmVhc29uOiBcIiArIHN0YXR1cyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG5cclxuICAgICAgICB2bS5pbml0SW5mb1dpbmRvdyA9IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgIC8vIEluaXRpYWxpemUgaW5mb1dpbmRvdywgbG9hZCB0aGUgdGVtcGxhdGUgYW5kIGFwcGx5IGJpbmRpbmdzLlxyXG4gICAgICAgICAgICB2bS5pbmZvV2luZG93KG5ldyBnb29nbGUubWFwcy5JbmZvV2luZG93KCkpO1xyXG5cclxuICAgICAgICAgICAgJC5hamF4KCcuL2J1aWxkL2NvbXBvbmVudHMvaW5mb3dpbmRvdy9pbmZvd2luZG93Lmh0bWwnKVxyXG4gICAgICAgICAgICAgICAgLmRvbmUoZnVuY3Rpb24gKHRlbXBsYXRlKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZtLmluZm9XaW5kb3coKS5zZXRDb250ZW50KHRlbXBsYXRlKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gT3BlbmluZyB0aGUgaW5mbyB3aW5kb3cgd2l0aCB0aGUgYG1hcGAgcGFyYW0gc2V0IHRvIGBudWxsYCBzdGlsbCBhbGxvd3MgdXMgdG8gcGVyZm9ybSBrbm9ja291dFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGRhdGEgYmluZGluZyAoaWYgd2UgaGFkIHNldCB0byBgbWFwYCB3ZSB3b3VsZCBzZWUgYW4gZW1wdHkgaW5mbyB3aW5kb3cgaW4gdGhlIHVwcGVyLWxlZnQgd2hlbiB0aGVcclxuICAgICAgICAgICAgICAgICAgICAvLyBhcHAgc3RhcnRzKS5cclxuICAgICAgICAgICAgICAgICAgICB2bS5pbmZvV2luZG93KCkub3BlbihudWxsKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGtvQm91bmQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcih2bS5pbmZvV2luZG93KCksICdkb21yZWFkeScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGtvQm91bmQgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrby5hcHBseUJpbmRpbmdzKHZtLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5mb3dpbmRvdy1vdmVybGF5JykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAga29Cb3VuZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gV2hlbiB0aGUgaW5mbyB3aW5kb3cgaXMgY2xpY2tlZCBjbG9zZWQsIHdlIGxvc2UgaXRzIGtub2Nrb3V0IGJpbmRpbmcuIFdoZW4gdGhpcyBoYXBwZW5zLCBpbnZva2VcclxuICAgICAgICAgICAgICAgICAgICAvLyBgaW5pdEluZm9XaW5kb3coKWAgYWdhaW4gdG8gbWFrZSBpdCB3b3JrIHVwb24gcmVvcGVuaW5nLlxyXG4gICAgICAgICAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKHZtLmluZm9XaW5kb3coKSwgJ2Nsb3NlY2xpY2snLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGtvQm91bmQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdm0uaW5pdEluZm9XaW5kb3coKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIEl0IHdvdWxkIGJlIG5pY2UgaWYgdGhlcmUgd2FzIGFuIGBvbmNsb3NlYCBldmVudCBmb3IgaW5mbyB3aW5kb3dzLiBTaW5jZSB3ZSBzb21ldGltZXMgbmVlZCB0byBjbG9zZSB0aGVcclxuICAgICAgICAvLyBpbmZvIHdpbmRvdyBwcm9ncmFtbWF0aWNhbGx5LCBhcyBpcyB0aGUgY2FzZSB3aGVuIHRoZSBzZWxlY3RlZCBsb2NhdGlvbiBpcyBoaWRkZW4gdmlhIHRoZSBmaWx0ZXIsIG9yIHdoZW5cclxuICAgICAgICAvLyB0aGUgYWN0aXZpdHkgY29udGFpbmluZyB0aGUgc2VsZWN0ZWQgbG9jYXRpb24gaXMgdW5jaGVja2VkLCB3ZSBuZWVkIHRvIHJlc2V0IHRoZSBpbmZvIHdpbmRvdyBmb3Iga25vY2tvdXRcclxuICAgICAgICAvLyBiaW5kaW5ncyB0byB3b3JrIHByb3Blcmx5LlxyXG4gICAgICAgIHZtLnJlc2V0SW5mb1dpbmRvdyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdm0uaW5mb1dpbmRvdygpLm9wZW4obnVsbCk7IC8vIGhhY2suIGluZm9XaW5kb3cuY2xvc2UoKSB3YXMgbm90IHdvcmtpbmcgZm9yIG1lIGhlcmUuXHJcbiAgICAgICAgICAgIHZtLmluaXRJbmZvV2luZG93KCk7XHJcbiAgICAgICAgfTtcclxuXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqICBNYXAgb3JpZW50YXRpb24gbWV0aG9kc1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHZtLmNlbnRlck1hcEF0ID0gZnVuY3Rpb24gKGxvY2F0aW9uKSB7XHJcbiAgICAgICAgICAgIHZhciBsYXRMbmcgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGxvY2F0aW9uLmdlb21ldHJ5KCkubG9jYXRpb24ubGF0KCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLmdlb21ldHJ5KCkubG9jYXRpb24ubG5nKCkpO1xyXG4gICAgICAgICAgICBtYXAucGFuVG8obGF0TG5nKTtcclxuICAgICAgICB9O1xyXG5cclxuXHJcblxyXG4gICAgICAgIC8vIFRPRE86IGluZm8gd2luZG93IGtvIGJpbmRpbmcgaXMgbG9zdCBpZiBpbmZvIHdpbmRvdyBpcyBjbG9zZWQuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogIE1hcCBtYXJrZXIgbWV0aG9kc1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIC8vIENoYW5naW5nIGNvbG9yIG9mIHRoZSBtYXJrZXJzIGJhc2VkIG9uIGZvdXJzcXVhcmUgY2hlY2tpbnMgd2FzIGEgYml0IG9mIGFuIGFmdGVydGhvdWdodC4gUmF0aGVyIHRoYW5cclxuICAgICAgICAvLyBvdmVyaGF1bCBteSBjb2RlLCBJIG9wdGVkIHRvIGdldCBhIGxpdHRsZSBtZXNzeSB3aXRoIHBhc3NpbmcgdG9vIG1hbnkgcGFyYW1ldGVycyAmIGNhbGxiYWNrIGZ1bmN0aW9uIGluXHJcbiAgICAgICAgLy8gb3JkZXIgdG8gbWFrZSB0aGlzIHdvcmsuIFNvcnJ5IGl0J3MgYSBoYWNreSEhXHJcbiAgICAgICAgdm0uYWRkTWFya2VyID0gZnVuY3Rpb24gKGxvY2F0aW9uLCBhY3Rpdml0eSwgY29sb3IpIHtcclxuXHJcbiAgICAgICAgICAgIHZhciB2aXNpYmxlU3RhdGUgPSBhY3Rpdml0eSgpLnZpc2libGUoKSA/IG1hcCA6IG51bGw7XHJcblxyXG4gICAgICAgICAgICB2YXIgbWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcih7XHJcbiAgICAgICAgICAgICAgICBtYXA6IHZpc2libGVTdGF0ZSxcclxuICAgICAgICAgICAgICAgIHRpdGxlOiBsb2NhdGlvbigpLm5hbWUoKSxcclxuICAgICAgICAgICAgICAgIGljb246ICdidWlsZC9pbWFnZXMvbWFya2Vycy9tYXJrZXJfJyArIGNvbG9yICsgJy5wbmcnLFxyXG4gICAgICAgICAgICAgICAgcG9zaXRpb246IGxvY2F0aW9uKCkuZ2VvbWV0cnkoKS5sb2NhdGlvbixcclxuICAgICAgICAgICAgICAgIGlkOiBsb2NhdGlvbigpLnBsYWNlX2lkKCksXHJcbiAgICAgICAgICAgICAgICBhbmltYXRpb246IGdvb2dsZS5tYXBzLkFuaW1hdGlvbi5EUk9QfSk7XHJcblxyXG4gICAgICAgICAgICAoZnVuY3Rpb24gKG1hcmtlckNvcHkpIHtcclxuICAgICAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcmtlckNvcHksICdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2bS5sb2NhdGlvbnNWbS5zZWxlY3RMb2NhdGlvbihsb2NhdGlvbigpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdm0uc2hvd0luZm9XaW5kb3cobG9jYXRpb24oKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0uYm91bmNlQW5pbWF0ZSh0aGlzKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KShtYXJrZXIpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIG1hcmtlcjtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2bS5zaG93SW5mb1dpbmRvdyA9IGZ1bmN0aW9uIChsb2NhdGlvbikge1xyXG4gICAgICAgICAgICB2bS5pbmZvV2luZG93KCkub3BlbihtYXAsIGxvY2F0aW9uLm1hcmtlcik7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdm0uc2hvd01hcmtlcnNGb3JWaXNpYmxlQWN0aXZpdGllcyA9IGZ1bmN0aW9uIChhY3Rpdml0aWVzKSB7XHJcbiAgICAgICAgICAgIF8uZWFjaChhY3Rpdml0aWVzKCksIGZ1bmN0aW9uKGFjdGl2aXR5KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoYWN0aXZpdHkoKS52aXNpYmxlKCkgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBfLmVhY2goYWN0aXZpdHkoKS5yZXN1bHRzKCksIGZ1bmN0aW9uKGxvY2F0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZtLnNob3dNYXJrZXIobG9jYXRpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2bS5oaWRlTWFya2VyID0gZnVuY3Rpb24gKGxvY2F0aW9uKSB7XHJcbiAgICAgICAgICAgIGxvY2F0aW9uKCkubWFya2VyLnNldE1hcChudWxsKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvLyBUT0RPOiBpbmZvIHdpbmRvd3Mgbm90IHdvcmtpbmcgYWZ0ZXIgZmlsdGVyIHBlcmZvcm1lZC4gSSB0aGluayB0aGlzIG1heSBoYXBwZW4gd2hlbiBpbmZvIHdpbmRvdyBpcyBvcGVuICYgZ2V0cyBoaWRkZW4gZHVyaW5nIGZpbHRlci5cclxuICAgICAgICB2bS5zaG93TWFya2VyID0gZnVuY3Rpb24gKGxvY2F0aW9uKSB7XHJcbiAgICAgICAgICAgIC8vIE9ubHkgZGlzcGxheSB0aGUgbWFya2VyIGlmIGl0IGlzIG5vdCBhbHJlYWR5IHZpc2libGUuXHJcbiAgICAgICAgICAgIGlmIChsb2NhdGlvbigpLm1hcmtlci5nZXRNYXAoKSAhPSBtYXApIHtcclxuICAgICAgICAgICAgICAgIHZtLmRyb3BBbmltYXRlKGxvY2F0aW9uKCkubWFya2VyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZtLmRyb3BBbmltYXRlID0gZnVuY3Rpb24gKG1hcmtlcikge1xyXG4gICAgICAgICAgICBtYXJrZXIuc2V0TWFwKG1hcCk7XHJcbiAgICAgICAgICAgIG1hcmtlci5zZXRBbmltYXRpb24oZ29vZ2xlLm1hcHMuQW5pbWF0aW9uLkRST1ApO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZtLmJvdW5jZUFuaW1hdGUgPSBmdW5jdGlvbiAobWFya2VyKSB7XHJcbiAgICAgICAgICAgIG1hcmtlci5zZXRBbmltYXRpb24oZ29vZ2xlLm1hcHMuQW5pbWF0aW9uLkJPVU5DRSk7XHJcblxyXG4gICAgICAgICAgICAvLyBUdXJuIG9mZiBhbmltYXRpb24gYWZ0ZXIgc2hvcnQgdGltZS5cclxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBtYXJrZXIuc2V0QW5pbWF0aW9uKG51bGwpO1xyXG4gICAgICAgICAgICB9LCAyMTI1KTtcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuXHJcbiAgICB3aW5kb3cuTWFwVmlld01vZGVsID0gTWFwVmlld01vZGVsO1xyXG5cclxufSkoKTtcclxuIiwiKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgdmFyIGZvdXJzcXVhcmVTZXJ2aWNlID0gZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICB2YXIgZm91cnNxdWFyZSA9IHRoaXM7XHJcblxyXG5cclxuICAgICAgICBmb3Vyc3F1YXJlLm1ha2VRdWVyeVVybCA9IGZ1bmN0aW9uIChsb2NhdGlvbikge1xyXG5cclxuICAgICAgICAgICAgLy8gcGVyIEFQSSBkb2NzLCAnL3NlYXJjaCcgaXMgcHJvYmFibHkgYmV0dGVyIGZvciBmaW5kaW5nIHNwZWNpZmljIGxvY2F0aW9uLCB3aGVyZWFzICcvZXhwbG9yZScgbWlnaHQgYmUgdXNlZCB0b1xyXG4gICAgICAgICAgICAvLyBmaW5kIG1vc3QgcG9wdWxhciBsb2NhdGlvbnMgb2YgYSBjYXRlZ29yeSBpbiBhIGdpdmVuIGFyZWEuXHJcbiAgICAgICAgICAgIHZhciBiYXNlVXJsID0gJ2h0dHBzOi8vYXBpLmZvdXJzcXVhcmUuY29tL3YyL3ZlbnVlcy9zZWFyY2gnLFxyXG5cclxuICAgICAgICAgICAgLy8gVE9ETzogcmVtb3ZlIGNsaWVudElkLlxyXG4gICAgICAgICAgICAgICAgY2xpZW50SWQgPSAnP2NsaWVudF9pZD1QVVhCSkNQNEI0SEIyS0lESUdRUEhYRUJBS1daUFpPNEhPV0paQUpUNDVNT1lXRE8nLFxyXG5cclxuICAgICAgICAgICAgLy8gVE9ETzogcmVtb3ZlIGNsaWVudFNlY3JldC5cclxuICAgICAgICAgICAgICAgIGNsaWVudFNlY3JldCA9ICcmY2xpZW50X3NlY3JldD1EM05GQTNQVDVOQzU0NDBFNVNKRU9CSllZRE4xQlkyMEFBU0dYR0YwMTJGNVkxTkQnLFxyXG4gICAgICAgICAgICAgICAgdmVyc2lvbiA9ICcmdj0yMDEzMDgxNScsXHJcbiAgICAgICAgICAgICAgICBsYXRMbmcgPSAnJmxsPScgKyBsb2NhdGlvbigpLnNob3J0TGF0TG5nKCksXHJcbiAgICAgICAgICAgICAgICBxdWVyeSA9ICcmcXVlcnk9JyArIGxvY2F0aW9uKCkubmFtZSgpLnNwbGl0KCcgJykuam9pbignJTIwJyksXHJcbiAgICAgICAgICAgICAgICBsaW1pdCA9ICcmbGltaXQ9MSc7XHJcblxyXG5cclxuICAgICAgICAgICAgbG9jYXRpb24oKS5mb3Vyc3F1YXJlUXVlcnlVcmwoICBiYXNlVXJsICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGllbnRJZCArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpZW50U2VjcmV0ICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXRMbmcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5ICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW1pdCk7XHJcblxyXG4gICAgICAgIH07XHJcblxyXG5cclxuICAgICAgICBmb3Vyc3F1YXJlLmdldENoZWNraW5zQ291bnRGb3IgPSBmdW5jdGlvbiAobG9jYXRpb24sIGFjdGl2aXR5LCBjYWxsYmFjaykge1xyXG5cclxuICAgICAgICAgICAga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgICAgICQuZ2V0SlNPTihsb2NhdGlvbigpLmZvdXJzcXVhcmVRdWVyeVVybCgpKVxyXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXMpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMucmVzcG9uc2UudmVudWVzLmxlbmd0aCA+IDApIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbigpLmZvdXJzcXVhcmVfaWQgPSByZXMucmVzcG9uc2UudmVudWVzWzBdLmlkO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsb2NhdGlvbkNoZWNraW5zID0gcmVzLnJlc3BvbnNlLnZlbnVlc1swXS5zdGF0cy5jaGVja2luc0NvdW50O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uQ2hlY2tpbnMgPyBsb2NhdGlvbigpLmNoZWNraW5zKGxvY2F0aW9uQ2hlY2tpbnMpIDogbG9jYXRpb24oKS5jaGVja2lucygwKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbigpLmNoZWNraW5zKDApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29sb3IgPSBsb2NhdGlvbigpLmdldENvbG9yKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbigpLm1hcmtlciA9IGNhbGxiYWNrKGxvY2F0aW9uLCBhY3Rpdml0eSwgY29sb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmZhaWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGVydCgnVGhlcmUgd2FzIGEgcHJvYmxlbSByZXRyaWV2aW5nIEZvdXJzcXVhcmUgY2hlY2staW5zIGZvciAnICsgbG9jYXRpb24oKS5uYW1lKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgfSwgdGhpcyk7XHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcblxyXG4gICAgd2luZG93LmZvdXJzcXVhcmVTZXJ2aWNlID0gZm91cnNxdWFyZVNlcnZpY2U7XHJcblxyXG59KCkpOyIsIlxyXG4oZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICAvLyBBIGBMb2NhdGlvbmAgcmVwcmVzZW50cyBhbnkgcGxhY2UgcmVzdWx0IG9mIGFuIGFjdGl2aXR5IHF1ZXJ5OyBub3QgdG8gYmUgY29uZnVzZWQgd2l0aCBhIGdlb2xvY2F0aW9uIHdoaWNoXHJcbiAgICAvLyByZXByZXNlbnRzIGEgY2l0eSBvciBnZW9ncmFwaGljIHJlZ2lvbiBwcmVzZW50ZWQgb24gdGhlIG1hcC5cclxuICAgIHZhciBMb2NhdGlvbnNWaWV3TW9kZWwgPSBmdW5jdGlvbiAobWFwVm0sIGZvdXJzcXVhcmVTZXJ2aWNlKSB7XHJcblxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiAgVG9wLWxldmVsIHZhcmlhYmxlcyBhbmQgcHJvcGVydGllcyBmb3IgYExvY2F0aW9uc1ZpZXdNb2RlbCgpYFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XHJcblxyXG4gICAgICAgIC8vIEluaXRpYWxpemUgYGZpbHRlclF1ZXJ5YCBvYnNlcnZhYmxlIHRvIGJpbmQgdG8gdXNlciBpbnB1dCBpbiB0aGUgbG9jYXRpb25zIGZpbHRlciBmb3JtLlxyXG4gICAgICAgIHZtLmZpbHRlclF1ZXJ5ID0ga28ub2JzZXJ2YWJsZSgnJyk7XHJcblxyXG4gICAgICAgIHZtLnNlbGVjdGVkTG9jYXRpb24gPSBrby5vYnNlcnZhYmxlKCdoZWxsbycpO1xyXG5cclxuICAgICAgICB2bS5hY3Rpdml0aWVzID0ga28ub2JzZXJ2YWJsZUFycmF5KFtdKTtcclxuXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqICBBY3Rpdml0eSBsb2NhdGlvbnMgc2VhcmNoIGZ1bmN0aW9uXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdm0uc2VhcmNoTG9jYXRpb25zID0gZnVuY3Rpb24gKGFjdGl2aXR5KSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgbWFwQm91bmRzID0gd2luZG93Lm1hcC5nZXRCb3VuZHMoKTtcclxuXHJcbiAgICAgICAgICAgIG1hcFZtLnBsYWNlc1NlcnZpY2UudGV4dFNlYXJjaCh7XHJcbiAgICAgICAgICAgICAgICBib3VuZHM6IG1hcEJvdW5kcyxcclxuICAgICAgICAgICAgICAgIHF1ZXJ5OiBhY3Rpdml0eSgpLnRpdGxlXHJcbiAgICAgICAgICAgIH0sIGNhbGxiYWNrKTtcclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGNhbGxiYWNrKHJlc3VsdHMsIHN0YXR1cykge1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChzdGF0dXMgPT09IGdvb2dsZS5tYXBzLnBsYWNlcy5QbGFjZXNTZXJ2aWNlU3RhdHVzLk9LICYmXHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0cy5sZW5ndGggPiAwKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbkJvdW5kTG9jYXRpb25zID0gc3VwcHJlc3NPdXRPZkJvdW5kc0xvY2F0aW9ucyhyZXN1bHRzKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgbG9jYXRpb25zIGFyZSBmb3VuZCBpbnNpZGUgb2YgdmlzaWJsZSBtYXAgYm91bmRhcmllcy5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoaW5Cb3VuZExvY2F0aW9ucy5sZW5ndGggPiAwKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDb25zdHJ1Y3QgYExvY2F0aW9uYCBvYnNlcnZhYmxlcyBhbmQgcHVzaCB0byBgYWN0aXZpdHkoKS5yZXN1bHRzYC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgXy5lYWNoKGluQm91bmRMb2NhdGlvbnMsIGZ1bmN0aW9uIChsb2NhdGlvbkRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsb2MgPSBrby5vYnNlcnZhYmxlKG5ldyBMb2NhdGlvbihsb2NhdGlvbkRhdGEpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZXF1ZXN0IGZvdXJzcXVhcmUgZGF0YSBmb3IgZWFjaCBsb2NhdGlvbiAmIHNhdmUgdGhlIHJlc3VsdHMgYXMgYSBsb2NhdGlvbiBwcm9wZXJ0eS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZtLnJlcXVlc3RGb3Vyc3F1YXJlRGF0YShsb2MsIGFjdGl2aXR5LCBtYXBWbS5hZGRNYXJrZXIpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5KCkucmVzdWx0cy5wdXNoKGxvYyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIHRoZSBhY3Rpdml0eSB3YXMgcHJldmlvdXNseSBtYWRlIGludmlzaWJsZSBkdWUgdG8gdGhlcmUgYmVpbmcgbm8gbG9jYXRpb24gcmVzdWx0cyBmb3IgYVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBwcmV2aW91cyBnZW9sb2NhdGlvbiwgc2V0IHRoZSB2aXNpYmlsaXR5IHRvIHRydWUgc28gdGhhdCB0aGUgcmVzdWx0cyB3aWxsIGJlIGRpc3BsYXllZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGl2aXR5KCkubm9SZXN1bHRzRm9yTGFzdEdlb2xvY2F0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpdml0eSgpLm5vUmVzdWx0c0Zvckxhc3RHZW9sb2NhdGlvbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHkoKS52aXNpYmxlKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2bS5hY3Rpdml0aWVzLnB1c2goYWN0aXZpdHkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHkoKS52aXNpYmxlKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHkoKS5ub1Jlc3VsdHNGb3JMYXN0R2VvbG9jYXRpb24gPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gV2Ugc3RpbGwgd2FudCB0byBzYXZlIHRoZSBhY3Rpdml0eSBzbyB0aGF0IGl0IGNhbiBiZSBxdWVyaWVkIGFnYWluIGZvciBuZXcgZ2VvbG9jYXRpb25zLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2bS5hY3Rpdml0aWVzLnB1c2goYWN0aXZpdHkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoJ1NvcnJ5LCB0aGVyZSBhcmUgbm8gbG9jYXRpb25zIGZvciAnICsgYWN0aXZpdHkoKS50aXRsZSArICcgaW4gdGhlIGN1cnJlbnQgbWFwIGJvdW5kcy4nKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBhbGVydCgnU29ycnksIHRoZXJlIHdhcyBhIHByb2JsZW0gcmV0cmlldmluZyByZXN1bHRzIGZvciB0aGUgZm9sbG93aW5nIHJlYXNvbjogJyArIHN0YXR1cyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIHN1cHByZXNzT3V0T2ZCb3VuZHNMb2NhdGlvbnMobG9jYXRpb25zKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbG9jTGF0LCBsb2NMbmc7XHJcbiAgICAgICAgICAgICAgICB2YXIgaW5Cb3VuZExvY2F0aW9ucyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgXy5lYWNoKGxvY2F0aW9ucywgZnVuY3Rpb24gKGxvY2F0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9jTGF0ID0gbG9jYXRpb24uZ2VvbWV0cnkubG9jYXRpb24ubGF0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9jTG5nID0gbG9jYXRpb24uZ2VvbWV0cnkubG9jYXRpb24ubG5nKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIFN0b3JlIGVhY2ggYGxvY2F0aW9uYCBvbmx5IGlmIGl0IGlzIGNvbnRhaW5lZCB3aXRoaW4gdGhlIG1hcCBib3VuZGFyaWVzIGF0IGN1cnJlbnQgem9vbSBsZXZlbC5cclxuICAgICAgICAgICAgICAgICAgICBpZiAobWFwQm91bmRzLkguSCA8IGxvY0xhdCAmJiBsb2NMYXQgPCBtYXBCb3VuZHMuSC5qICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcEJvdW5kcy5qLkggPiBsb2NMbmcgJiYgbG9jTG5nID4gbWFwQm91bmRzLmouaikge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5Cb3VuZExvY2F0aW9ucy5wdXNoKGxvY2F0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5Cb3VuZExvY2F0aW9ucztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiAgUmV0cmlldmUgZm91cnNxdWFyZSBkYXRhXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdm0ucmVxdWVzdEZvdXJzcXVhcmVEYXRhID0gZnVuY3Rpb24gKGxvY2F0aW9uLCBhY3Rpdml0eSwgY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgZm91cnNxdWFyZVNlcnZpY2UubWFrZVF1ZXJ5VXJsKGxvY2F0aW9uKTtcclxuICAgICAgICAgICAgZm91cnNxdWFyZVNlcnZpY2UuZ2V0Q2hlY2tpbnNDb3VudEZvcihsb2NhdGlvbiwgYWN0aXZpdHksIGNhbGxiYWNrKTtcclxuICAgICAgICB9O1xyXG5cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogIExvY2F0aW9ucyBmaWx0ZXIgZnVuY3Rpb25cclxuICAgICAgICAgKi9cclxuICAgICAgICB2bS5maWx0ZXJRdWVyeS5zdWJzY3JpYmUoZnVuY3Rpb24gZmlsdGVyQWxnb3JpdGhtKCkge1xyXG5cclxuICAgICAgICAgICAgaWYgKGZpbHRlcklucHV0SXNFbXB0eSgpKSB7XHJcbiAgICAgICAgICAgICAgICB1bmZpbHRlclJlc3VsdHMoKTtcclxuICAgICAgICAgICAgICAgIG1hcFZtLnNob3dNYXJrZXJzRm9yVmlzaWJsZUFjdGl2aXRpZXModm0uYWN0aXZpdGllcyk7XHJcblxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZmlsdGVyUmVzdWx0cygpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBUT0RPOiByZWRpc3BsYXkgc2VsZWN0ZWQgbG9jYXRpb24gaW5mbyB3aW5kb3cgYWZ0ZXIgZmlsdGVyLlxyXG4gICAgICAgICAgICBmdW5jdGlvbiBmaWx0ZXJSZXN1bHRzKCkge1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICB2YXIgYWN0aXZpdHlWaXNpYmlsaXR5RHVyaW5nRmlsdGVyO1xyXG5cclxuICAgICAgICAgICAgICAgIF8uZWFjaCh2bS5hY3Rpdml0aWVzKCksIGZ1bmN0aW9uIChhY3Rpdml0eSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aXZpdHkoKS5yZXN1bHRzKCkubGVuZ3RoID4gMCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgXy5lYWNoKGFjdGl2aXR5KCkucmVzdWx0cygpLCBmdW5jdGlvbiAobG9jYXRpb24pIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBIaWRlIHRoZSBsb2NhdGlvbiBsaXN0IGl0ZW1zIGFuZCBtYXAgbWFya2VycyBmb3IgZmlsdGVyZWQtb3V0IGxvY2F0aW9ucy5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCAhKGxvY2F0aW9uKCkuY29udGFpbnModm0uZmlsdGVyUXVlcnkoKSkpICkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbigpLnZpc2libGUoZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcFZtLmhpZGVNYXJrZXIobG9jYXRpb24pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobG9jYXRpb24oKS5zZWxlY3RlZCgpID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcFZtLnJlc2V0SW5mb1dpbmRvdygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIGBhY3Rpdml0eVZpc2liaWxpdHlEdXJpbmdGaWx0ZXJgIGFuZCBgaGFzRmlsdGVyUmVzdWx0c2Agc3RhdGVzIHdpbGwgb25seSByZW1haW5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBmYWxzZSBpZiB0aGVyZSBhcmUgemVybyBsb2NhdGlvbiByZXN1bHRzIHdpdGhpbiBhbiBhY3Rpdml0eSBjb250YWluaW5nIHRoZSBmaWx0ZXJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBxdWVyeSBzdHJpbmcuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHlWaXNpYmlsaXR5RHVyaW5nRmlsdGVyID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHkoKS5oYXNGaWx0ZXJSZXN1bHRzKGZhbHNlKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZS1kaXNwbGF5IHByZXZpb3VzbHkgaGlkZGVuIGxvY2F0aW9ucyBhbmQgbWFya2VycyAod2hlbiBgYmFja3NwYWNlYCBpcyBwcmVzc2VkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZvciBpbnN0YW5jZSkuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24oKS52aXNpYmxlKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5KCkuaGFzRmlsdGVyUmVzdWx0cyh0cnVlKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGl2aXR5KCkuY2hlY2tlZCgpID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcFZtLnNob3dNYXJrZXIobG9jYXRpb24pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVvcGVuIGluZm8gd2luZG93IGZvciBzZWxlY3RlZCBsb2NhdGlvbi5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxvY2F0aW9uKCkuc2VsZWN0ZWQoKSA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwVm0uaW5mb1dpbmRvdygpLm9wZW4od2luZG93Lm1hcCwgbG9jYXRpb24oKS5tYXJrZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIGFueSBhY3Rpdml0eSBsb2NhdGlvbnMgaGF2ZSBhcmUgdmlzaWJsZSBhZ2FpbiwgYW5kIGlmIHNvIHNldFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBgYWN0aXZpdHlWaXNpYmlsaXR5RHVyaW5nRmlsdGVyYCB0byB0cnVlIChzbyBsb25nIGFzIHRoZSBhY3Rpdml0eSB3YXMgYGNoZWNrZWRgIHByaW9yIHRvXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN0YXJ0aW5nIHRoZSBmaWx0ZXIgcXVlcnkpLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfLnNvbWUoYWN0aXZpdHkoKS5yZXN1bHRzKCksIGZ1bmN0aW9uIChsb2NhdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxvY2F0aW9uKCkudmlzaWJsZSgpICYmIGFjdGl2aXR5KCkuY2hlY2tlZCgpID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHlWaXNpYmlsaXR5RHVyaW5nRmlsdGVyID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpdml0eSgpLmhhc0ZpbHRlclJlc3VsdHModHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBVSSBhZnRlciBldmVyeSBrZXlzdHJva2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5KCkudmlzaWJsZShhY3Rpdml0eVZpc2liaWxpdHlEdXJpbmdGaWx0ZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBmaWx0ZXJJbnB1dElzRW1wdHkoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdm0uZmlsdGVyUXVlcnkoKS50cmltKCkgPT09ICcnO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiB1bmZpbHRlclJlc3VsdHMoKSB7XHJcbiAgICAgICAgICAgICAgICBfLmVhY2godm0uYWN0aXZpdGllcygpLCBmdW5jdGlvbiAoYWN0aXZpdHkpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgXy5lYWNoKGFjdGl2aXR5KCkucmVzdWx0cygpLCBmdW5jdGlvbiAobG9jYXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24oKS52aXNpYmxlKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXNldEluaXRpYWxWaXNpYmlsaXR5KGFjdGl2aXR5KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHJlc2V0SW5pdGlhbFZpc2liaWxpdHkoYWN0aXZpdHkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aXZpdHkoKS5yZXN1bHRzKCkubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5KCkudmlzaWJsZShmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aXZpdHkoKS5jaGVja2VkKCkgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGl2aXR5KCkucmVzdWx0cygpLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5KCkudmlzaWJsZSh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5KCkuaGFzRmlsdGVyUmVzdWx0cyh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhY3Rpdml0eSgpLnJlc3VsdHMoKS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpdml0eSgpLmhhc0ZpbHRlclJlc3VsdHModHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIEhhY2sgdG8gcHJldmVudCBwYWdlIHJlbG9hZCBvbiB0aGUgZmlsdGVyIGZvcm0gc3VibWlzc2lvbi5cclxuICAgICAgICB2bS5wcmV2ZW50RGVmYXVsdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgLy8gKGRvIG5vdGhpbmcuKVxyXG4gICAgICAgIH07XHJcblxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiAgVXBkYXRlIGxvY2F0aW9ucyB3aGVuIHRoZSBnZW9sb2NhdGlvbiBjaGFuZ2VzXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgbWFwVm0uY3VycmVudEdlb2xvY2F0aW9uLnN1YnNjcmliZShmdW5jdGlvbiB1cGRhdGVMb2NhdGlvbnMoKSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgY29weTtcclxuXHJcbiAgICAgICAgICAgIGlmICh2bS5hY3Rpdml0aWVzKCkpXHJcbiAgICAgICAgICAgICAgICBjb3B5ID0gdm0uYWN0aXZpdGllcygpO1xyXG5cclxuICAgICAgICAgICAgLy8gQ2xlYXIgY3VycmVudGx5IGRpc3BsYXllZCBtYXAgbWFya2VycywgYW5kIGNsZWFyIHN0b3JlZCBMb2NhdGlvbiByZXN1bHRzLiBPbmx5IGNsZWFyaW5nIHRoZSBlbnRpcmVcclxuICAgICAgICAgICAgLy8gYHZtLmFjdGl2aXRpZXMoKWAsIGFzIGJlbG93IG9iamVjdCBkb2VzIG5vdCB1cGRhdGUgdGhlIFVJIGluIHRoZSB3YXkgb25lIHdvdWxkIGV4cGVjdDsgd2l0aG91dCBpdGVyYXRpbmdcclxuICAgICAgICAgICAgLy8gb3ZlciB0aGUgYWN0aXZpdHkgcmVzdWx0cywgdGhlIGxvY2F0aW9uIHJlc3VsdHMgZm9yIHRoZSBwcmV2aW91cyBnZW9sb2NhdGlvbiBjb250aW51ZSB0byBhcHBlYXIuXHJcbiAgICAgICAgICAgIF8uZWFjaCh2bS5hY3Rpdml0aWVzKCksIGZ1bmN0aW9uIChhY3Rpdml0eSkge1xyXG4gICAgICAgICAgICAgICAgXy5lYWNoKGFjdGl2aXR5KCkucmVzdWx0cygpLCBmdW5jdGlvbiAobG9jYXRpb24pe1xyXG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uKCkubWFya2VyLnNldE1hcChudWxsKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYWN0aXZpdHkoKS5yZXN1bHRzKFtdKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB2bS5hY3Rpdml0aWVzKFtdKTtcclxuXHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBMb2NhdGlvbiByZXN1bHRzIGZvciBuZXcgR2VvbG9jYXRpb25cclxuICAgICAgICAgICAgXy5lYWNoKGNvcHksIGZ1bmN0aW9uIChhY3Rpdml0eSkge1xyXG4gICAgICAgICAgICAgICAgdm0uc2VhcmNoTG9jYXRpb25zKGFjdGl2aXR5KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiAgU2VsZWN0ZWQgbG9jYXRpb24gZnVuY3Rpb25zXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdm0uc2VsZWN0TG9jYXRpb24gPSBmdW5jdGlvbiAobG9jYXRpb24pIHtcclxuXHJcbiAgICAgICAgICAgIC8vIFVuLXNlbGVjdCBhbGwgbG9jYXRpb25zIHNvIHRoYXQgb25seSBvbmUgbG9jYXRpb24gYXBwZWFycyBzZWxlY3RlZCBhdCBhIHRpbWUuXHJcbiAgICAgICAgICAgIHZtLmNsZWFyQ3VycmVudFNlbGVjdGlvbnMoKTtcclxuXHJcbiAgICAgICAgICAgIC8vIFRoZSBgc2VsZWN0ZWQoKWAgb2JzZXJ2YWJsZSBwcm9wZXJ0eSBpcyB1c2VkIHRvIGNvbnRyb2wgdGhlIGNzcyBgYmFja2dyb3VuZC1jb2xvcmAgb2YgdGhlIGxvY2F0aW9uIGVsZW1lbnQuXHJcbiAgICAgICAgICAgIGxvY2F0aW9uLnNlbGVjdGVkKHRydWUpO1xyXG4gICAgICAgICAgICB2bS5zZWxlY3RlZExvY2F0aW9uKGxvY2F0aW9uKTtcclxuXHJcbiAgICAgICAgICAgIG1hcFZtLnNob3dJbmZvV2luZG93KGxvY2F0aW9uKTtcclxuICAgICAgICAgICAgbWFwVm0uY2VudGVyTWFwQXQobG9jYXRpb24pO1xyXG4gICAgICAgICAgICBtYXBWbS5ib3VuY2VBbmltYXRlKGxvY2F0aW9uLm1hcmtlcik7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdm0uY2xlYXJDdXJyZW50U2VsZWN0aW9ucyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgXy5lYWNoKHZtLmFjdGl2aXRpZXMoKSwgZnVuY3Rpb24gKGFjdGl2aXR5KSB7XHJcbiAgICAgICAgICAgICAgICBfLmVhY2goYWN0aXZpdHkoKS5yZXN1bHRzKCksIGZ1bmN0aW9uIChsb2NhdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uKCkuc2VsZWN0ZWQoZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZtLmFzc2lnbkNvbG9yc1RvTG9jYXRpb25zID0gZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2bS5nZXRSZWZlcmVuY2VUb0FjdGl2aXRpZXNPYmplY3QgPSBmdW5jdGlvbiAoYWN0aXZpdGllcykge1xyXG4gICAgICAgICAgICB2bS5hY3Rpdml0aWVzID0gYWN0aXZpdGllcztcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2bS5wYXNzU2VsZlRvTWFwVm0gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIG1hcFZtLmxvY2F0aW9uc1ZtID0gdm07XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2bS5wYXNzU2VsZlRvTWFwVm0oKTtcclxuXHJcbiAgICAgICAgdm0ucGFzc1NlbGVjdGVkTG9jYXRpb25Ub01hcFZtID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBtYXBWbS5zZWxlY3RlZExvY2F0aW9uKHZtLnNlbGVjdGVkTG9jYXRpb24pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZtLnNlbGVjdGVkTG9jYXRpb24uc3Vic2NyaWJlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICB2bS5wYXNzU2VsZWN0ZWRMb2NhdGlvblRvTWFwVm0oKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgd2luZG93LkxvY2F0aW9uc1ZpZXdNb2RlbCA9IExvY2F0aW9uc1ZpZXdNb2RlbDtcclxuXHJcbn0pKCk7XHJcblxyXG4iLCJcclxuKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgdmFyIEFjdGl2aXRpZXNWaWV3TW9kZWwgPSBmdW5jdGlvbiAobWFwVm0sIGxvY2F0aW9uc1ZtKSB7XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqICBUb3AtbGV2ZWwgdmFyaWFibGVzIGFuZCBwcm9wZXJ0aWVzIGZvciBgQWN0aXZpdGllc1ZpZXdNb2RlbCgpYFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XHJcblxyXG4gICAgICAgIHZtLmRlZmF1bHRBY3Rpdml0aWVzID0gW1xyXG4gICAgICAgICAgICAnQ29mZmVlJyxcclxuICAgICAgICAgICAgJ1ZlZ2V0YXJpYW4nLFxyXG4gICAgICAgICAgICAnUGFyaycsXHJcbiAgICAgICAgICAgICdNZXhpY2FuJyxcclxuICAgICAgICAgICAgJ0FydCBHYWxsZXJ5J107XHJcblxyXG4gICAgICAgIHZtLmFjdGl2aXRpZXMgPSBrby5vYnNlcnZhYmxlQXJyYXkoKTtcclxuICAgICAgICB2bS5hY3Rpdml0eVF1ZXJ5ID0ga28ub2JzZXJ2YWJsZSgpO1xyXG5cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogIERpc3BsYXkgbG9jYXRpb25zIGZvciBkZWZhdWx0IGFjdGl2aXRpZXNcclxuICAgICAgICAgKi9cclxuXHJcbiAgICAgICAgICAgIC8vIFNlYXJjaCBmb3IgKGFuZCBkaXNwbGF5KSBsb2NhdGlvbnMgZm9yIHRoZSBkZWZhdWx0IGFjdGl2aXRpZXMgb25jZSB0aGUgbWFwIGhhcyBmdWxseSBsb2FkZWQgYW5kIEdvb2dsZSBQbGFjZXNcclxuICAgICAgICAgICAgLy8gU2VydmljZSBpcyByZWFkeSB0byByZWNlaXZlIHF1ZXJpZXMuXHJcbiAgICAgICAgbWFwVm0ucmVhZHlTdGF0ZS5zdWJzY3JpYmUoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAobWFwVm0ucmVhZHlTdGF0ZSgpID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICB2bS5kaXNwbGF5RGVmYXVsdEFjdGl2aXRpZXMoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB2bS5kaXNwbGF5RGVmYXVsdEFjdGl2aXRpZXMgPSBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICB2bS5wYXNzUmVmZXJlbmNlVG9Mb2NhdGlvbnNWbSgpO1xyXG5cclxuICAgICAgICAgICAgXy5lYWNoKHZtLmRlZmF1bHRBY3Rpdml0aWVzLCBmdW5jdGlvbiAoYWN0aXZpdHlOYW1lKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYWN0aXZpdHkgPSBrby5vYnNlcnZhYmxlKG5ldyBBY3Rpdml0eShhY3Rpdml0eU5hbWUpKTtcclxuICAgICAgICAgICAgICAgIGxvY2F0aW9uc1ZtLnNlYXJjaExvY2F0aW9ucyhhY3Rpdml0eSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiAgTmV3IGFjdGl2aXR5IGZ1bmN0aW9uc1xyXG4gICAgICAgICAqL1xyXG5cclxuICAgICAgICAgICAgLy8gVE9ETzogVmFsaWRhdGUgaW5wdXQgYW5kIGhhbmRsZSBkdXBsaWNhdGVzIChhbHNvIHdoYXQgZG8gZG8gYWZ0ZXIgbWFwIGlzIHJlc2l6ZWQpLlxyXG4gICAgICAgIHZtLmFkZEFjdGl2aXR5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgYWN0aXZpdHkgPSBrby5vYnNlcnZhYmxlKG5ldyBBY3Rpdml0eSh2bS5hY3Rpdml0eVF1ZXJ5KCkpKTtcclxuICAgICAgICAgICAgbG9jYXRpb25zVm0uc2VhcmNoTG9jYXRpb25zKGFjdGl2aXR5KTtcclxuICAgICAgICAgICAgdm0uYWN0aXZpdHlRdWVyeSgnJyk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdm0ucGFzc1JlZmVyZW5jZVRvTG9jYXRpb25zVm0gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGxvY2F0aW9uc1ZtLmdldFJlZmVyZW5jZVRvQWN0aXZpdGllc09iamVjdCh2bS5hY3Rpdml0aWVzKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2bS5hY3Rpdml0aWVzLnN1YnNjcmliZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZtLnBhc3NSZWZlcmVuY2VUb0xvY2F0aW9uc1ZtKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHZtLnJlc2V0SW5mb1dpbmRvd1doZW5TZWxlY3RlZExvY2F0aW9uVG9nZ2xlZFZpc2libGUgPSBmdW5jdGlvbiAoYWN0aXZpdHkpIHtcclxuXHJcbiAgICAgICAgICAgIF8uZWFjaChhY3Rpdml0eS5yZXN1bHRzKCksIGZ1bmN0aW9uIChsb2NhdGlvbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGxvY2F0aW9uKCkuc2VsZWN0ZWQoKSA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoYWN0aXZpdHkuY2hlY2tlZCgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgZmFsc2U6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXBWbS5yZXNldEluZm9XaW5kb3coKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIHRydWU6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXBWbS5pbmZvV2luZG93KCkub3Blbih3aW5kb3cubWFwLCBsb2NhdGlvbigpLm1hcmtlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBcclxuICAgIH07XHJcblxyXG4gICAgd2luZG93LkFjdGl2aXRpZXNWaWV3TW9kZWwgPSBBY3Rpdml0aWVzVmlld01vZGVsO1xyXG5cclxufSgpKTtcclxuIiwiXHJcbihmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogTWFzdGVyIFZpZXdNb2RlbCBjb25zdHJ1Y3RvclxyXG4gICAgICovXHJcbiAgICB2YXIgQXBwVmlld01vZGVsID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XHJcblxyXG4gICAgICAgIHZtLmZvdXJzcXVhcmVTZXJ2aWNlID0gbmV3IGZvdXJzcXVhcmVTZXJ2aWNlKCk7XHJcblxyXG4gICAgICAgIHZtLk1hcFZpZXdNb2RlbCA9IG5ldyBNYXBWaWV3TW9kZWwodm0uZm91cnNxdWFyZVNlcnZpY2UpO1xyXG4gICAgICAgIHZtLkxvY2F0aW9uc1ZpZXdNb2RlbCA9IG5ldyBMb2NhdGlvbnNWaWV3TW9kZWwodm0uTWFwVmlld01vZGVsLCB2bS5mb3Vyc3F1YXJlU2VydmljZSk7XHJcbiAgICAgICAgdm0uQWN0aXZpdGllc1ZpZXdNb2RlbCA9IG5ldyBBY3Rpdml0aWVzVmlld01vZGVsKHZtLk1hcFZpZXdNb2RlbCwgdm0uTG9jYXRpb25zVmlld01vZGVsKTtcclxuXHJcbiAgICB9O1xyXG5cclxuICAgIHdpbmRvdy5BcHBWaWV3TW9kZWwgPSBBcHBWaWV3TW9kZWw7XHJcblxyXG59KCkpO1xyXG5cclxuXHJcbiIsIlxyXG4oZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICAvKipcclxuICAgICAqICBJbml0aWFsaXplIHRoZSBtYXN0ZXIgVmlld01vZGVsXHJcbiAgICAgKi9cclxuICAgIHZhciBhcHAgPSBuZXcgQXBwVmlld01vZGVsKCk7XHJcblxyXG5cclxuICAgIC8qKlxyXG4gICAgICogIFJlbmRlciB0aGUgVUkgY29tcG9uZW50cywgYW5kIGFwcGx5IGtub2Nrb3V0IGRhdGEgYmluZGluZ3NcclxuICAgICAqL1xyXG4gICAgZGlzcGxheUNvbXBvbmVudHMoWydzZWFyY2hiYXInLCAnc2lkZWJhciddKTtcclxuXHJcbiAgICAvLyBGb3IgdGhpcyBwcm9qZWN0LCBJIGRlY2lkZWQgdG8gbWFrZSB0aGlzIGNvbXBvbmVudCBsb2FkZXIgaW4gbGlldSBvZiB1c2luZyBzb21ldGhpbmcgbGlrZSByZXF1aXJlanMuIEkgZGlkXHJcbiAgICAvLyBhdHRlbXB0IHRvIGltcGxlbWVudCByZXF1aXJlanMsIGJ1dCB0aGUgY29uc29sZSBlcnJvcnMgZGlkbid0IHByb3ZpZGUgbWUgd2l0aCBzcGVjaWZpYyBlbm91Z2ggaW5mb3JtYXRpb24gdG9cclxuICAgIC8vIHNvcnQgb3V0IHdoYXQgd2FzIHdyb25nIHdpdGggbXkgY29kZS4gSW4gYW55IGNhc2UsIGZvciB0aGUgc2NvcGUgb2YgdGhpcyBzaW5nbGUtcGFnZS1hcHAsIG15IHNvbHV0aW9uIHNlZW1zIHRvXHJcbiAgICAvLyB3b3JrIGZpbmUuXHJcbiAgICBmdW5jdGlvbiBkaXNwbGF5Q29tcG9uZW50cyhjb21wb25lbnRzKSB7XHJcblxyXG4gICAgICAgIHZhciAkY29tcG9uZW50LCB0ZW1wbGF0ZVVybCwgaWQsIGh0bWw7XHJcbiAgICAgICAgXy5lYWNoKGNvbXBvbmVudHMsIGZ1bmN0aW9uIChjb21wb25lbnQpIHtcclxuXHJcbiAgICAgICAgICAgIHZhciBjb250YWluZXIgPSAnI292ZXJsYXktJyArIGNvbXBvbmVudDtcclxuICAgICAgICAgICAgJGNvbXBvbmVudCA9ICQoJzxkaXY+Jyk7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsID0gJy4vYnVpbGQvY29tcG9uZW50cy8nICsgY29tcG9uZW50ICsgJy8nICsgY29tcG9uZW50ICsgJy5odG1sJztcclxuICAgICAgICAgICAgaWQgPSAnIycgKyBjb21wb25lbnQ7XHJcblxyXG4gICAgICAgICAgICAkY29tcG9uZW50LmxvYWQodGVtcGxhdGVVcmwsIGlkLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBodG1sID0gJCh0aGlzKS5wcm9wKCdvdXRlckhUTUwnKTtcclxuICAgICAgICAgICAgICAgICQoY29udGFpbmVyKS5hcHBlbmQoaHRtbCk7XHJcblxyXG4gICAgICAgICAgICAgICAga28uYXBwbHlCaW5kaW5ncyhhcHAsIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNvbXBvbmVudCkpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiAgTWFrZSB0aGUgVUkgY29tcG9uZW50cyBkcmFnZ2FibGVcclxuICAgICAqL1xyXG4gICAgLy8gU29ycnkhIEkgc3RpbGwgaGFkIHRvIHNsYW5nIGEgbGl0dGxlIGJpdCBvZiBqUXVlcnkgdXAgaW4gdGhpcyBhcHAuXHJcbiAgICAkKGRvY3VtZW50KS5yZWFkeShcclxuICAgICAgICBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgICAgICQoJyNvdmVybGF5LXNlYXJjaGJhcicpLmRyYWdnYWJsZSgpO1xyXG4gICAgICAgICAgICAkKCcjb3ZlcmxheS1zaWRlYmFyJykuZHJhZ2dhYmxlKCk7XHJcblxyXG4gICAgICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnI3RvZ2dsZS1taW5pbWl6ZS1zaWRlYmFyJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkKHRoaXMpLnBhcmVudCgpLnRvZ2dsZUNsYXNzKCdzaG93Jyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICB9KTtcclxuXHJcbn0oKSk7XHJcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
