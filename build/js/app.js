!function(){"use strict";var e=function(e){this.title=e,this.results=ko.observableArray(),this.visible=ko.observable(!0),this.checked=ko.observable(!0),this.hasFilterResults=ko.observable()};e.prototype.toggleMarkersVisible=function(){var e=this;if(e.toggleChecked(),e.results().length>0){var o=_.head(e.results());null!==o().marker.getMap()&&(e.mapReference=o().marker.getMap()),_.each(e.results(),function(o){null===o().marker.getMap()?o().marker.setMap(e.mapReference):o().marker.setMap(null)})}return!0},e.prototype.toggleChecked=function(){var e=this;return e.checked(!e.checked()),!0},window.Activity=e}(),function(){"use strict";var e=function(e){this.name=ko.observable(e.name),this.visible=ko.observable(!0),this.selected=ko.observable(!1),this.place_id=ko.observable(e.place_id),this.formatted_address=ko.observable(e.formatted_address),this.geometry=ko.observable(e.geometry),this.types=ko.observableArray(e.types),this.marker=null,this.foursquareQueryUrl=ko.observable(""),this.checkins=ko.observable()};e.prototype.contains=function(e,o){return o===!0?this.name().includes(e):this.name().toLowerCase().indexOf(e.toLowerCase())>-1},e.prototype.shortLatLng=function(){return Math.round(1e3*this.geometry().location.lat())/1e3+","+Math.round(1e3*this.geometry().location.lng())/1e3},e.prototype.getColor=function(){var e=this.checkins();switch(!0){case e>1e3:return"1";case e>600:return"2";case e>350:return"3";case e>120:return"4";case e>60:return"5";case e>30:return"6";case e>16:return"7";default:return"7"}},window.Location=e}(),function(){"use strict";var e=function(e){var o,t,n=this;n.infoWindow=ko.observable(),n.readyState=ko.observable(!1);var i={searchStr:"Long Beach, CA",center:{lat:33.77,lng:-118.194}};n.geolocationName=ko.observable(i.searchStr),n.cachedgeolocationName=ko.observable(i.searchStr),n.currentGeolocation=ko.observable(),n.locationsVm={},n.selectedLocation=ko.observable(),n.updateGeolocation=function(){""!==n.geolocationName().trim()?n.geo(n.geolocationName()):n.geolocationName(n.cachedgeolocationName())},n.initMap=function(){o=new google.maps.Map(document.getElementById("map"),{center:i.center,zoom:15,mapTypeId:google.maps.MapTypeId.TERRAIN}),console.log("Google Maps API has been called."),t=new google.maps.Geocoder,n.initInfoWindow(),n.placesService=new google.maps.places.PlacesService(o),n.placesService?(console.log("Google Places service has been initialized."),google.maps.event.addListenerOnce(o,"idle",function(){o.center?(n.readyState(!0),console.log("Google Maps has loaded successfully.")):alert("There was a problem loading the map.")})):alert("There was an error initializing Google Places service."),n.mapCopy=o},n.geo=function(e){t.geocode({address:e},function(t,i){i==google.maps.GeocoderStatus.OK?(n.cachedgeolocationName(e),o.setCenter(t[0].geometry.location),n.currentGeolocation({center:{lat:t[0].geometry.location.lat(),lng:t[0].geometry.location.lng()}}),n.initInfoWindow(),n.mapCopy=o,console.log("Location has been set to: "+e)):(n.geolocationName(n.cachedgeolocationName()),alert("Geocoding was unsuccessful for the following reason: "+i))})},n.initInfoWindow=function(){n.infoWindow(new google.maps.InfoWindow),$.ajax("./build/components/infowindow/infowindow.html").done(function(e){n.infoWindow().setContent(e),n.infoWindow().open(null);var o=!1;google.maps.event.addListener(n.infoWindow(),"domready",function(){o===!1&&(ko.applyBindings(n,document.getElementById("infowindow-overlay")),o=!0)}),google.maps.event.addListener(n.infoWindow(),"closeclick",function(){o=!1,n.initInfoWindow()})})},n.resetInfoWindow=function(){n.infoWindow().open(null),n.initInfoWindow()},n.centerMapAt=function(e){var t=new google.maps.LatLng(e.geometry().location.lat(),e.geometry().location.lng());o.panTo(t),n.mapCopy=o},n.addMarker=function(e,t,i){var a=t().visible()?o:null,s=new google.maps.Marker({map:a,title:e().name(),icon:"build/images/markers/marker_"+i+".png",position:e().geometry().location,id:e().place_id(),animation:google.maps.Animation.DROP});return function(o){google.maps.event.addListener(o,"click",function(){n.locationsVm.selectLocation(e()),n.showInfoWindow(e()),n.bounceAnimate(this)})}(s),s},n.showInfoWindow=function(e){n.infoWindow().open(o,e.marker)},n.showMarkersForVisibleActivities=function(e){_.each(e(),function(e){e().visible()===!0&&_.each(e().results(),function(e){n.showMarker(e)})})},n.hideMarker=function(e){e().marker.setMap(null)},n.showMarker=function(e){e().marker.getMap()!=o&&n.dropAnimate(e().marker)},n.dropAnimate=function(e){e.setMap(o),e.setAnimation(google.maps.Animation.DROP)},n.bounceAnimate=function(e){e.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){e.setAnimation(null)},2125)},window.initMap=n.initMap,window.mapCopy=n.mapCopy};window.MapViewModel=e}(),function(){"use strict";var e=function(){var e=this;e.makeQueryUrl=function(e){var o="https://api.foursquare.com/v2/venues/search",t="?client_id=PUXBJCP4B4HB2KIDIGQPHXEBAKWZPZO4HOWJZAJT45MOYWDO",n="&client_secret=D3NFA3PT5NC5440E5SJEOBJYYDN1BY20AASGXGF012F5Y1ND",i="&v=20130815",a="&ll="+e().shortLatLng(),s="&query="+e().name().split(" ").join("%20"),r="&limit=1";e().foursquareQueryUrl(o+t+n+i+a+s+r)},e.getCheckinsCountFor=function(e,o,t){ko.computed(function(){$.getJSON(e().foursquareQueryUrl()).then(function(n){if(n.response.venues.length>0){var i=n.response.venues[0].stats.checkinsCount;i?e().checkins(i):e().checkins(0)}else e().checkins(0);var a=e().getColor();e().marker=t(e,o,a)}).fail(function(){console.log("*****There was an error retrieving foursquare info for "+e().name()+"*****")})},this)}};window.foursquareService=e}(),function(){"use strict";var e=function(e,o){var t=this;t.filterQuery=ko.observable(""),t.selectedLocation=ko.observable("hello"),t.searchLocations=function(o){function n(n,a){if(a===google.maps.places.PlacesServiceStatus.OK&&n.length>0){var s=i(n);s.length>0?(_.each(s,function(n){var i=ko.observable(new Location(n));t.requestFoursquareData(i,o,e.addMarker),o().results.push(i)}),o().noResultsForLastGeolocation&&(o().noResultsForLastGeolocation=!1,o().visible(!0)),t.activities.push(o)):(o().visible(!1),o().noResultsForLastGeolocation=!0,t.activities.push(o),alert("Sorry, there are no locations for "+o().title+" in the current map bounds."))}else alert("Sorry, there was a problem retrieving results for the following reason: "+a)}function i(e){var o,t,n=[];return _.each(e,function(e){o=e.geometry.location.lat(),t=e.geometry.location.lng(),a.H.H<o&&o<a.H.j&&a.j.H>t&&t>a.j.j&&n.push(e)}),n}var a=e.mapCopy.getBounds();e.placesService.textSearch({bounds:a,query:o().title},n)},t.requestFoursquareData=function(e,t,n){o.makeQueryUrl(e),o.getCheckinsCountFor(e,t,n)},t.filterQuery.subscribe(function(){function o(){var o;_.each(t.activities(),function(n){n().results().length>0&&(_.each(n().results(),function(i){i().contains(t.filterQuery())?(i().visible(!0),n().hasFilterResults(!0),n().checked()===!0&&(e.showMarker(i),i().selected()===!0&&e.infoWindow().open(e.mapCopy,i().marker))):(i().visible(!1),e.hideMarker(i),i().selected()===!0&&e.resetInfoWindow(),o=!1,n().hasFilterResults(!1))}),_.some(n().results(),function(e){e().visible()&&n().checked()===!0&&(o=!0,n().hasFilterResults(!0))}),n().visible(o))})}function n(){return""===t.filterQuery().trim()}function i(){function e(e){0===e().results().length&&e().visible(!1),e().checked()===!0?e().results().length>0&&(e().visible(!0),e().hasFilterResults(!0)):e().results().length>0&&e().hasFilterResults(!0)}_.each(t.activities(),function(o){_.each(o().results(),function(e){e().visible(!0)}),e(o)})}n()?(i(),e.showMarkersForVisibleActivities(t.activities)):o()}),t.preventDefault=function(){},e.currentGeolocation.subscribe(function(){var e=t.activities();_.each(t.activities(),function(e){_.each(e().results(),function(e){e().marker.setMap(null)}),e().results([])}),t.activities([]),_.each(e,function(e){t.searchLocations(e)})}),t.selectLocation=function(o){t.clearCurrentSelections(),o.selected(!0),t.selectedLocation(o),e.showInfoWindow(o),e.centerMapAt(o),e.bounceAnimate(o.marker)},t.clearCurrentSelections=function(){_.each(t.activities(),function(e){_.each(e().results(),function(e){e().selected(!1)})})},t.assignColorsToLocations=function(){},t.getReferenceToActivitiesObject=function(e){t.activities=e},t.passSelfToMapVm=function(){e.locationsVm=t},t.passSelfToMapVm(),t.passSelectedLocationToMapVm=function(){e.selectedLocation(t.selectedLocation)},t.selectedLocation.subscribe(function(){t.passSelectedLocationToMapVm()})};window.LocationsViewModel=e}(),function(){"use strict";var e=function(e,o){var t=this;t.defaultActivities=["Coffee","Vegetarian","Park","Mexican","Art Gallery"],t.activities=ko.observableArray(),t.activityQuery=ko.observable(),e.readyState.subscribe(function(){e.readyState()===!0&&t.displayDefaultActivities()}),t.displayDefaultActivities=function(){t.passReferenceToLocationsVm(),_.each(t.defaultActivities,function(e){var t=ko.observable(new Activity(e));o.searchLocations(t)})},t.addActivity=function(){var e=ko.observable(new Activity(t.activityQuery()));o.searchLocations(e),t.activityQuery("")},t.passReferenceToLocationsVm=function(){o.getReferenceToActivitiesObject(t.activities)},t.activities.subscribe(function(){t.passReferenceToLocationsVm()}),t.resetInfoWindowWhenSelectedLocationToggledVisible=function(o){return _.each(o.results(),function(t){if(t().selected()===!0)switch(o.checked()){case!1:e.resetInfoWindow();break;case!0:e.infoWindow().open(e.mapCopy,t().marker)}}),!0}};window.ActivitiesViewModel=e}(),function(){"use strict";var e=function(){var e=this;e.foursquareService=new foursquareService,e.MapViewModel=new MapViewModel(e.foursquareService),e.LocationsViewModel=new LocationsViewModel(e.MapViewModel,e.foursquareService),e.ActivitiesViewModel=new ActivitiesViewModel(e.MapViewModel,e.LocationsViewModel)};window.AppViewModel=e}(),function(){"use strict";function e(e){var t,n,i,a;_.each(e,function(e){var s="#overlay-"+e;t=$("<div>"),n="./build/components/"+e+"/"+e+".html",i="#"+e,t.load(n,i,function(){a=$(this).prop("outerHTML"),$(s).append(a),ko.applyBindings(o,document.getElementById(e))})})}var o=new AppViewModel;e(["searchbar","sidebar"]),$(document).ready(function(){$("#overlay-searchbar").draggable(),$("#overlay-sidebar").draggable()})}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFjdGl2aXRpZXMvYWN0aXZpdHkuY29uc3RydWN0b3IuanMiLCJsb2NhdGlvbnMvbG9jYXRpb24uY29uc3RydWN0b3IuanMiLCJtYXAudmlld21vZGVsLmpzIiwiZm91cnNxdWFyZS5zZXJ2aWNlLmpzIiwibG9jYXRpb25zLnZpZXdtb2RlbC5qcyIsImFjdGl2aXRpZXMudmlld21vZGVsLmpzIiwiYXBwLnZpZXdtb2RlbC5qcyIsImFwcC5pbml0LmpzIl0sIm5hbWVzIjpbIkFjdGl2aXR5IiwiYWN0aXZpdHlRdWVyeSIsInRoaXMiLCJ0aXRsZSIsInJlc3VsdHMiLCJrbyIsIm9ic2VydmFibGVBcnJheSIsInZpc2libGUiLCJvYnNlcnZhYmxlIiwiY2hlY2tlZCIsImhhc0ZpbHRlclJlc3VsdHMiLCJwcm90b3R5cGUiLCJ0b2dnbGVNYXJrZXJzVmlzaWJsZSIsInNlbGYiLCJ0b2dnbGVDaGVja2VkIiwibGVuZ3RoIiwiZmlyc3RMb2NhdGlvbiIsIl8iLCJoZWFkIiwibWFya2VyIiwiZ2V0TWFwIiwibWFwUmVmZXJlbmNlIiwiZWFjaCIsImxvY2F0aW9uIiwic2V0TWFwIiwid2luZG93IiwiTG9jYXRpb24iLCJkYXRhIiwibmFtZSIsInNlbGVjdGVkIiwicGxhY2VfaWQiLCJmb3JtYXR0ZWRfYWRkcmVzcyIsImdlb21ldHJ5IiwidHlwZXMiLCJmb3Vyc3F1YXJlUXVlcnlVcmwiLCJjaGVja2lucyIsImNvbnRhaW5zIiwic3RyIiwiY2FzZVNlbnNpdGl2ZSIsImluY2x1ZGVzIiwidG9Mb3dlckNhc2UiLCJpbmRleE9mIiwic2hvcnRMYXRMbmciLCJNYXRoIiwicm91bmQiLCJsYXQiLCJsbmciLCJnZXRDb2xvciIsIk1hcFZpZXdNb2RlbCIsImZvdXJzcXVhcmVTZXJ2aWNlIiwibWFwIiwiZ2VvY29kZXIiLCJ2bSIsImluZm9XaW5kb3ciLCJyZWFkeVN0YXRlIiwibG9uZ0JlYWNoQ0EiLCJzZWFyY2hTdHIiLCJjZW50ZXIiLCJnZW9sb2NhdGlvbk5hbWUiLCJjYWNoZWRnZW9sb2NhdGlvbk5hbWUiLCJjdXJyZW50R2VvbG9jYXRpb24iLCJsb2NhdGlvbnNWbSIsInNlbGVjdGVkTG9jYXRpb24iLCJ1cGRhdGVHZW9sb2NhdGlvbiIsInRyaW0iLCJnZW8iLCJpbml0TWFwIiwiZ29vZ2xlIiwibWFwcyIsIk1hcCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJ6b29tIiwibWFwVHlwZUlkIiwiTWFwVHlwZUlkIiwiVEVSUkFJTiIsImNvbnNvbGUiLCJsb2ciLCJHZW9jb2RlciIsImluaXRJbmZvV2luZG93IiwicGxhY2VzU2VydmljZSIsInBsYWNlcyIsIlBsYWNlc1NlcnZpY2UiLCJldmVudCIsImFkZExpc3RlbmVyT25jZSIsImFsZXJ0IiwibWFwQ29weSIsImdlb2NvZGUiLCJhZGRyZXNzIiwic3RhdHVzIiwiR2VvY29kZXJTdGF0dXMiLCJPSyIsInNldENlbnRlciIsIkluZm9XaW5kb3ciLCIkIiwiYWpheCIsImRvbmUiLCJ0ZW1wbGF0ZSIsInNldENvbnRlbnQiLCJvcGVuIiwia29Cb3VuZCIsImFkZExpc3RlbmVyIiwiYXBwbHlCaW5kaW5ncyIsInJlc2V0SW5mb1dpbmRvdyIsImNlbnRlck1hcEF0IiwibGF0TG5nIiwiTGF0TG5nIiwicGFuVG8iLCJhZGRNYXJrZXIiLCJhY3Rpdml0eSIsImNvbG9yIiwidmlzaWJsZVN0YXRlIiwiTWFya2VyIiwiaWNvbiIsInBvc2l0aW9uIiwiaWQiLCJhbmltYXRpb24iLCJBbmltYXRpb24iLCJEUk9QIiwibWFya2VyQ29weSIsInNlbGVjdExvY2F0aW9uIiwic2hvd0luZm9XaW5kb3ciLCJib3VuY2VBbmltYXRlIiwic2hvd01hcmtlcnNGb3JWaXNpYmxlQWN0aXZpdGllcyIsImFjdGl2aXRpZXMiLCJzaG93TWFya2VyIiwiaGlkZU1hcmtlciIsImRyb3BBbmltYXRlIiwic2V0QW5pbWF0aW9uIiwiQk9VTkNFIiwic2V0VGltZW91dCIsImZvdXJzcXVhcmUiLCJtYWtlUXVlcnlVcmwiLCJiYXNlVXJsIiwiY2xpZW50SWQiLCJjbGllbnRTZWNyZXQiLCJ2ZXJzaW9uIiwicXVlcnkiLCJzcGxpdCIsImpvaW4iLCJsaW1pdCIsImdldENoZWNraW5zQ291bnRGb3IiLCJjYWxsYmFjayIsImNvbXB1dGVkIiwiZ2V0SlNPTiIsInRoZW4iLCJyZXMiLCJyZXNwb25zZSIsInZlbnVlcyIsImxvY2F0aW9uQ2hlY2tpbnMiLCJzdGF0cyIsImNoZWNraW5zQ291bnQiLCJmYWlsIiwiTG9jYXRpb25zVmlld01vZGVsIiwibWFwVm0iLCJmaWx0ZXJRdWVyeSIsInNlYXJjaExvY2F0aW9ucyIsIlBsYWNlc1NlcnZpY2VTdGF0dXMiLCJpbkJvdW5kTG9jYXRpb25zIiwic3VwcHJlc3NPdXRPZkJvdW5kc0xvY2F0aW9ucyIsImxvY2F0aW9uRGF0YSIsImxvYyIsInJlcXVlc3RGb3Vyc3F1YXJlRGF0YSIsInB1c2giLCJub1Jlc3VsdHNGb3JMYXN0R2VvbG9jYXRpb24iLCJsb2NhdGlvbnMiLCJsb2NMYXQiLCJsb2NMbmciLCJtYXBCb3VuZHMiLCJIIiwiaiIsImdldEJvdW5kcyIsInRleHRTZWFyY2giLCJib3VuZHMiLCJzdWJzY3JpYmUiLCJmaWx0ZXJSZXN1bHRzIiwiYWN0aXZpdHlWaXNpYmlsaXR5RHVyaW5nRmlsdGVyIiwic29tZSIsImZpbHRlcklucHV0SXNFbXB0eSIsInVuZmlsdGVyUmVzdWx0cyIsInJlc2V0SW5pdGlhbFZpc2liaWxpdHkiLCJwcmV2ZW50RGVmYXVsdCIsImNvcHkiLCJjbGVhckN1cnJlbnRTZWxlY3Rpb25zIiwiYXNzaWduQ29sb3JzVG9Mb2NhdGlvbnMiLCJnZXRSZWZlcmVuY2VUb0FjdGl2aXRpZXNPYmplY3QiLCJwYXNzU2VsZlRvTWFwVm0iLCJwYXNzU2VsZWN0ZWRMb2NhdGlvblRvTWFwVm0iLCJBY3Rpdml0aWVzVmlld01vZGVsIiwiZGVmYXVsdEFjdGl2aXRpZXMiLCJkaXNwbGF5RGVmYXVsdEFjdGl2aXRpZXMiLCJwYXNzUmVmZXJlbmNlVG9Mb2NhdGlvbnNWbSIsImFjdGl2aXR5TmFtZSIsImFkZEFjdGl2aXR5IiwicmVzZXRJbmZvV2luZG93V2hlblNlbGVjdGVkTG9jYXRpb25Ub2dnbGVkVmlzaWJsZSIsIkFwcFZpZXdNb2RlbCIsImRpc3BsYXlDb21wb25lbnRzIiwiY29tcG9uZW50cyIsIiRjb21wb25lbnQiLCJ0ZW1wbGF0ZVVybCIsImh0bWwiLCJjb21wb25lbnQiLCJjb250YWluZXIiLCJsb2FkIiwicHJvcCIsImFwcGVuZCIsImFwcCIsInJlYWR5IiwiZHJhZ2dhYmxlIl0sIm1hcHBpbmdzIjoiQ0FDQSxXQUVBLFlBRUEsSUFBQUEsR0FBQSxTQUFBQyxHQUVBQyxLQUFBQyxNQUFBRixFQUNBQyxLQUFBRSxRQUFBQyxHQUFBQyxrQkFDQUosS0FBQUssUUFBQUYsR0FBQUcsWUFBQSxHQUdBTixLQUFBTyxRQUFBSixHQUFBRyxZQUFBLEdBR0FOLEtBQUFRLGlCQUFBTCxHQUFBRyxhQUdBUixHQUFBVyxVQUFBQyxxQkFBQSxXQUVBLEdBQUFDLEdBQUFYLElBR0EsSUFGQVcsRUFBQUMsZ0JBRUFELEVBQUFULFVBQUFXLE9BQUEsRUFBQSxDQUVBLEdBQUFDLEdBQUFDLEVBQUFDLEtBQUFMLEVBQUFULFVBQ0EsUUFBQVksSUFBQUcsT0FBQUMsV0FDQVAsRUFBQVEsYUFBQUwsSUFBQUcsT0FBQUMsVUFHQUgsRUFBQUssS0FBQVQsRUFBQVQsVUFBQSxTQUFBbUIsR0FDQSxPQUFBQSxJQUFBSixPQUFBQyxTQUNBRyxJQUFBSixPQUFBSyxPQUFBWCxFQUFBUSxjQUdBRSxJQUFBSixPQUFBSyxPQUFBLFFBSUEsT0FBQSxHQUdBeEIsRUFBQVcsVUFBQUcsY0FBQSxXQUNBLEdBQUFELEdBQUFYLElBRUEsT0FEQVcsR0FBQUosU0FBQUksRUFBQUosWUFDQSxHQUtBZ0IsT0FBQXpCLFNBQUFBLEtDakRBLFdBRUEsWUFFQSxJQUFBMEIsR0FBQSxTQUFBQyxHQUVBekIsS0FBQTBCLEtBQUF2QixHQUFBRyxXQUFBbUIsRUFBQUMsTUFDQTFCLEtBQUFLLFFBQUFGLEdBQUFHLFlBQUEsR0FDQU4sS0FBQTJC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QUUsRUFBQSxJQUFBQSxFQUFBLFFBQ0F0RixFQUFBLElBQUFzRixFQUVBSCxFQUFBSyxLQUFBSixFQUFBcEYsRUFBQSxXQUNBcUYsRUFBQTFHLEVBQUE1RixNQUFBME0sS0FBQSxhQUNBOUcsRUFBQTRHLEdBQUFHLE9BQUFMLEdBRUFuTSxHQUFBaUcsY0FBQXdHLEVBQUF4SSxTQUFBQyxlQUFBa0ksUUExQkEsR0FBQUssR0FBQSxHQUFBWCxhQU1BQyxJQUFBLFlBQUEsWUE2QkF0RyxFQUFBeEIsVUFBQXlJLE1BQ0EsV0FFQWpILEVBQUEsc0JBQUFrSCxZQUNBbEgsRUFBQSxvQkFBQWtIIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxyXG4oZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICB2YXIgQWN0aXZpdHkgPSBmdW5jdGlvbiBBY3Rpdml0eShhY3Rpdml0eVF1ZXJ5KSB7XHJcblxyXG4gICAgICAgIHRoaXMudGl0bGUgPSBhY3Rpdml0eVF1ZXJ5O1xyXG4gICAgICAgIHRoaXMucmVzdWx0cyA9IGtvLm9ic2VydmFibGVBcnJheSgpO1xyXG4gICAgICAgIHRoaXMudmlzaWJsZSA9IGtvLm9ic2VydmFibGUodHJ1ZSk7XHJcblxyXG4gICAgICAgIC8vIFdlIHVzZSBgY2hlY2tlZGAgdG8gZGV0ZXJtaW5lIGlmIGFuIGFjdGl2aXR5IHdhcyBpbml0aWFsbHkgdmlzaWJsZSB3aGVuIHByaW9yIHRvIGFwcGx5aW5nIHRoZSBmaWx0ZXIgcXVlcnkuXHJcbiAgICAgICAgdGhpcy5jaGVja2VkID0ga28ub2JzZXJ2YWJsZSh0cnVlKTtcclxuXHJcbiAgICAgICAgLy8gV2UgdXNlIGBoYXNGaWx0ZXJSZXN1bHRzYCB0byBkZXRlcm1pbmUgaWYgdGhlIGFjdGl2aXR5IGNoZWNrYm94IHNob3VsZCBiZSBkaXNhYmxlZC5cclxuICAgICAgICB0aGlzLmhhc0ZpbHRlclJlc3VsdHMgPSBrby5vYnNlcnZhYmxlKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIEFjdGl2aXR5LnByb3RvdHlwZS50b2dnbGVNYXJrZXJzVmlzaWJsZSA9IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHNlbGYudG9nZ2xlQ2hlY2tlZCgpO1xyXG5cclxuICAgICAgICBpZiAoc2VsZi5yZXN1bHRzKCkubGVuZ3RoID4gMCkge1xyXG5cclxuICAgICAgICAgICAgdmFyIGZpcnN0TG9jYXRpb24gPSBfLmhlYWQoc2VsZi5yZXN1bHRzKCkpO1xyXG4gICAgICAgICAgICBpZiAoIGZpcnN0TG9jYXRpb24oKS5tYXJrZXIuZ2V0TWFwKCkgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYubWFwUmVmZXJlbmNlID0gZmlyc3RMb2NhdGlvbigpLm1hcmtlci5nZXRNYXAoKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgXy5lYWNoKHNlbGYucmVzdWx0cygpLCBmdW5jdGlvbiAobG9jYXRpb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChsb2NhdGlvbigpLm1hcmtlci5nZXRNYXAoKSA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uKCkubWFya2VyLnNldE1hcChzZWxmLm1hcFJlZmVyZW5jZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbigpLm1hcmtlci5zZXRNYXAobnVsbCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH07XHJcblxyXG4gICAgQWN0aXZpdHkucHJvdG90eXBlLnRvZ2dsZUNoZWNrZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHNlbGYuY2hlY2tlZCggIShzZWxmLmNoZWNrZWQoKSkpO1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfTtcclxuXHJcblxyXG5cclxuICAgIHdpbmRvdy5BY3Rpdml0eSA9IEFjdGl2aXR5O1xyXG5cclxufSkoKTtcclxuXHJcblxyXG4iLCJcclxuKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgdmFyIExvY2F0aW9uID0gZnVuY3Rpb24gTG9jYXRpb24oZGF0YSkge1xyXG5cclxuICAgICAgICB0aGlzLm5hbWUgPSBrby5vYnNlcnZhYmxlKGRhdGEubmFtZSk7XHJcbiAgICAgICAgdGhpcy52aXNpYmxlID0ga28ub2JzZXJ2YWJsZSh0cnVlKTtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkID0ga28ub2JzZXJ2YWJsZShmYWxzZSk7XHJcbiAgICAgICAgdGhpcy5wbGFjZV9pZCA9IGtvLm9ic2VydmFibGUoZGF0YS5wbGFjZV9pZCk7XHJcbiAgICAgICAgdGhpcy5mb3JtYXR0ZWRfYWRkcmVzcyA9IGtvLm9ic2VydmFibGUoZGF0YS5mb3JtYXR0ZWRfYWRkcmVzcyk7XHJcbiAgICAgICAgdGhpcy5nZW9tZXRyeSA9IGtvLm9ic2VydmFibGUoZGF0YS5nZW9tZXRyeSk7XHJcbiAgICAgICAgdGhpcy50eXBlcyA9IGtvLm9ic2VydmFibGVBcnJheShkYXRhLnR5cGVzKTtcclxuICAgICAgICB0aGlzLm1hcmtlciA9IG51bGw7XHJcblxyXG4gICAgICAgIHRoaXMuZm91cnNxdWFyZVF1ZXJ5VXJsID0ga28ub2JzZXJ2YWJsZSgnJyk7XHJcblxyXG4gICAgICAgIHRoaXMuY2hlY2tpbnMgPSBrby5vYnNlcnZhYmxlKCk7XHJcbiAgICB9O1xyXG5cclxuLy8gVE9ETzogQWxzbyBzZWFyY2ggZm9yIGBzdHJgIHdpdGhpbiBgTG9jYXRpb24udHlwZXNgLlxyXG4gICAgTG9jYXRpb24ucHJvdG90eXBlLmNvbnRhaW5zID0gZnVuY3Rpb24gKHN0ciwgY2FzZVNlbnNpdGl2ZSkge1xyXG4gICAgICAgIGlmIChjYXNlU2Vuc2l0aXZlID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm5hbWUoKS5pbmNsdWRlcyhzdHIpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm5hbWUoKS50b0xvd2VyQ2FzZSgpLmluZGV4T2Yoc3RyLnRvTG93ZXJDYXNlKCkpID4gLTE7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBMb2NhdGlvbi5wcm90b3R5cGUuc2hvcnRMYXRMbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIChNYXRoLnJvdW5kKHRoaXMuZ2VvbWV0cnkoKS5sb2NhdGlvbi5sYXQoKSAqIDEwMDApIC8gMTAwMCkgKyAnLCcgK1xyXG4gICAgICAgICAgICAgICAgKE1hdGgucm91bmQodGhpcy5nZW9tZXRyeSgpLmxvY2F0aW9uLmxuZygpICogMTAwMCkgLyAxMDAwKTtcclxuICAgIH07XHJcblxyXG4gICAgLy8gSSBrbm93IHRoaXMgc3dpdGNoIGlzIHRlcnJpYmxlLCBidXQgSSB1c2VkIGluIHBsYWNlIG9mIGEgZm9ybXVsYSBiZWNhdXNlIEkgd2FudGVkIHRvIGJlIGFibGUgdG8gZWFzaWx5IHR3ZWFrIHRoZVxyXG4gICAgLy8gdGhyZXNob2xkcyAodGhlc2UgYXJlIGFyYml0cmFyeSkgd2hlcmUgZGlmZmVyZW50IG1hcmtlciBjb2xvcnMgYXJlIHVzZWQuXHJcbiAgICBMb2NhdGlvbi5wcm90b3R5cGUuZ2V0Q29sb3IgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGNoZWNraW5zID0gdGhpcy5jaGVja2lucygpO1xyXG4gICAgICAgIHN3aXRjaCAodHJ1ZSkge1xyXG4gICAgICAgICAgICBjYXNlIChjaGVja2lucyA+IDEwMDApOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICcxJztcclxuICAgICAgICAgICAgY2FzZSAoY2hlY2tpbnMgPiA2MDApOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICcyJztcclxuICAgICAgICAgICAgY2FzZSAoY2hlY2tpbnMgPiAzNTApOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICczJztcclxuICAgICAgICAgICAgY2FzZSAoY2hlY2tpbnMgPiAxMjApOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICc0JztcclxuICAgICAgICAgICAgY2FzZSAoY2hlY2tpbnMgPiA2MCk6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJzUnO1xyXG4gICAgICAgICAgICBjYXNlIChjaGVja2lucyA+IDMwKTpcclxuICAgICAgICAgICAgICAgIHJldHVybiAnNic7XHJcbiAgICAgICAgICAgIGNhc2UgKGNoZWNraW5zID4gMTYpOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICc3JztcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHJldHVybiAnNyc7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICB3aW5kb3cuTG9jYXRpb24gPSBMb2NhdGlvbjtcclxuXHJcbn0pKCk7XHJcbiIsIlxyXG4oZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICB2YXIgTWFwVmlld01vZGVsID0gZnVuY3Rpb24oZm91cnNxdWFyZVNlcnZpY2UpIHtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVG9wLWxldmVsIHZhcmlhYmxlcyBhbmQgcHJvcGVydGllcyBmb3IgYE1hcFZpZXdNb2RlbCgpYFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XHJcblxyXG4gICAgICAgIC8vIEluaXRpYWxpemUgYG1hcGAsIGBpbmZvV2luZG93YCwgYW5kIGBnZW9jb2RlcmAgdmFyaWFibGVzIHdoaWNoIGFyZSBuZWVkZWQgaW4gb3VyIGBpbml0TWFwKClgIGNhbGxiYWNrIGZ1bmN0aW9uLlxyXG4gICAgICAgIHZhciBtYXAsXHJcbiAgICAgICAgICAgIGdlb2NvZGVyO1xyXG5cclxuICAgICAgICAvLyBJbml0aWFsaXplIGVtcHR5IHByb3BlcnR5IHRvIGhvbGQgdGhlIG1hcmtlciBpbmZvIHdpbmRvdy5cclxuICAgICAgICB2bS5pbmZvV2luZG93ID0ga28ub2JzZXJ2YWJsZSgpO1xyXG5cclxuICAgICAgICAvLyBgcmVhZHlTdGF0ZWAgaXMgc2V0IHRvIGB0cnVlYCBpbnNpZGUgdGhlIGBpbml0TWFwKClgIGZ1bmN0aW9uIG9ubHkgd2hlbiB0aGUgbWFwIGlzIGluIGBpZGxlYCBzdGF0ZSAoaW5kaWNhdGluZ1xyXG4gICAgICAgIC8vIHRoYXQgaXQgaGFzIHN1Y2Nlc3NmdWxseSBsb2FkZWQpLCBhbmQgYWxzbyBvbmNlIEdvb2dsZSBQbGFjZXMgU2VydmljZSBpcyBpbml0aWFsaXplZC4gYEFjdGl2aXRpZXNWaWV3TW9kZWxgXHJcbiAgICAgICAgLy8gbGlzdGVucyBmb3IgYSBjaGFuZ2UgdG8gYHJlYWR5U3RhdGVgIGluIG9yZGVyIHRvIGV4ZWN1dGUgdGhlIGRlZmF1bHQgYWN0aXZpdGllcyBHb29nbGUgUGxhY2VzIHF1ZXJ5IChvdGhlcndpc2VcclxuICAgICAgICAvLyB0aGUgc2VhcmNoIGV4ZWN1dGVzIGJlZm9yZSB0aGUgbWFwIGFuZCBQbGFjZXMgU2VydmljZSBhcmUgZnVsbHkgaW5pdGlhbGl6ZWQgJiB3ZSdsbCBzZWUgZXJyb3JzKS5cclxuICAgICAgICB2bS5yZWFkeVN0YXRlID0ga28ub2JzZXJ2YWJsZShmYWxzZSk7XHJcblxyXG4gICAgICAgIC8vIERlZmF1bHQgbG9jYXRpb25cclxuICAgICAgICB2YXIgbG9uZ0JlYWNoQ0EgPSB7XHJcbiAgICAgICAgICAgIHNlYXJjaFN0cjogJ0xvbmcgQmVhY2gsIENBJyxcclxuICAgICAgICAgICAgY2VudGVyOiB7bGF0OiAzMy43NzAsIGxuZzogLTExOC4xOTR9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBgZ2VvbG9jYXRpb25OYW1lYCBvYnNlcnZhYmxlIHdpdGggYSBkZWZhdWx0IGxvY2F0aW9uIHRleHQgdG8gYXBwZWFyIGluIHRoZSBsb2NhdGlvbiBzZWFyY2ggaW5wdXQuXHJcbiAgICAgICAgdm0uZ2VvbG9jYXRpb25OYW1lID0ga28ub2JzZXJ2YWJsZShsb25nQmVhY2hDQS5zZWFyY2hTdHIpO1xyXG4gICAgICAgIHZtLmNhY2hlZGdlb2xvY2F0aW9uTmFtZSA9IGtvLm9ic2VydmFibGUobG9uZ0JlYWNoQ0Euc2VhcmNoU3RyKTtcclxuXHJcbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBhbiBlbXB0eSBrby5vYnNlcnZhYmxlIG9iamVjdCB0byBzdG9yZSB0aGUgY3VycmVudCBsb2NhdGlvbi5cclxuICAgICAgICB2bS5jdXJyZW50R2VvbG9jYXRpb24gPSBrby5vYnNlcnZhYmxlKCk7XHJcblxyXG4gICAgICAgIC8vIFdlIHdpbGwgdXNlIGBsb2NhdGlvbnNWbWAgYXMgYSByZWZlcmVuY2UgdG8gYExvY2F0aW9uc1ZpZXdNb2RlbCgpYC4gVGhlc2UgcHJvcGVydGllcyBhcmUgdXNlZCBmb3IgZGF0YVxyXG4gICAgICAgIC8vIGJpbmRpbmcgaW5zaWRlIG9mIGxvY2F0aW9uIGluZm8gd2luZG93cy5cclxuICAgICAgICB2bS5sb2NhdGlvbnNWbSA9IHt9O1xyXG4gICAgICAgIHZtLnNlbGVjdGVkTG9jYXRpb24gPSBrby5vYnNlcnZhYmxlKCk7XHJcblxyXG5cclxuICAgICAgICAvKioqXHJcbiAgICAgICAgICogR29vZ2xlIE1hcHMgQVBJIGNhbGxzXHJcbiAgICAgICAgICovXHJcblxyXG4gICAgICAgIC8vIGB1cGRhdGVHZW9sb2NhdGlvbigpYCBpcyB0aGUgc3VibWl0IGZ1bmN0aW9uIGNhbGxlZCBmcm9tIHRoZSBsb2NhdGlvbiBmb3JtIGluICdzZWFyY2hiYXIuaHRtbC4nXHJcbiAgICAgICAgdm0udXBkYXRlR2VvbG9jYXRpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICh2bS5nZW9sb2NhdGlvbk5hbWUoKS50cmltKCkgIT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICB2bS5nZW8odm0uZ2VvbG9jYXRpb25OYW1lKCkpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdm0uZ2VvbG9jYXRpb25OYW1lKHZtLmNhY2hlZGdlb2xvY2F0aW9uTmFtZSgpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIEluaXRpYWxpemUgb3VyIG1hcC4gVGhpcyBpcyB0aGUgY2FsbGJhY2sgZnVuY3Rpb24gcGFyYW1ldGVyIGluIG91ciBHb29nbGUgTWFwcyBBUEkgcmVxdWVzdCBpbiAnaW5kZXguaHRtbCcuXHJcbiAgICAgICAgdm0uaW5pdE1hcCA9IGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSB0aGUgYG1hcGAuXHJcbiAgICAgICAgICAgIG1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpLCB7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gSGFyZCBjb2RlIGRvd250b3duIExvbmcgQmVhY2gsIENBIGNvb3JkaW5hdGVzLlxyXG4gICAgICAgICAgICAgICAgY2VudGVyOiBsb25nQmVhY2hDQS5jZW50ZXIsXHJcbiAgICAgICAgICAgICAgICB6b29tOiAxNSxcclxuICAgICAgICAgICAgICAgIG1hcFR5cGVJZDogZ29vZ2xlLm1hcHMuTWFwVHlwZUlkLlRFUlJBSU5cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnR29vZ2xlIE1hcHMgQVBJIGhhcyBiZWVuIGNhbGxlZC4nKTtcclxuXHJcbiAgICAgICAgICAgIC8vIEluaXRpYWxpemUgdGhlIGBnZW9jb2RlcmAuXHJcbiAgICAgICAgICAgIGdlb2NvZGVyID0gbmV3IGdvb2dsZS5tYXBzLkdlb2NvZGVyKCk7XHJcblxyXG4gICAgICAgICAgICAvLyBJbml0aWFsaXplIHRoZSBtYXJrZXIgaW5mbyB3aW5kb3dzLlxyXG4gICAgICAgICAgICB2bS5pbml0SW5mb1dpbmRvdygpO1xyXG5cclxuICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSBQbGFjZXMgU2VydmljZS5cclxuICAgICAgICAgICAgdm0ucGxhY2VzU2VydmljZSA9IG5ldyBnb29nbGUubWFwcy5wbGFjZXMuUGxhY2VzU2VydmljZShtYXApO1xyXG5cclxuICAgICAgICAgICAgaWYgKHZtLnBsYWNlc1NlcnZpY2UpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdHb29nbGUgUGxhY2VzIHNlcnZpY2UgaGFzIGJlZW4gaW5pdGlhbGl6ZWQuJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gU2V0IGByZWFkeVN0YXRlYCBwcm9wZXJ0eSB0byBgdHJ1ZWAgb25jZSBQbGFjZXMgU2VydmljZSBpcyBhdmFpbGFibGUgYW5kIHRoZSBtYXAgaGFzIGxvYWRlZCBzdWNjZXNzZnVsbHkuXHJcbiAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lck9uY2UobWFwLCAnaWRsZScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobWFwLmNlbnRlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2bS5yZWFkeVN0YXRlKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnR29vZ2xlIE1hcHMgaGFzIGxvYWRlZCBzdWNjZXNzZnVsbHkuJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KCdUaGVyZSB3YXMgYSBwcm9ibGVtIGxvYWRpbmcgdGhlIG1hcC4nKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhbGVydCgnVGhlcmUgd2FzIGFuIGVycm9yIGluaXRpYWxpemluZyBHb29nbGUgUGxhY2VzIHNlcnZpY2UuJyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIFNldHRpbmcgdGhlIGBtYXBgIG9iamVjdCB0byBgdm0ubWFwYCBkb2Vzbid0IHdvcmsgd2VsbCBhcyB0aGUgbWFwIGZhaWxzIHRvIGRpc3BsYXkgb2NjYXNpb25hbGx5ICh3aXRob3V0XHJcbiAgICAgICAgICAgIC8vIHByb3ZpZGluZyBhbnkgZXJyb3JzKS4gU3RvcmUgdGhlIGBtYXBgIGludG8gYHZtLm1hcENvcHlgIHByb3BlcnR5IHNvIHRoYXQgb3RoZXIgVmlld01vZGVscyBjYW4gYWNjZXNzIHRoZVxyXG4gICAgICAgICAgICAvLyBtYXAgcHJvcGVydGllcyB3aGVuIG5lZWRlZC5cclxuICAgICAgICAgICAgdm0ubWFwQ29weSA9IG1hcDtcclxuICAgICAgICB9O1xyXG5cclxuXHJcbiAgICAgICAgdm0uZ2VvID0gZnVuY3Rpb24gKGdlb2xvY2F0aW9uTmFtZSkge1xyXG4gICAgICAgICAgICBnZW9jb2Rlci5nZW9jb2RlKCB7ICdhZGRyZXNzJzogZ2VvbG9jYXRpb25OYW1lIH0sIGZ1bmN0aW9uIChyZXN1bHRzLCBzdGF0dXMpIHtcclxuICAgICAgICAgICAgICAgIGlmIChzdGF0dXMgPT0gZ29vZ2xlLm1hcHMuR2VvY29kZXJTdGF0dXMuT0spIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdm0uY2FjaGVkZ2VvbG9jYXRpb25OYW1lKGdlb2xvY2F0aW9uTmFtZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIG1hcC5zZXRDZW50ZXIocmVzdWx0c1swXS5nZW9tZXRyeS5sb2NhdGlvbik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIFN0b3JlIHRoZSBzdWNjZXNzZnVsbHkgZ2VvY29kZWQgY29vcmRpbmF0ZXMuIExvY2F0aW9uc1ZpZXdNb2RlbCBzdWJzY3JpYmVzIHRvIHRoaXMgcHJvcGVydHkgaW5cclxuICAgICAgICAgICAgICAgICAgICAvLyBvcmRlciB0byBzZWFyY2ggZm9yIG5ldyBhY3Rpdml0eSBsb2NhdGlvbnMgd2hlbmV2ZXIgdGhlIG1hcCBnZW9sb2NhdGlvbiBjaGFuZ2VzLlxyXG4gICAgICAgICAgICAgICAgICAgIHZtLmN1cnJlbnRHZW9sb2NhdGlvbih7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlbnRlcjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGF0OiByZXN1bHRzWzBdLmdlb21ldHJ5LmxvY2F0aW9uLmxhdCgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG5nOiByZXN1bHRzWzBdLmdlb21ldHJ5LmxvY2F0aW9uLmxuZygpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gUmVsb2FkIG1hcmtlciBpbmZvIHdpbmRvd3Mgd2hlbmV2ZXIgdGhlIGdlb2xvY2F0aW9uIGNoYW5nZXMuXHJcbiAgICAgICAgICAgICAgICAgICAgdm0uaW5pdEluZm9XaW5kb3coKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIG1hcENvcHkuXHJcbiAgICAgICAgICAgICAgICAgICAgdm0ubWFwQ29weSA9IG1hcDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0xvY2F0aW9uIGhhcyBiZWVuIHNldCB0bzogJyArIGdlb2xvY2F0aW9uTmFtZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB2bS5nZW9sb2NhdGlvbk5hbWUodm0uY2FjaGVkZ2VvbG9jYXRpb25OYW1lKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwiR2VvY29kaW5nIHdhcyB1bnN1Y2Nlc3NmdWwgZm9yIHRoZSBmb2xsb3dpbmcgcmVhc29uOiBcIiArIHN0YXR1cyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG5cclxuICAgICAgICB2bS5pbml0SW5mb1dpbmRvdyA9IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgIC8vIEluaXRpYWxpemUgaW5mb1dpbmRvdywgbG9hZCB0aGUgdGVtcGxhdGUgYW5kIGFwcGx5IGJpbmRpbmdzLlxyXG4gICAgICAgICAgICB2bS5pbmZvV2luZG93KG5ldyBnb29nbGUubWFwcy5JbmZvV2luZG93KCkpO1xyXG5cclxuICAgICAgICAgICAgJC5hamF4KCcuL2J1aWxkL2NvbXBvbmVudHMvaW5mb3dpbmRvdy9pbmZvd2luZG93Lmh0bWwnKVxyXG4gICAgICAgICAgICAgICAgLmRvbmUoZnVuY3Rpb24gKHRlbXBsYXRlKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZtLmluZm9XaW5kb3coKS5zZXRDb250ZW50KHRlbXBsYXRlKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gT3BlbmluZyB0aGUgaW5mbyB3aW5kb3cgd2l0aCB0aGUgYG1hcGAgcGFyYW0gc2V0IHRvIGBudWxsYCBzdGlsbCBhbGxvd3MgdXMgdG8gcGVyZm9ybSBrbm9ja291dFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGRhdGEgYmluZGluZyAoaWYgd2UgaGFkIHNldCB0byBgbWFwYCB3ZSB3b3VsZCBzZWUgYW4gZW1wdHkgaW5mbyB3aW5kb3cgaW4gdGhlIHVwcGVyLWxlZnQgd2hlbiB0aGVcclxuICAgICAgICAgICAgICAgICAgICAvLyBhcHAgc3RhcnRzKS5cclxuICAgICAgICAgICAgICAgICAgICB2bS5pbmZvV2luZG93KCkub3BlbihudWxsKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGtvQm91bmQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcih2bS5pbmZvV2luZG93KCksICdkb21yZWFkeScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGtvQm91bmQgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrby5hcHBseUJpbmRpbmdzKHZtLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5mb3dpbmRvdy1vdmVybGF5JykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAga29Cb3VuZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gV2hlbiB0aGUgaW5mbyB3aW5kb3cgaXMgY2xpY2tlZCBjbG9zZWQsIHdlIGxvc2UgaXRzIGtub2Nrb3V0IGJpbmRpbmcuIFdoZW4gdGhpcyBoYXBwZW5zLCBpbnZva2VcclxuICAgICAgICAgICAgICAgICAgICAvLyBgaW5pdEluZm9XaW5kb3coKWAgYWdhaW4gdG8gbWFrZSBpdCB3b3JrIHVwb24gcmVvcGVuaW5nLlxyXG4gICAgICAgICAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKHZtLmluZm9XaW5kb3coKSwgJ2Nsb3NlY2xpY2snLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGtvQm91bmQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdm0uaW5pdEluZm9XaW5kb3coKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIEl0IHdvdWxkIGJlIG5pY2UgaWYgdGhlcmUgd2FzIGFuIGBvbmNsb3NlYCBldmVudCBmb3IgaW5mbyB3aW5kb3dzLiBTaW5jZSB3ZSBzb21ldGltZXMgbmVlZCB0byBjbG9zZSB0aGVcclxuICAgICAgICAvLyBpbmZvIHdpbmRvdyBwcm9ncmFtbWF0aWNhbGx5LCBhcyBpcyB0aGUgY2FzZSB3aGVuIHRoZSBzZWxlY3RlZCBsb2NhdGlvbiBpcyBoaWRkZW4gdmlhIHRoZSBmaWx0ZXIsIG9yIHdoZW5cclxuICAgICAgICAvLyB0aGUgYWN0aXZpdHkgY29udGFpbmluZyB0aGUgc2VsZWN0ZWQgbG9jYXRpb24gaXMgdW5jaGVja2VkLCB3ZSBuZWVkIHRvIHJlc2V0IHRoZSBpbmZvIHdpbmRvdyBmb3Iga25vY2tvdXRcclxuICAgICAgICAvLyBiaW5kaW5ncyB0byB3b3JrIHByb3Blcmx5LlxyXG4gICAgICAgIHZtLnJlc2V0SW5mb1dpbmRvdyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdm0uaW5mb1dpbmRvdygpLm9wZW4obnVsbCk7IC8vIGhhY2suIGluZm9XaW5kb3cuY2xvc2UoKSB3YXMgbm90IHdvcmtpbmcgZm9yIG1lIGhlcmUuXHJcbiAgICAgICAgICAgIHZtLmluaXRJbmZvV2luZG93KCk7XHJcbiAgICAgICAgfTtcclxuXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqICBNYXAgb3JpZW50YXRpb24gbWV0aG9kc1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHZtLmNlbnRlck1hcEF0ID0gZnVuY3Rpb24gKGxvY2F0aW9uKSB7XHJcbiAgICAgICAgICAgIHZhciBsYXRMbmcgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGxvY2F0aW9uLmdlb21ldHJ5KCkubG9jYXRpb24ubGF0KCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLmdlb21ldHJ5KCkubG9jYXRpb24ubG5nKCkpO1xyXG4gICAgICAgICAgICBtYXAucGFuVG8obGF0TG5nKTtcclxuXHJcbiAgICAgICAgICAgIHZtLm1hcENvcHkgPSBtYXA7XHJcbiAgICAgICAgfTtcclxuXHJcblxyXG5cclxuICAgICAgICAvLyBUT0RPOiBpbmZvIHdpbmRvdyBrbyBiaW5kaW5nIGlzIGxvc3QgaWYgaW5mbyB3aW5kb3cgaXMgY2xvc2VkLlxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqICBNYXAgbWFya2VyIG1ldGhvZHNcclxuICAgICAgICAgKi9cclxuICAgICAgICAvLyBDaGFuZ2luZyBjb2xvciBvZiB0aGUgbWFya2VycyBiYXNlZCBvbiBmb3Vyc3F1YXJlIGNoZWNraW5zIHdhcyBhIGJpdCBvZiBhbiBhZnRlcnRob3VnaHQuIFJhdGhlciB0aGFuXHJcbiAgICAgICAgLy8gb3ZlcmhhdWwgbXkgY29kZSwgSSBvcHRlZCB0byBnZXQgYSBsaXR0bGUgbWVzc3kgd2l0aCBwYXNzaW5nIHRvbyBtYW55IHBhcmFtZXRlcnMgJiBjYWxsYmFjayBmdW5jdGlvbiBpblxyXG4gICAgICAgIC8vIG9yZGVyIHRvIG1ha2UgdGhpcyB3b3JrLiBTb3JyeSBpdCdzIGEgaGFja3khIVxyXG4gICAgICAgIHZtLmFkZE1hcmtlciA9IGZ1bmN0aW9uIChsb2NhdGlvbiwgYWN0aXZpdHksIGNvbG9yKSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgdmlzaWJsZVN0YXRlID0gYWN0aXZpdHkoKS52aXNpYmxlKCkgPyBtYXAgOiBudWxsO1xyXG5cclxuICAgICAgICAgICAgdmFyIG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xyXG4gICAgICAgICAgICAgICAgbWFwOiB2aXNpYmxlU3RhdGUsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogbG9jYXRpb24oKS5uYW1lKCksXHJcbiAgICAgICAgICAgICAgICBpY29uOiAnYnVpbGQvaW1hZ2VzL21hcmtlcnMvbWFya2VyXycgKyBjb2xvciArICcucG5nJyxcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBsb2NhdGlvbigpLmdlb21ldHJ5KCkubG9jYXRpb24sXHJcbiAgICAgICAgICAgICAgICBpZDogbG9jYXRpb24oKS5wbGFjZV9pZCgpLFxyXG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uOiBnb29nbGUubWFwcy5BbmltYXRpb24uRFJPUH0pO1xyXG5cclxuICAgICAgICAgICAgKGZ1bmN0aW9uIChtYXJrZXJDb3B5KSB7XHJcbiAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXJDb3B5LCAnY2xpY2snLCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdm0ubG9jYXRpb25zVm0uc2VsZWN0TG9jYXRpb24obG9jYXRpb24oKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZtLnNob3dJbmZvV2luZG93KGxvY2F0aW9uKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLmJvdW5jZUFuaW1hdGUodGhpcyk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSkobWFya2VyKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBtYXJrZXI7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdm0uc2hvd0luZm9XaW5kb3cgPSBmdW5jdGlvbiAobG9jYXRpb24pIHtcclxuICAgICAgICAgICAgdm0uaW5mb1dpbmRvdygpLm9wZW4obWFwLCBsb2NhdGlvbi5tYXJrZXIpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZtLnNob3dNYXJrZXJzRm9yVmlzaWJsZUFjdGl2aXRpZXMgPSBmdW5jdGlvbiAoYWN0aXZpdGllcykge1xyXG4gICAgICAgICAgICBfLmVhY2goYWN0aXZpdGllcygpLCBmdW5jdGlvbihhY3Rpdml0eSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGFjdGl2aXR5KCkudmlzaWJsZSgpID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgXy5lYWNoKGFjdGl2aXR5KCkucmVzdWx0cygpLCBmdW5jdGlvbihsb2NhdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2bS5zaG93TWFya2VyKGxvY2F0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdm0uaGlkZU1hcmtlciA9IGZ1bmN0aW9uIChsb2NhdGlvbikge1xyXG4gICAgICAgICAgICBsb2NhdGlvbigpLm1hcmtlci5zZXRNYXAobnVsbCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gVE9ETzogaW5mbyB3aW5kb3dzIG5vdCB3b3JraW5nIGFmdGVyIGZpbHRlciBwZXJmb3JtZWQuIEkgdGhpbmsgdGhpcyBtYXkgaGFwcGVuIHdoZW4gaW5mbyB3aW5kb3cgaXMgb3BlbiAmIGdldHMgaGlkZGVuIGR1cmluZyBmaWx0ZXIuXHJcbiAgICAgICAgdm0uc2hvd01hcmtlciA9IGZ1bmN0aW9uIChsb2NhdGlvbikge1xyXG4gICAgICAgICAgICAvLyBPbmx5IGRpc3BsYXkgdGhlIG1hcmtlciBpZiBpdCBpcyBub3QgYWxyZWFkeSB2aXNpYmxlLlxyXG4gICAgICAgICAgICBpZiAobG9jYXRpb24oKS5tYXJrZXIuZ2V0TWFwKCkgIT0gbWFwKSB7XHJcbiAgICAgICAgICAgICAgICB2bS5kcm9wQW5pbWF0ZShsb2NhdGlvbigpLm1hcmtlcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2bS5kcm9wQW5pbWF0ZSA9IGZ1bmN0aW9uIChtYXJrZXIpIHtcclxuICAgICAgICAgICAgbWFya2VyLnNldE1hcChtYXApO1xyXG4gICAgICAgICAgICBtYXJrZXIuc2V0QW5pbWF0aW9uKGdvb2dsZS5tYXBzLkFuaW1hdGlvbi5EUk9QKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2bS5ib3VuY2VBbmltYXRlID0gZnVuY3Rpb24gKG1hcmtlcikge1xyXG4gICAgICAgICAgICBtYXJrZXIuc2V0QW5pbWF0aW9uKGdvb2dsZS5tYXBzLkFuaW1hdGlvbi5CT1VOQ0UpO1xyXG5cclxuICAgICAgICAgICAgLy8gVHVybiBvZmYgYW5pbWF0aW9uIGFmdGVyIHNob3J0IHRpbWUuXHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgbWFya2VyLnNldEFuaW1hdGlvbihudWxsKTtcclxuICAgICAgICAgICAgfSwgMjEyNSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgd2luZG93LmluaXRNYXAgPSB2bS5pbml0TWFwO1xyXG4gICAgICAgIHdpbmRvdy5tYXBDb3B5ID0gdm0ubWFwQ29weTtcclxuICAgIH07XHJcblxyXG4gICAgd2luZG93Lk1hcFZpZXdNb2RlbCA9IE1hcFZpZXdNb2RlbDtcclxuXHJcbn0pKCk7XHJcbiIsIihmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIHZhciBmb3Vyc3F1YXJlU2VydmljZSA9IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgdmFyIGZvdXJzcXVhcmUgPSB0aGlzO1xyXG5cclxuICAgICAgICBmb3Vyc3F1YXJlLm1ha2VRdWVyeVVybCA9IGZ1bmN0aW9uIChsb2NhdGlvbikge1xyXG5cclxuICAgICAgICAgICAgLy8gcGVyIEFQSSBkb2NzLCAnL3NlYXJjaCcgaXMgcHJvYmFibHkgYmV0dGVyIGZvciBmaW5kaW5nIHNwZWNpZmljIGxvY2F0aW9uLCB3aGVyZWFzICcvZXhwbG9yZScgbWlnaHQgYmUgdXNlZCB0b1xyXG4gICAgICAgICAgICAvLyBmaW5kIG1vc3QgcG9wdWxhciBsb2NhdGlvbnMgb2YgYSBjYXRlZ29yeSBpbiBhIGdpdmVuIGFyZWEuXHJcbiAgICAgICAgICAgIHZhciBiYXNlVXJsID0gJ2h0dHBzOi8vYXBpLmZvdXJzcXVhcmUuY29tL3YyL3ZlbnVlcy9zZWFyY2gnLFxyXG5cclxuICAgICAgICAgICAgLy8gVE9ETzogcmVtb3ZlIGNsaWVudElkLlxyXG4gICAgICAgICAgICAgICAgY2xpZW50SWQgPSAnP2NsaWVudF9pZD1QVVhCSkNQNEI0SEIyS0lESUdRUEhYRUJBS1daUFpPNEhPV0paQUpUNDVNT1lXRE8nLFxyXG5cclxuICAgICAgICAgICAgLy8gVE9ETzogcmVtb3ZlIGNsaWVudFNlY3JldC5cclxuICAgICAgICAgICAgICAgIGNsaWVudFNlY3JldCA9ICcmY2xpZW50X3NlY3JldD1EM05GQTNQVDVOQzU0NDBFNVNKRU9CSllZRE4xQlkyMEFBU0dYR0YwMTJGNVkxTkQnLFxyXG4gICAgICAgICAgICAgICAgdmVyc2lvbiA9ICcmdj0yMDEzMDgxNScsXHJcbiAgICAgICAgICAgICAgICBsYXRMbmcgPSAnJmxsPScgKyBsb2NhdGlvbigpLnNob3J0TGF0TG5nKCksXHJcbiAgICAgICAgICAgICAgICBxdWVyeSA9ICcmcXVlcnk9JyArIGxvY2F0aW9uKCkubmFtZSgpLnNwbGl0KCcgJykuam9pbignJTIwJyksXHJcbiAgICAgICAgICAgICAgICBsaW1pdCA9ICcmbGltaXQ9MSc7XHJcblxyXG5cclxuICAgICAgICAgICAgbG9jYXRpb24oKS5mb3Vyc3F1YXJlUXVlcnlVcmwoICBiYXNlVXJsICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGllbnRJZCArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpZW50U2VjcmV0ICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXRMbmcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5ICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW1pdCk7XHJcblxyXG4gICAgICAgIH07XHJcblxyXG5cclxuICAgICAgICBmb3Vyc3F1YXJlLmdldENoZWNraW5zQ291bnRGb3IgPSBmdW5jdGlvbiAobG9jYXRpb24sIGFjdGl2aXR5LCBjYWxsYmFjaykge1xyXG5cclxuICAgICAgICAgICAga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgICAgICQuZ2V0SlNPTihsb2NhdGlvbigpLmZvdXJzcXVhcmVRdWVyeVVybCgpKVxyXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXMpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMucmVzcG9uc2UudmVudWVzLmxlbmd0aCA+IDApIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbG9jYXRpb25DaGVja2lucyA9IHJlcy5yZXNwb25zZS52ZW51ZXNbMF0uc3RhdHMuY2hlY2tpbnNDb3VudDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbkNoZWNraW5zID8gbG9jYXRpb24oKS5jaGVja2lucyhsb2NhdGlvbkNoZWNraW5zKSA6IGxvY2F0aW9uKCkuY2hlY2tpbnMoMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbigpLmNoZWNraW5zKDApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29sb3IgPSBsb2NhdGlvbigpLmdldENvbG9yKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbigpLm1hcmtlciA9IGNhbGxiYWNrKGxvY2F0aW9uLCBhY3Rpdml0eSwgY29sb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmZhaWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnKioqKipUaGVyZSB3YXMgYW4gZXJyb3IgcmV0cmlldmluZyBmb3Vyc3F1YXJlIGluZm8gZm9yICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24oKS5uYW1lKCkgKyAnKioqKionKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIH0sIHRoaXMpO1xyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG5cclxuICAgIHdpbmRvdy5mb3Vyc3F1YXJlU2VydmljZSA9IGZvdXJzcXVhcmVTZXJ2aWNlO1xyXG5cclxufSgpKTsiLCJcclxuKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgLy8gQSBgTG9jYXRpb25gIHJlcHJlc2VudHMgYW55IHBsYWNlIHJlc3VsdCBvZiBhbiBhY3Rpdml0eSBxdWVyeTsgbm90IHRvIGJlIGNvbmZ1c2VkIHdpdGggYSBnZW9sb2NhdGlvbiB3aGljaFxyXG4gICAgLy8gcmVwcmVzZW50cyBhIGNpdHkgb3IgZ2VvZ3JhcGhpYyByZWdpb24gcHJlc2VudGVkIG9uIHRoZSBtYXAuXHJcbiAgICB2YXIgTG9jYXRpb25zVmlld01vZGVsID0gZnVuY3Rpb24gKG1hcFZtLCBmb3Vyc3F1YXJlU2VydmljZSkge1xyXG5cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogIFRvcC1sZXZlbCB2YXJpYWJsZXMgYW5kIHByb3BlcnRpZXMgZm9yIGBMb2NhdGlvbnNWaWV3TW9kZWwoKWBcclxuICAgICAgICAgKi9cclxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG5cclxuICAgICAgICAvLyBJbml0aWFsaXplIGBmaWx0ZXJRdWVyeWAgb2JzZXJ2YWJsZSB0byBiaW5kIHRvIHVzZXIgaW5wdXQgaW4gdGhlIGxvY2F0aW9ucyBmaWx0ZXIgZm9ybS5cclxuICAgICAgICB2bS5maWx0ZXJRdWVyeSA9IGtvLm9ic2VydmFibGUoJycpO1xyXG5cclxuICAgICAgICB2bS5zZWxlY3RlZExvY2F0aW9uID0ga28ub2JzZXJ2YWJsZSgnaGVsbG8nKTtcclxuXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqICBBY3Rpdml0eSBsb2NhdGlvbnMgc2VhcmNoIGZ1bmN0aW9uXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdm0uc2VhcmNoTG9jYXRpb25zID0gZnVuY3Rpb24gKGFjdGl2aXR5KSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgbWFwQm91bmRzID0gbWFwVm0ubWFwQ29weS5nZXRCb3VuZHMoKTtcclxuXHJcbiAgICAgICAgICAgIG1hcFZtLnBsYWNlc1NlcnZpY2UudGV4dFNlYXJjaCh7XHJcbiAgICAgICAgICAgICAgICBib3VuZHM6IG1hcEJvdW5kcyxcclxuICAgICAgICAgICAgICAgIHF1ZXJ5OiBhY3Rpdml0eSgpLnRpdGxlXHJcbiAgICAgICAgICAgIH0sIGNhbGxiYWNrKTtcclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGNhbGxiYWNrKHJlc3VsdHMsIHN0YXR1cykge1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChzdGF0dXMgPT09IGdvb2dsZS5tYXBzLnBsYWNlcy5QbGFjZXNTZXJ2aWNlU3RhdHVzLk9LICYmXHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0cy5sZW5ndGggPiAwKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbkJvdW5kTG9jYXRpb25zID0gc3VwcHJlc3NPdXRPZkJvdW5kc0xvY2F0aW9ucyhyZXN1bHRzKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgbG9jYXRpb25zIGFyZSBmb3VuZCBpbnNpZGUgb2YgdmlzaWJsZSBtYXAgYm91bmRhcmllcy5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoaW5Cb3VuZExvY2F0aW9ucy5sZW5ndGggPiAwKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDb25zdHJ1Y3QgYExvY2F0aW9uYCBvYnNlcnZhYmxlcyBhbmQgcHVzaCB0byBgYWN0aXZpdHkoKS5yZXN1bHRzYC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgXy5lYWNoKGluQm91bmRMb2NhdGlvbnMsIGZ1bmN0aW9uIChsb2NhdGlvbkRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsb2MgPSBrby5vYnNlcnZhYmxlKG5ldyBMb2NhdGlvbihsb2NhdGlvbkRhdGEpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZXF1ZXN0IGZvdXJzcXVhcmUgZGF0YSBmb3IgZWFjaCBsb2NhdGlvbiAmIHNhdmUgdGhlIHJlc3VsdHMgYXMgYSBsb2NhdGlvbiBwcm9wZXJ0eS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZtLnJlcXVlc3RGb3Vyc3F1YXJlRGF0YShsb2MsIGFjdGl2aXR5LCBtYXBWbS5hZGRNYXJrZXIpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5KCkucmVzdWx0cy5wdXNoKGxvYyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIHRoZSBhY3Rpdml0eSB3YXMgcHJldmlvdXNseSBtYWRlIGludmlzaWJsZSBkdWUgdG8gdGhlcmUgYmVpbmcgbm8gbG9jYXRpb24gcmVzdWx0cyBmb3IgYVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBwcmV2aW91cyBnZW9sb2NhdGlvbiwgc2V0IHRoZSB2aXNpYmlsaXR5IHRvIHRydWUgc28gdGhhdCB0aGUgcmVzdWx0cyB3aWxsIGJlIGRpc3BsYXllZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGl2aXR5KCkubm9SZXN1bHRzRm9yTGFzdEdlb2xvY2F0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpdml0eSgpLm5vUmVzdWx0c0Zvckxhc3RHZW9sb2NhdGlvbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHkoKS52aXNpYmxlKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2bS5hY3Rpdml0aWVzLnB1c2goYWN0aXZpdHkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHkoKS52aXNpYmxlKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHkoKS5ub1Jlc3VsdHNGb3JMYXN0R2VvbG9jYXRpb24gPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gV2Ugc3RpbGwgd2FudCB0byBzYXZlIHRoZSBhY3Rpdml0eSBzbyB0aGF0IGl0IGNhbiBiZSBxdWVyaWVkIGFnYWluIGZvciBuZXcgZ2VvbG9jYXRpb25zLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2bS5hY3Rpdml0aWVzLnB1c2goYWN0aXZpdHkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoJ1NvcnJ5LCB0aGVyZSBhcmUgbm8gbG9jYXRpb25zIGZvciAnICsgYWN0aXZpdHkoKS50aXRsZSArICcgaW4gdGhlIGN1cnJlbnQgbWFwIGJvdW5kcy4nKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBhbGVydCgnU29ycnksIHRoZXJlIHdhcyBhIHByb2JsZW0gcmV0cmlldmluZyByZXN1bHRzIGZvciB0aGUgZm9sbG93aW5nIHJlYXNvbjogJyArIHN0YXR1cyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIHN1cHByZXNzT3V0T2ZCb3VuZHNMb2NhdGlvbnMobG9jYXRpb25zKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbG9jTGF0LCBsb2NMbmc7XHJcbiAgICAgICAgICAgICAgICB2YXIgaW5Cb3VuZExvY2F0aW9ucyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgXy5lYWNoKGxvY2F0aW9ucywgZnVuY3Rpb24gKGxvY2F0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9jTGF0ID0gbG9jYXRpb24uZ2VvbWV0cnkubG9jYXRpb24ubGF0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9jTG5nID0gbG9jYXRpb24uZ2VvbWV0cnkubG9jYXRpb24ubG5nKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIFN0b3JlIGVhY2ggYGxvY2F0aW9uYCBvbmx5IGlmIGl0IGlzIGNvbnRhaW5lZCB3aXRoaW4gdGhlIG1hcCBib3VuZGFyaWVzIGF0IGN1cnJlbnQgem9vbSBsZXZlbC5cclxuICAgICAgICAgICAgICAgICAgICBpZiAobWFwQm91bmRzLkguSCA8IGxvY0xhdCAmJiBsb2NMYXQgPCBtYXBCb3VuZHMuSC5qICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcEJvdW5kcy5qLkggPiBsb2NMbmcgJiYgbG9jTG5nID4gbWFwQm91bmRzLmouaikge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5Cb3VuZExvY2F0aW9ucy5wdXNoKGxvY2F0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5Cb3VuZExvY2F0aW9ucztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiAgUmV0cmlldmUgZm91cnNxdWFyZSBkYXRhXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdm0ucmVxdWVzdEZvdXJzcXVhcmVEYXRhID0gZnVuY3Rpb24gKGxvY2F0aW9uLCBhY3Rpdml0eSwgY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgZm91cnNxdWFyZVNlcnZpY2UubWFrZVF1ZXJ5VXJsKGxvY2F0aW9uKTtcclxuICAgICAgICAgICAgZm91cnNxdWFyZVNlcnZpY2UuZ2V0Q2hlY2tpbnNDb3VudEZvcihsb2NhdGlvbiwgYWN0aXZpdHksIGNhbGxiYWNrKTtcclxuICAgICAgICB9O1xyXG5cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogIExvY2F0aW9ucyBmaWx0ZXIgZnVuY3Rpb25cclxuICAgICAgICAgKi9cclxuICAgICAgICB2bS5maWx0ZXJRdWVyeS5zdWJzY3JpYmUoZnVuY3Rpb24gZmlsdGVyQWxnb3JpdGhtKCkge1xyXG5cclxuICAgICAgICAgICAgaWYgKGZpbHRlcklucHV0SXNFbXB0eSgpKSB7XHJcbiAgICAgICAgICAgICAgICB1bmZpbHRlclJlc3VsdHMoKTtcclxuICAgICAgICAgICAgICAgIG1hcFZtLnNob3dNYXJrZXJzRm9yVmlzaWJsZUFjdGl2aXRpZXModm0uYWN0aXZpdGllcyk7XHJcblxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZmlsdGVyUmVzdWx0cygpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBUT0RPOiByZWRpc3BsYXkgc2VsZWN0ZWQgbG9jYXRpb24gaW5mbyB3aW5kb3cgYWZ0ZXIgZmlsdGVyLlxyXG4gICAgICAgICAgICBmdW5jdGlvbiBmaWx0ZXJSZXN1bHRzKCkge1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICB2YXIgYWN0aXZpdHlWaXNpYmlsaXR5RHVyaW5nRmlsdGVyO1xyXG5cclxuICAgICAgICAgICAgICAgIF8uZWFjaCh2bS5hY3Rpdml0aWVzKCksIGZ1bmN0aW9uIChhY3Rpdml0eSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aXZpdHkoKS5yZXN1bHRzKCkubGVuZ3RoID4gMCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgXy5lYWNoKGFjdGl2aXR5KCkucmVzdWx0cygpLCBmdW5jdGlvbiAobG9jYXRpb24pIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBIaWRlIHRoZSBsb2NhdGlvbiBsaXN0IGl0ZW1zIGFuZCBtYXAgbWFya2VycyBmb3IgZmlsdGVyZWQtb3V0IGxvY2F0aW9ucy5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCAhKGxvY2F0aW9uKCkuY29udGFpbnModm0uZmlsdGVyUXVlcnkoKSkpICkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbigpLnZpc2libGUoZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcFZtLmhpZGVNYXJrZXIobG9jYXRpb24pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobG9jYXRpb24oKS5zZWxlY3RlZCgpID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcFZtLnJlc2V0SW5mb1dpbmRvdygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIGBhY3Rpdml0eVZpc2liaWxpdHlEdXJpbmdGaWx0ZXJgIGFuZCBgaGFzRmlsdGVyUmVzdWx0c2Agc3RhdGVzIHdpbGwgb25seSByZW1haW5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBmYWxzZSBpZiB0aGVyZSBhcmUgemVybyBsb2NhdGlvbiByZXN1bHRzIHdpdGhpbiBhbiBhY3Rpdml0eSBjb250YWluaW5nIHRoZSBmaWx0ZXJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBxdWVyeSBzdHJpbmcuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHlWaXNpYmlsaXR5RHVyaW5nRmlsdGVyID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHkoKS5oYXNGaWx0ZXJSZXN1bHRzKGZhbHNlKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZS1kaXNwbGF5IHByZXZpb3VzbHkgaGlkZGVuIGxvY2F0aW9ucyBhbmQgbWFya2VycyAod2hlbiBgYmFja3NwYWNlYCBpcyBwcmVzc2VkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZvciBpbnN0YW5jZSkuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24oKS52aXNpYmxlKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5KCkuaGFzRmlsdGVyUmVzdWx0cyh0cnVlKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGl2aXR5KCkuY2hlY2tlZCgpID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcFZtLnNob3dNYXJrZXIobG9jYXRpb24pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVvcGVuIGluZm8gd2luZG93IGZvciBzZWxlY3RlZCBsb2NhdGlvbi5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxvY2F0aW9uKCkuc2VsZWN0ZWQoKSA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwVm0uaW5mb1dpbmRvdygpLm9wZW4obWFwVm0ubWFwQ29weSwgbG9jYXRpb24oKS5tYXJrZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIGFueSBhY3Rpdml0eSBsb2NhdGlvbnMgaGF2ZSBhcmUgdmlzaWJsZSBhZ2FpbiwgYW5kIGlmIHNvIHNldFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBgYWN0aXZpdHlWaXNpYmlsaXR5RHVyaW5nRmlsdGVyYCB0byB0cnVlIChzbyBsb25nIGFzIHRoZSBhY3Rpdml0eSB3YXMgYGNoZWNrZWRgIHByaW9yIHRvXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN0YXJ0aW5nIHRoZSBmaWx0ZXIgcXVlcnkpLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfLnNvbWUoYWN0aXZpdHkoKS5yZXN1bHRzKCksIGZ1bmN0aW9uIChsb2NhdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxvY2F0aW9uKCkudmlzaWJsZSgpICYmIGFjdGl2aXR5KCkuY2hlY2tlZCgpID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHlWaXNpYmlsaXR5RHVyaW5nRmlsdGVyID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpdml0eSgpLmhhc0ZpbHRlclJlc3VsdHModHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBVSSBhZnRlciBldmVyeSBrZXlzdHJva2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5KCkudmlzaWJsZShhY3Rpdml0eVZpc2liaWxpdHlEdXJpbmdGaWx0ZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBmaWx0ZXJJbnB1dElzRW1wdHkoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdm0uZmlsdGVyUXVlcnkoKS50cmltKCkgPT09ICcnO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiB1bmZpbHRlclJlc3VsdHMoKSB7XHJcbiAgICAgICAgICAgICAgICBfLmVhY2godm0uYWN0aXZpdGllcygpLCBmdW5jdGlvbiAoYWN0aXZpdHkpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgXy5lYWNoKGFjdGl2aXR5KCkucmVzdWx0cygpLCBmdW5jdGlvbiAobG9jYXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24oKS52aXNpYmxlKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXNldEluaXRpYWxWaXNpYmlsaXR5KGFjdGl2aXR5KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHJlc2V0SW5pdGlhbFZpc2liaWxpdHkoYWN0aXZpdHkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aXZpdHkoKS5yZXN1bHRzKCkubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5KCkudmlzaWJsZShmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aXZpdHkoKS5jaGVja2VkKCkgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGl2aXR5KCkucmVzdWx0cygpLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5KCkudmlzaWJsZSh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5KCkuaGFzRmlsdGVyUmVzdWx0cyh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhY3Rpdml0eSgpLnJlc3VsdHMoKS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpdml0eSgpLmhhc0ZpbHRlclJlc3VsdHModHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIEhhY2sgdG8gcHJldmVudCBwYWdlIHJlbG9hZCBvbiB0aGUgZmlsdGVyIGZvcm0gc3VibWlzc2lvbi5cclxuICAgICAgICB2bS5wcmV2ZW50RGVmYXVsdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgLy8gKGRvIG5vdGhpbmcuKVxyXG4gICAgICAgIH07XHJcblxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiAgVXBkYXRlIGxvY2F0aW9ucyB3aGVuIHRoZSBnZW9sb2NhdGlvbiBjaGFuZ2VzXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgbWFwVm0uY3VycmVudEdlb2xvY2F0aW9uLnN1YnNjcmliZShmdW5jdGlvbiB1cGRhdGVMb2NhdGlvbnMoKSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgY29weSA9IHZtLmFjdGl2aXRpZXMoKTtcclxuXHJcbiAgICAgICAgICAgIC8vIENsZWFyIGN1cnJlbnRseSBkaXNwbGF5ZWQgbWFwIG1hcmtlcnMsIGFuZCBjbGVhciBzdG9yZWQgTG9jYXRpb24gcmVzdWx0cy4gT25seSBjbGVhcmluZyB0aGUgZW50aXJlXHJcbiAgICAgICAgICAgIC8vIGB2bS5hY3Rpdml0aWVzKClgLCBhcyBiZWxvdyBvYmplY3QgZG9lcyBub3QgdXBkYXRlIHRoZSBVSSBpbiB0aGUgd2F5IG9uZSB3b3VsZCBleHBlY3Q7IHdpdGhvdXQgaXRlcmF0aW5nXHJcbiAgICAgICAgICAgIC8vIG92ZXIgdGhlIGFjdGl2aXR5IHJlc3VsdHMsIHRoZSBsb2NhdGlvbiByZXN1bHRzIGZvciB0aGUgcHJldmlvdXMgZ2VvbG9jYXRpb24gY29udGludWUgdG8gYXBwZWFyLlxyXG4gICAgICAgICAgICBfLmVhY2godm0uYWN0aXZpdGllcygpLCBmdW5jdGlvbiAoYWN0aXZpdHkpIHtcclxuICAgICAgICAgICAgICAgIF8uZWFjaChhY3Rpdml0eSgpLnJlc3VsdHMoKSwgZnVuY3Rpb24gKGxvY2F0aW9uKXtcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbigpLm1hcmtlci5zZXRNYXAobnVsbCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGFjdGl2aXR5KCkucmVzdWx0cyhbXSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgdm0uYWN0aXZpdGllcyhbXSk7XHJcblxyXG4gICAgICAgICAgICAvLyBVcGRhdGUgTG9jYXRpb24gcmVzdWx0cyBmb3IgbmV3IEdlb2xvY2F0aW9uXHJcbiAgICAgICAgICAgIF8uZWFjaChjb3B5LCBmdW5jdGlvbiAoYWN0aXZpdHkpIHtcclxuICAgICAgICAgICAgICAgIHZtLnNlYXJjaExvY2F0aW9ucyhhY3Rpdml0eSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogIFNlbGVjdGVkIGxvY2F0aW9uIGZ1bmN0aW9uc1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHZtLnNlbGVjdExvY2F0aW9uID0gZnVuY3Rpb24gKGxvY2F0aW9uKSB7XHJcblxyXG4gICAgICAgICAgICAvLyBVbi1zZWxlY3QgYWxsIGxvY2F0aW9ucyBzbyB0aGF0IG9ubHkgb25lIGxvY2F0aW9uIGFwcGVhcnMgc2VsZWN0ZWQgYXQgYSB0aW1lLlxyXG4gICAgICAgICAgICB2bS5jbGVhckN1cnJlbnRTZWxlY3Rpb25zKCk7XHJcblxyXG4gICAgICAgICAgICAvLyBUaGUgYHNlbGVjdGVkKClgIG9ic2VydmFibGUgcHJvcGVydHkgaXMgdXNlZCB0byBjb250cm9sIHRoZSBjc3MgYGJhY2tncm91bmQtY29sb3JgIG9mIHRoZSBsb2NhdGlvbiBlbGVtZW50LlxyXG4gICAgICAgICAgICBsb2NhdGlvbi5zZWxlY3RlZCh0cnVlKTtcclxuICAgICAgICAgICAgdm0uc2VsZWN0ZWRMb2NhdGlvbihsb2NhdGlvbik7XHJcblxyXG4gICAgICAgICAgICBtYXBWbS5zaG93SW5mb1dpbmRvdyhsb2NhdGlvbik7XHJcbiAgICAgICAgICAgIG1hcFZtLmNlbnRlck1hcEF0KGxvY2F0aW9uKTtcclxuICAgICAgICAgICAgbWFwVm0uYm91bmNlQW5pbWF0ZShsb2NhdGlvbi5tYXJrZXIpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZtLmNsZWFyQ3VycmVudFNlbGVjdGlvbnMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIF8uZWFjaCh2bS5hY3Rpdml0aWVzKCksIGZ1bmN0aW9uIChhY3Rpdml0eSkge1xyXG4gICAgICAgICAgICAgICAgXy5lYWNoKGFjdGl2aXR5KCkucmVzdWx0cygpLCBmdW5jdGlvbiAobG9jYXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbigpLnNlbGVjdGVkKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2bS5hc3NpZ25Db2xvcnNUb0xvY2F0aW9ucyA9IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdm0uZ2V0UmVmZXJlbmNlVG9BY3Rpdml0aWVzT2JqZWN0ID0gZnVuY3Rpb24gKGFjdGl2aXRpZXMpIHtcclxuICAgICAgICAgICAgdm0uYWN0aXZpdGllcyA9IGFjdGl2aXRpZXM7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdm0ucGFzc1NlbGZUb01hcFZtID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBtYXBWbS5sb2NhdGlvbnNWbSA9IHZtO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdm0ucGFzc1NlbGZUb01hcFZtKCk7XHJcblxyXG4gICAgICAgIHZtLnBhc3NTZWxlY3RlZExvY2F0aW9uVG9NYXBWbSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgbWFwVm0uc2VsZWN0ZWRMb2NhdGlvbih2bS5zZWxlY3RlZExvY2F0aW9uKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2bS5zZWxlY3RlZExvY2F0aW9uLnN1YnNjcmliZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgdm0ucGFzc1NlbGVjdGVkTG9jYXRpb25Ub01hcFZtKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIHdpbmRvdy5Mb2NhdGlvbnNWaWV3TW9kZWwgPSBMb2NhdGlvbnNWaWV3TW9kZWw7XHJcblxyXG59KSgpO1xyXG5cclxuIiwiXHJcbihmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIHZhciBBY3Rpdml0aWVzVmlld01vZGVsID0gZnVuY3Rpb24gKG1hcFZtLCBsb2NhdGlvbnNWbSkge1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiAgVG9wLWxldmVsIHZhcmlhYmxlcyBhbmQgcHJvcGVydGllcyBmb3IgYEFjdGl2aXRpZXNWaWV3TW9kZWwoKWBcclxuICAgICAgICAgKi9cclxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG5cclxuICAgICAgICB2bS5kZWZhdWx0QWN0aXZpdGllcyA9IFtcclxuICAgICAgICAgICAgJ0NvZmZlZScsXHJcbiAgICAgICAgICAgICdWZWdldGFyaWFuJyxcclxuICAgICAgICAgICAgJ1BhcmsnLFxyXG4gICAgICAgICAgICAnTWV4aWNhbicsXHJcbiAgICAgICAgICAgICdBcnQgR2FsbGVyeSddO1xyXG5cclxuICAgICAgICB2bS5hY3Rpdml0aWVzID0ga28ub2JzZXJ2YWJsZUFycmF5KCk7XHJcbiAgICAgICAgdm0uYWN0aXZpdHlRdWVyeSA9IGtvLm9ic2VydmFibGUoKTtcclxuXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqICBEaXNwbGF5IGxvY2F0aW9ucyBmb3IgZGVmYXVsdCBhY3Rpdml0aWVzXHJcbiAgICAgICAgICovXHJcblxyXG4gICAgICAgICAgICAvLyBTZWFyY2ggZm9yIChhbmQgZGlzcGxheSkgbG9jYXRpb25zIGZvciB0aGUgZGVmYXVsdCBhY3Rpdml0aWVzIG9uY2UgdGhlIG1hcCBoYXMgZnVsbHkgbG9hZGVkIGFuZCBHb29nbGUgUGxhY2VzXHJcbiAgICAgICAgICAgIC8vIFNlcnZpY2UgaXMgcmVhZHkgdG8gcmVjZWl2ZSBxdWVyaWVzLlxyXG4gICAgICAgIG1hcFZtLnJlYWR5U3RhdGUuc3Vic2NyaWJlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKG1hcFZtLnJlYWR5U3RhdGUoKSA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgdm0uZGlzcGxheURlZmF1bHRBY3Rpdml0aWVzKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdm0uZGlzcGxheURlZmF1bHRBY3Rpdml0aWVzID0gZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgdm0ucGFzc1JlZmVyZW5jZVRvTG9jYXRpb25zVm0oKTtcclxuXHJcbiAgICAgICAgICAgIF8uZWFjaCh2bS5kZWZhdWx0QWN0aXZpdGllcywgZnVuY3Rpb24gKGFjdGl2aXR5TmFtZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGFjdGl2aXR5ID0ga28ub2JzZXJ2YWJsZShuZXcgQWN0aXZpdHkoYWN0aXZpdHlOYW1lKSk7XHJcbiAgICAgICAgICAgICAgICBsb2NhdGlvbnNWbS5zZWFyY2hMb2NhdGlvbnMoYWN0aXZpdHkpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogIE5ldyBhY3Rpdml0eSBmdW5jdGlvbnNcclxuICAgICAgICAgKi9cclxuXHJcbiAgICAgICAgICAgIC8vIFRPRE86IFZhbGlkYXRlIGlucHV0IGFuZCBoYW5kbGUgZHVwbGljYXRlcyAoYWxzbyB3aGF0IGRvIGRvIGFmdGVyIG1hcCBpcyByZXNpemVkKS5cclxuICAgICAgICB2bS5hZGRBY3Rpdml0eSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGFjdGl2aXR5ID0ga28ub2JzZXJ2YWJsZShuZXcgQWN0aXZpdHkodm0uYWN0aXZpdHlRdWVyeSgpKSk7XHJcbiAgICAgICAgICAgIGxvY2F0aW9uc1ZtLnNlYXJjaExvY2F0aW9ucyhhY3Rpdml0eSk7XHJcbiAgICAgICAgICAgIHZtLmFjdGl2aXR5UXVlcnkoJycpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZtLnBhc3NSZWZlcmVuY2VUb0xvY2F0aW9uc1ZtID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBsb2NhdGlvbnNWbS5nZXRSZWZlcmVuY2VUb0FjdGl2aXRpZXNPYmplY3Qodm0uYWN0aXZpdGllcyk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdm0uYWN0aXZpdGllcy5zdWJzY3JpYmUoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2bS5wYXNzUmVmZXJlbmNlVG9Mb2NhdGlvbnNWbSgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB2bS5yZXNldEluZm9XaW5kb3dXaGVuU2VsZWN0ZWRMb2NhdGlvblRvZ2dsZWRWaXNpYmxlID0gZnVuY3Rpb24gKGFjdGl2aXR5KSB7XHJcblxyXG4gICAgICAgICAgICBfLmVhY2goYWN0aXZpdHkucmVzdWx0cygpLCBmdW5jdGlvbiAobG9jYXRpb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChsb2NhdGlvbigpLnNlbGVjdGVkKCkgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGFjdGl2aXR5LmNoZWNrZWQoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIGZhbHNlOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwVm0ucmVzZXRJbmZvV2luZG93KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSB0cnVlOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwVm0uaW5mb1dpbmRvdygpLm9wZW4obWFwVm0ubWFwQ29weSwgbG9jYXRpb24oKS5tYXJrZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIFxyXG4gICAgfTtcclxuXHJcbiAgICB3aW5kb3cuQWN0aXZpdGllc1ZpZXdNb2RlbCA9IEFjdGl2aXRpZXNWaWV3TW9kZWw7XHJcblxyXG59KCkpO1xyXG4iLCJcclxuKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBNYXN0ZXIgVmlld01vZGVsIGNvbnN0cnVjdG9yXHJcbiAgICAgKi9cclxuICAgIHZhciBBcHBWaWV3TW9kZWwgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHZtID0gdGhpcztcclxuXHJcbiAgICAgICAgdm0uZm91cnNxdWFyZVNlcnZpY2UgPSBuZXcgZm91cnNxdWFyZVNlcnZpY2UoKTtcclxuXHJcbiAgICAgICAgdm0uTWFwVmlld01vZGVsID0gbmV3IE1hcFZpZXdNb2RlbCh2bS5mb3Vyc3F1YXJlU2VydmljZSk7XHJcbiAgICAgICAgdm0uTG9jYXRpb25zVmlld01vZGVsID0gbmV3IExvY2F0aW9uc1ZpZXdNb2RlbCh2bS5NYXBWaWV3TW9kZWwsIHZtLmZvdXJzcXVhcmVTZXJ2aWNlKTtcclxuICAgICAgICB2bS5BY3Rpdml0aWVzVmlld01vZGVsID0gbmV3IEFjdGl2aXRpZXNWaWV3TW9kZWwodm0uTWFwVmlld01vZGVsLCB2bS5Mb2NhdGlvbnNWaWV3TW9kZWwpO1xyXG5cclxuICAgIH07XHJcblxyXG4gICAgd2luZG93LkFwcFZpZXdNb2RlbCA9IEFwcFZpZXdNb2RlbDtcclxuXHJcbn0oKSk7XHJcblxyXG5cclxuIiwiXHJcbihmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogIEluaXRpYWxpemUgdGhlIG1hc3RlciBWaWV3TW9kZWxcclxuICAgICAqL1xyXG4gICAgdmFyIGFwcCA9IG5ldyBBcHBWaWV3TW9kZWwoKTtcclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiAgUmVuZGVyIHRoZSBVSSBjb21wb25lbnRzLCBhbmQgYXBwbHkga25vY2tvdXQgZGF0YSBiaW5kaW5nc1xyXG4gICAgICovXHJcbiAgICBkaXNwbGF5Q29tcG9uZW50cyhbJ3NlYXJjaGJhcicsICdzaWRlYmFyJ10pO1xyXG5cclxuICAgIC8vIEZvciB0aGlzIHByb2plY3QsIEkgZGVjaWRlZCB0byBtYWtlIHRoaXMgY29tcG9uZW50IGxvYWRlciBpbiBsaWV1IG9mIHVzaW5nIHNvbWV0aGluZyBsaWtlIHJlcXVpcmVqcy4gSSBkaWRcclxuICAgIC8vIGF0dGVtcHQgdG8gaW1wbGVtZW50IHJlcXVpcmVqcywgYnV0IHRoZSBjb25zb2xlIGVycm9ycyBkaWRuJ3QgcHJvdmlkZSBtZSB3aXRoIHNwZWNpZmljIGVub3VnaCBpbmZvcm1hdGlvbiB0b1xyXG4gICAgLy8gc29ydCBvdXQgd2hhdCB3YXMgd3Jvbmcgd2l0aCBteSBjb2RlLiBJbiBhbnkgY2FzZSwgZm9yIHRoZSBzY29wZSBvZiB0aGlzIHNpbmdsZS1wYWdlLWFwcCwgbXkgc29sdXRpb24gc2VlbXMgdG9cclxuICAgIC8vIHdvcmsgZmluZS5cclxuICAgIGZ1bmN0aW9uIGRpc3BsYXlDb21wb25lbnRzKGNvbXBvbmVudHMpIHtcclxuXHJcbiAgICAgICAgdmFyICRjb21wb25lbnQsIHRlbXBsYXRlVXJsLCBpZCwgaHRtbDtcclxuICAgICAgICBfLmVhY2goY29tcG9uZW50cywgZnVuY3Rpb24gKGNvbXBvbmVudCkge1xyXG5cclxuICAgICAgICAgICAgdmFyIGNvbnRhaW5lciA9ICcjb3ZlcmxheS0nICsgY29tcG9uZW50O1xyXG4gICAgICAgICAgICAkY29tcG9uZW50ID0gJCgnPGRpdj4nKTtcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmwgPSAnLi9idWlsZC9jb21wb25lbnRzLycgKyBjb21wb25lbnQgKyAnLycgKyBjb21wb25lbnQgKyAnLmh0bWwnO1xyXG4gICAgICAgICAgICBpZCA9ICcjJyArIGNvbXBvbmVudDtcclxuXHJcbiAgICAgICAgICAgICRjb21wb25lbnQubG9hZCh0ZW1wbGF0ZVVybCwgaWQsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGh0bWwgPSAkKHRoaXMpLnByb3AoJ291dGVySFRNTCcpO1xyXG4gICAgICAgICAgICAgICAgJChjb250YWluZXIpLmFwcGVuZChodG1sKTtcclxuXHJcbiAgICAgICAgICAgICAgICBrby5hcHBseUJpbmRpbmdzKGFwcCwgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY29tcG9uZW50KSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqICBNYWtlIHRoZSBVSSBjb21wb25lbnRzIGRyYWdnYWJsZVxyXG4gICAgICovXHJcbiAgICAkKGRvY3VtZW50KS5yZWFkeShcclxuICAgICAgICBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgICAgICQoJyNvdmVybGF5LXNlYXJjaGJhcicpLmRyYWdnYWJsZSgpO1xyXG4gICAgICAgICAgICAkKCcjb3ZlcmxheS1zaWRlYmFyJykuZHJhZ2dhYmxlKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG59KCkpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
