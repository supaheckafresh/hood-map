!function(){"use strict";var e=function(e){this.title=e,this.results=ko.observableArray(),this.visible=ko.observable(!0),this.checked=ko.observable(!0),this.hasFilterResults=ko.observable()};e.prototype.toggleMarkersVisible=function(){var e=this;if(e.toggleChecked(),e.results().length>0){var o=_.head(e.results());null!==o().marker.getMap()&&(e.mapReference=o().marker.getMap()),_.each(e.results(),function(o){null===o().marker.getMap()?o().marker.setMap(e.mapReference):o().marker.setMap(null)})}return!0},e.prototype.toggleChecked=function(){var e=this;return e.checked(!e.checked()),!0},window.Activity=e}(),function(){"use strict";var e=function(e){this.name=ko.observable(e.name),this.visible=ko.observable(!0),this.selected=ko.observable(!1),this.place_id=ko.observable(e.place_id),this.formatted_address=ko.observable(e.formatted_address),this.geometry=ko.observable(e.geometry),this.types=ko.observableArray(e.types),this.marker=null,this.foursquareQueryUrl=ko.observable(""),this.checkins=ko.observable()};e.prototype.contains=function(e,o){return o===!0?this.name().includes(e):this.name().toLowerCase().indexOf(e.toLowerCase())>-1},e.prototype.shortLatLng=function(){return Math.round(1e3*this.geometry().location.lat())/1e3+","+Math.round(1e3*this.geometry().location.lng())/1e3},e.prototype.getColor=function(){var e=this.checkins();switch(!0){case e>1e3:return"1";case e>600:return"2";case e>350:return"3";case e>120:return"4";case e>60:return"5";case e>30:return"6";case e>16:return"7";default:return"7"}},window.Location=e}(),function(){"use strict";var e=function(e){var o=this;window.map=null;var t;o.infoWindow=ko.observable(),o.readyState=ko.observable(!1);var i={searchStr:"Long Beach, CA",center:{lat:33.77,lng:-118.194}};o.geolocationName=ko.observable(i.searchStr),o.cachedgeolocationName=ko.observable(i.searchStr),o.currentGeolocation=ko.observable(),o.locationsVm={},o.selectedLocation=ko.observable(),o.updateGeolocation=function(){""!==o.geolocationName().trim()?o.geo(o.geolocationName()):o.geolocationName(o.cachedgeolocationName())},window.initMap=function(){window.map=new google.maps.Map(document.getElementById("map"),{zoom:15,mapTypeId:google.maps.MapTypeId.TERRAIN}),console.log("Google Maps API has been called."),t=new google.maps.Geocoder,o.geo(o.geolocationName()),o.initInfoWindow(),o.placesService=new google.maps.places.PlacesService(map),o.placesService?(console.log("Google Places service has been initialized."),google.maps.event.addListenerOnce(map,"idle",function(){map.center?(o.readyState(!0),console.log("Google Maps has loaded successfully.")):alert("There was a problem loading the map.")})):alert("There was an error initializing Google Places service.")},o.geo=function(e){t.geocode({address:e},function(t,i){i==google.maps.GeocoderStatus.OK?(o.cachedgeolocationName(e),map.setCenter(t[0].geometry.location),o.currentGeolocation({center:{lat:t[0].geometry.location.lat(),lng:t[0].geometry.location.lng()}}),o.initInfoWindow(),console.log("Location has been set to: "+e)):(o.geolocationName(o.cachedgeolocationName()),alert("Geocoding was unsuccessful for the following reason: "+i))})},o.initInfoWindow=function(){o.infoWindow(new google.maps.InfoWindow),$.ajax("./build/components/infowindow/infowindow.html").done(function(e){o.infoWindow().setContent(e),o.infoWindow().open(null);var t=!1;google.maps.event.addListener(o.infoWindow(),"domready",function(){t===!1&&(ko.applyBindings(o,document.getElementById("infowindow-overlay")),t=!0)}),google.maps.event.addListener(o.infoWindow(),"closeclick",function(){t=!1,o.initInfoWindow()})})},o.resetInfoWindow=function(){o.infoWindow().open(null),o.initInfoWindow()},o.centerMapAt=function(e){var o=new google.maps.LatLng(e.geometry().location.lat(),e.geometry().location.lng());map.panTo(o)},o.addMarker=function(e,t,i){var n=t().visible()?map:null,a=new google.maps.Marker({map:n,title:e().name(),icon:"build/images/markers/marker_"+i+".png",position:e().geometry().location,id:e().place_id(),animation:google.maps.Animation.DROP});return function(t){google.maps.event.addListener(t,"click",function(){o.locationsVm.selectLocation(e()),o.showInfoWindow(e()),o.bounceAnimate(this)})}(a),a},o.showInfoWindow=function(e){o.infoWindow().open(map,e.marker)},o.showMarkersForVisibleActivities=function(e){_.each(e(),function(e){e().visible()===!0&&_.each(e().results(),function(e){o.showMarker(e)})})},o.hideMarker=function(e){e().marker.setMap(null)},o.showMarker=function(e){e().marker.getMap()!=map&&o.dropAnimate(e().marker)},o.dropAnimate=function(e){e.setMap(map),e.setAnimation(google.maps.Animation.DROP)},o.bounceAnimate=function(e){e.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){e.setAnimation(null)},2125)}};window.MapViewModel=e}(),function(){"use strict";var e=function(){var e=this;e.makeQueryUrl=function(e){var o="https://api.foursquare.com/v2/venues/search",t="?client_id=PUXBJCP4B4HB2KIDIGQPHXEBAKWZPZO4HOWJZAJT45MOYWDO",i="&client_secret=D3NFA3PT5NC5440E5SJEOBJYYDN1BY20AASGXGF012F5Y1ND",n="&v=20130815",a="&ll="+e().shortLatLng(),s="&query="+e().name().split(" ").join("%20"),r="&limit=1";e().foursquareQueryUrl(o+t+i+n+a+s+r)},e.getCheckinsCountFor=function(e,o,t){ko.computed(function(){$.getJSON(e().foursquareQueryUrl()).then(function(i){if(i.response.venues.length>0){var n=i.response.venues[0].stats.checkinsCount;n?e().checkins(n):e().checkins(0)}else e().checkins(0);var a=e().getColor();e().marker=t(e,o,a)}).fail(function(){console.log("*****There was an error retrieving foursquare info for "+e().name()+"*****")})},this)}};window.foursquareService=e}(),function(){"use strict";var e=function(e,o){var t=this;t.filterQuery=ko.observable(""),t.selectedLocation=ko.observable("hello"),t.activities=ko.observableArray([]),t.searchLocations=function(o){function i(i,a){if(a===google.maps.places.PlacesServiceStatus.OK&&i.length>0){var s=n(i);s.length>0?(_.each(s,function(i){var n=ko.observable(new Location(i));t.requestFoursquareData(n,o,e.addMarker),o().results.push(n)}),o().noResultsForLastGeolocation&&(o().noResultsForLastGeolocation=!1,o().visible(!0)),t.activities.push(o)):(o().visible(!1),o().noResultsForLastGeolocation=!0,t.activities.push(o),alert("Sorry, there are no locations for "+o().title+" in the current map bounds."))}else alert("Sorry, there was a problem retrieving results for the following reason: "+a)}function n(e){var o,t,i=[];return _.each(e,function(e){o=e.geometry.location.lat(),t=e.geometry.location.lng(),a.H.H<o&&o<a.H.j&&a.j.H>t&&t>a.j.j&&i.push(e)}),i}var a=window.map.getBounds();e.placesService.textSearch({bounds:a,query:o().title},i)},t.requestFoursquareData=function(e,t,i){o.makeQueryUrl(e),o.getCheckinsCountFor(e,t,i)},t.filterQuery.subscribe(function(){function o(){var o;_.each(t.activities(),function(i){i().results().length>0&&(_.each(i().results(),function(n){n().contains(t.filterQuery())?(n().visible(!0),i().hasFilterResults(!0),i().checked()===!0&&(e.showMarker(n),n().selected()===!0&&e.infoWindow().open(window.map,n().marker))):(n().visible(!1),e.hideMarker(n),n().selected()===!0&&e.resetInfoWindow(),o=!1,i().hasFilterResults(!1))}),_.some(i().results(),function(e){e().visible()&&i().checked()===!0&&(o=!0,i().hasFilterResults(!0))}),i().visible(o))})}function i(){return""===t.filterQuery().trim()}function n(){function e(e){0===e().results().length&&e().visible(!1),e().checked()===!0?e().results().length>0&&(e().visible(!0),e().hasFilterResults(!0)):e().results().length>0&&e().hasFilterResults(!0)}_.each(t.activities(),function(o){_.each(o().results(),function(e){e().visible(!0)}),e(o)})}i()?(n(),e.showMarkersForVisibleActivities(t.activities)):o()}),t.preventDefault=function(){},e.currentGeolocation.subscribe(function(){var e;t.activities()&&(e=t.activities()),_.each(t.activities(),function(e){_.each(e().results(),function(e){e().marker.setMap(null)}),e().results([])}),t.activities([]),_.each(e,function(e){t.searchLocations(e)})}),t.selectLocation=function(o){t.clearCurrentSelections(),o.selected(!0),t.selectedLocation(o),e.showInfoWindow(o),e.centerMapAt(o),e.bounceAnimate(o.marker)},t.clearCurrentSelections=function(){_.each(t.activities(),function(e){_.each(e().results(),function(e){e().selected(!1)})})},t.assignColorsToLocations=function(){},t.getReferenceToActivitiesObject=function(e){t.activities=e},t.passSelfToMapVm=function(){e.locationsVm=t},t.passSelfToMapVm(),t.passSelectedLocationToMapVm=function(){e.selectedLocation(t.selectedLocation)},t.selectedLocation.subscribe(function(){t.passSelectedLocationToMapVm()})};window.LocationsViewModel=e}(),function(){"use strict";var e=function(e,o){var t=this;t.defaultActivities=["Coffee","Vegetarian","Park","Mexican","Art Gallery"],t.activities=ko.observableArray(),t.activityQuery=ko.observable(),e.readyState.subscribe(function(){e.readyState()===!0&&t.displayDefaultActivities()}),t.displayDefaultActivities=function(){t.passReferenceToLocationsVm(),_.each(t.defaultActivities,function(e){var t=ko.observable(new Activity(e));o.searchLocations(t)})},t.addActivity=function(){var e=ko.observable(new Activity(t.activityQuery()));o.searchLocations(e),t.activityQuery("")},t.passReferenceToLocationsVm=function(){o.getReferenceToActivitiesObject(t.activities)},t.activities.subscribe(function(){t.passReferenceToLocationsVm()}),t.resetInfoWindowWhenSelectedLocationToggledVisible=function(o){return _.each(o.results(),function(t){if(t().selected()===!0)switch(o.checked()){case!1:e.resetInfoWindow();break;case!0:e.infoWindow().open(window.map,t().marker)}}),!0}};window.ActivitiesViewModel=e}(),function(){"use strict";var e=function(){var e=this;e.foursquareService=new foursquareService,e.MapViewModel=new MapViewModel(e.foursquareService),e.LocationsViewModel=new LocationsViewModel(e.MapViewModel,e.foursquareService),e.ActivitiesViewModel=new ActivitiesViewModel(e.MapViewModel,e.LocationsViewModel)};window.AppViewModel=e}(),function(){"use strict";function e(e){var t,i,n,a;_.each(e,function(e){var s="#overlay-"+e;t=$("<div>"),i="./build/components/"+e+"/"+e+".html",n="#"+e,t.load(i,n,function(){a=$(this).prop("outerHTML"),$(s).append(a),ko.applyBindings(o,document.getElementById(e))})})}var o=new AppViewModel;e(["searchbar","sidebar"]),$(document).ready(function(){$("#overlay-searchbar").draggable(),$("#overlay-sidebar").draggable(),$(document).on("click","#toggle-minimize-sidebar",function(){$(this).parent().toggleClass("show")})})}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFjdGl2aXRpZXMvYWN0aXZpdHkuY29uc3RydWN0b3IuanMiLCJsb2NhdGlvbnMvbG9jYXRpb24uY29uc3RydWN0b3IuanMiLCJtYXAudmlld21vZGVsLmpzIiwiZm91cnNxdWFyZS5zZXJ2aWNlLmpzIiwibG9jYXRpb25zLnZpZXdtb2RlbC5qcyIsImFjdGl2aXRpZXMudmlld21vZGVsLmpzIiwiYXBwLnZpZXdtb2RlbC5qcyIsImFwcC5pbml0LmpzIl0sIm5hbWVzIjpbIkFjdGl2aXR5IiwiYWN0aXZpdHlRdWVyeSIsInRoaXMiLCJ0aXRsZSIsInJlc3VsdHMiLCJrbyIsIm9ic2VydmFibGVBcnJheSIsInZpc2libGUiLCJvYnNlcnZhYmxlIiwiY2hlY2tlZCIsImhhc0ZpbHRlclJlc3VsdHMiLCJwcm90b3R5cGUiLCJ0b2dnbGVNYXJrZXJzVmlzaWJsZSIsInNlbGYiLCJ0b2dnbGVDaGVja2VkIiwibGVuZ3RoIiwiZmlyc3RMb2NhdGlvbiIsIl8iLCJoZWFkIiwibWFya2VyIiwiZ2V0TWFwIiwibWFwUmVmZXJlbmNlIiwiZWFjaCIsImxvY2F0aW9uIiwic2V0TWFwIiwid2luZG93IiwiTG9jYXRpb24iLCJkYXRhIiwibmFtZSIsInNlbGVjdGVkIiwicGxhY2VfaWQiLCJmb3JtYXR0ZWRfYWRkcmVzcyIsImdlb21ldHJ5IiwidHlwZXMiLCJmb3Vyc3F1YXJlUXVlcnlVcmwiLCJjaGVja2lucyIsImNvbnRhaW5zIiwic3RyIiwiY2FzZVNlbnNpdGl2ZSIsImluY2x1ZGVzIiwidG9Mb3dlckNhc2UiLCJpbmRleE9mIiwic2hvcnRMYXRMbmciLCJNYXRoIiwicm91bmQiLCJsYXQiLCJsbmciLCJnZXRDb2xvciIsIk1hcFZpZXdNb2RlbCIsImZvdXJzcXVhcmVTZXJ2aWNlIiwidm0iLCJtYXAiLCJnZW9jb2RlciIsImluZm9XaW5kb3ciLCJyZWFkeVN0YXRlIiwibG9uZ0JlYWNoQ0EiLCJzZWFyY2hTdHIiLCJjZW50ZXIiLCJnZW9sb2NhdGlvbk5hbWUiLCJjYWNoZWRnZW9sb2NhdGlvbk5hbWUiLCJjdXJyZW50R2VvbG9jYXRpb24iLCJsb2NhdGlvbnNWbSIsInNlbGVjdGVkTG9jYXRpb24iLCJ1cGRhdGVHZW9sb2NhdGlvbiIsInRyaW0iLCJnZW8iLCJpbml0TWFwIiwiZ29vZ2xlIiwibWFwcyIsIk1hcCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJ6b29tIiwibWFwVHlwZUlkIiwiTWFwVHlwZUlkIiwiVEVSUkFJTiIsImNvbnNvbGUiLCJsb2ciLCJHZW9jb2RlciIsImluaXRJbmZvV2luZG93IiwicGxhY2VzU2VydmljZSIsInBsYWNlcyIsIlBsYWNlc1NlcnZpY2UiLCJldmVudCIsImFkZExpc3RlbmVyT25jZSIsImFsZXJ0IiwiZ2VvY29kZSIsImFkZHJlc3MiLCJzdGF0dXMiLCJHZW9jb2RlclN0YXR1cyIsIk9LIiwic2V0Q2VudGVyIiwiSW5mb1dpbmRvdyIsIiQiLCJhamF4IiwiZG9uZSIsInRlbXBsYXRlIiwic2V0Q29udGVudCIsIm9wZW4iLCJrb0JvdW5kIiwiYWRkTGlzdGVuZXIiLCJhcHBseUJpbmRpbmdzIiwicmVzZXRJbmZvV2luZG93IiwiY2VudGVyTWFwQXQiLCJsYXRMbmciLCJMYXRMbmciLCJwYW5UbyIsImFkZE1hcmtlciIsImFjdGl2aXR5IiwiY29sb3IiLCJ2aXNpYmxlU3RhdGUiLCJNYXJrZXIiLCJpY29uIiwicG9zaXRpb24iLCJpZCIsImFuaW1hdGlvbiIsIkFuaW1hdGlvbiIsIkRST1AiLCJtYXJrZXJDb3B5Iiwic2VsZWN0TG9jYXRpb24iLCJzaG93SW5mb1dpbmRvdyIsImJvdW5jZUFuaW1hdGUiLCJzaG93TWFya2Vyc0ZvclZpc2libGVBY3Rpdml0aWVzIiwiYWN0aXZpdGllcyIsInNob3dNYXJrZXIiLCJoaWRlTWFya2VyIiwiZHJvcEFuaW1hdGUiLCJzZXRBbmltYXRpb24iLCJCT1VOQ0UiLCJzZXRUaW1lb3V0IiwiZm91cnNxdWFyZSIsIm1ha2VRdWVyeVVybCIsImJhc2VVcmwiLCJjbGllbnRJZCIsImNsaWVudFNlY3JldCIsInZlcnNpb24iLCJxdWVyeSIsInNwbGl0Iiwiam9pbiIsImxpbWl0IiwiZ2V0Q2hlY2tpbnNDb3VudEZvciIsImNhbGxiYWNrIiwiY29tcHV0ZWQiLCJnZXRKU09OIiwidGhlbiIsInJlcyIsInJlc3BvbnNlIiwidmVudWVzIiwibG9jYXRpb25DaGVja2lucyIsInN0YXRzIiwiY2hlY2tpbnNDb3VudCIsImZhaWwiLCJMb2NhdGlvbnNWaWV3TW9kZWwiLCJtYXBWbSIsImZpbHRlclF1ZXJ5Iiwic2VhcmNoTG9jYXRpb25zIiwiUGxhY2VzU2VydmljZVN0YXR1cyIsImluQm91bmRMb2NhdGlvbnMiLCJzdXBwcmVzc091dE9mQm91bmRzTG9jYXRpb25zIiwibG9jYXRpb25EYXRhIiwibG9jIiwicmVxdWVzdEZvdXJzcXVhcmVEYXRhIiwicHVzaCIsIm5vUmVzdWx0c0Zvckxhc3RHZW9sb2NhdGlvbiIsImxvY2F0aW9ucyIsImxvY0xhdCIsImxvY0xuZyIsIm1hcEJvdW5kcyIsIkgiLCJqIiwiZ2V0Qm91bmRzIiwidGV4dFNlYXJjaCIsImJvdW5kcyIsInN1YnNjcmliZSIsImZpbHRlclJlc3VsdHMiLCJhY3Rpdml0eVZpc2liaWxpdHlEdXJpbmdGaWx0ZXIiLCJzb21lIiwiZmlsdGVySW5wdXRJc0VtcHR5IiwidW5maWx0ZXJSZXN1bHRzIiwicmVzZXRJbml0aWFsVmlzaWJpbGl0eSIsInByZXZlbnREZWZhdWx0IiwiY29weSIsImNsZWFyQ3VycmVudFNlbGVjdGlvbnMiLCJhc3NpZ25Db2xvcnNUb0xvY2F0aW9ucyIsImdldFJlZmVyZW5jZVRvQWN0aXZpdGllc09iamVjdCIsInBhc3NTZWxmVG9NYXBWbSIsInBhc3NTZWxlY3RlZExvY2F0aW9uVG9NYXBWbSIsIkFjdGl2aXRpZXNWaWV3TW9kZWwiLCJkZWZhdWx0QWN0aXZpdGllcyIsImRpc3BsYXlEZWZhdWx0QWN0aXZpdGllcyIsInBhc3NSZWZlcmVuY2VUb0xvY2F0aW9uc1ZtIiwiYWN0aXZpdHlOYW1lIiwiYWRkQWN0aXZpdHkiLCJyZXNldEluZm9XaW5kb3dXaGVuU2VsZWN0ZWRMb2NhdGlvblRvZ2dsZWRWaXNpYmxlIiwiQXBwVmlld01vZGVsIiwiZGlzcGxheUNvbXBvbmVudHMiLCJjb21wb25lbnRzIiwiJGNvbXBvbmVudCIsInRlbXBsYXRlVXJsIiwiaHRtbCIsImNvbXBvbmVudCIsImNvbnRhaW5lciIsImxvYWQiLCJwcm9wIiwiYXBwZW5kIiwiYXBwIiwicmVhZHkiLCJkcmFnZ2FibGUiLCJvbiIsInBhcmVudCIsInRvZ2dsZUNsYXNzIl0sIm1hcHBpbmdzIjoiQ0FDQSxXQUVBLFlBRUEsSUFBQUEsR0FBQSxTQUFBQyxHQUVBQyxLQUFBQyxNQUFBRixFQUNBQyxLQUFBRSxRQUFBQyxHQUFBQyxrQkFDQUosS0FBQUssUUFBQUYsR0FBQUcsWUFBQSxHQUdBTixLQUFBTyxRQUFBSixHQUFBRyxZQUFBLEdBR0FOLEtBQUFRLGlCQUFBTCxHQUFBRyxhQUdBUixHQUFBVyxVQUFBQyxxQkFBQSxXQUVBLEdBQUFDLEdBQUFYLElBR0EsSUFGQVcsRUFBQUMsZ0JBRUFELEVBQUFULFVBQUFXLE9BQUEsRUFBQSxDQUVBLEdBQUFDLEdBQUFDLEVBQUFDLEtBQUFMLEVBQUFULFVBQ0EsUUFBQVksSUFBQUcsT0FBQUMsV0FDQVAsRUFBQVEsYUFBQUwsSUFBQUcsT0FBQUMsVUFHQUgsRUFBQUssS0FBQVQsRUFBQVQsVUFBQSxTQUFBbUIsR0FDQSxPQUFBQSxJQUFBSixPQUFBQyxTQUNBRyxJQUFBSixPQUFBSyxPQUFBWCxFQUFBUSxjQUdBRSxJQUFBSixPQUFBSyxPQUFBLFFBSUEsT0FBQSxHQUdBeEIsRUFBQVcsVUFBQUcsY0FBQSxXQUNBLEdBQUFELEdBQUFYLElBRUEsT0FEQVcsR0FBQUosU0FBQUksRUFBQUosWUFDQSxHQUtBZ0IsT0FBQXpCLFNBQUFBLEtDakRBLFdBRUEsWUFFQSxJQUFBMEIsR0FBQSxTQUFBQyxHQUVBekIsS0FBQTBCLEtBQUF2QixHQUFBRyxXQUFBbUIsRUFBQUMsTUFDQTFCLEtBQUFLLFFBQUFGLEdBQUFH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QSxRQUNBdEYsRUFBQSxJQUFBc0YsRUFFQUgsRUFBQUssS0FBQUosRUFBQXBGLEVBQUEsV0FDQXFGLEVBQUExRyxFQUFBM0YsTUFBQXlNLEtBQUEsYUFDQTlHLEVBQUE0RyxHQUFBRyxPQUFBTCxHQUVBbE0sR0FBQWdHLGNBQUF3RyxFQUFBdkksU0FBQUMsZUFBQWlJLFFBMUJBLEdBQUFLLEdBQUEsR0FBQVgsYUFNQUMsSUFBQSxZQUFBLFlBOEJBdEcsRUFBQXZCLFVBQUF3SSxNQUNBLFdBRUFqSCxFQUFBLHNCQUFBa0gsWUFDQWxILEVBQUEsb0JBQUFrSCxZQUVBbEgsRUFBQXZCLFVBQUEwSSxHQUFBLFFBQUEsMkJBQUEsV0FDQW5ILEVBQUEzRixNQUFBK00sU0FBQUMsWUFBQSIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcclxuKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgdmFyIEFjdGl2aXR5ID0gZnVuY3Rpb24gQWN0aXZpdHkoYWN0aXZpdHlRdWVyeSkge1xyXG5cclxuICAgICAgICB0aGlzLnRpdGxlID0gYWN0aXZpdHlRdWVyeTtcclxuICAgICAgICB0aGlzLnJlc3VsdHMgPSBrby5vYnNlcnZhYmxlQXJyYXkoKTtcclxuICAgICAgICB0aGlzLnZpc2libGUgPSBrby5vYnNlcnZhYmxlKHRydWUpO1xyXG5cclxuICAgICAgICAvLyBXZSB1c2UgYGNoZWNrZWRgIHRvIGRldGVybWluZSBpZiBhbiBhY3Rpdml0eSB3YXMgaW5pdGlhbGx5IHZpc2libGUgd2hlbiBwcmlvciB0byBhcHBseWluZyB0aGUgZmlsdGVyIHF1ZXJ5LlxyXG4gICAgICAgIHRoaXMuY2hlY2tlZCA9IGtvLm9ic2VydmFibGUodHJ1ZSk7XHJcblxyXG4gICAgICAgIC8vIFdlIHVzZSBgaGFzRmlsdGVyUmVzdWx0c2AgdG8gZGV0ZXJtaW5lIGlmIHRoZSBhY3Rpdml0eSBjaGVja2JveCBzaG91bGQgYmUgZGlzYWJsZWQuXHJcbiAgICAgICAgdGhpcy5oYXNGaWx0ZXJSZXN1bHRzID0ga28ub2JzZXJ2YWJsZSgpO1xyXG4gICAgfTtcclxuXHJcbiAgICBBY3Rpdml0eS5wcm90b3R5cGUudG9nZ2xlTWFya2Vyc1Zpc2libGUgPSBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBzZWxmLnRvZ2dsZUNoZWNrZWQoKTtcclxuXHJcbiAgICAgICAgaWYgKHNlbGYucmVzdWx0cygpLmxlbmd0aCA+IDApIHtcclxuXHJcbiAgICAgICAgICAgIHZhciBmaXJzdExvY2F0aW9uID0gXy5oZWFkKHNlbGYucmVzdWx0cygpKTtcclxuICAgICAgICAgICAgaWYgKCBmaXJzdExvY2F0aW9uKCkubWFya2VyLmdldE1hcCgpICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLm1hcFJlZmVyZW5jZSA9IGZpcnN0TG9jYXRpb24oKS5tYXJrZXIuZ2V0TWFwKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF8uZWFjaChzZWxmLnJlc3VsdHMoKSwgZnVuY3Rpb24gKGxvY2F0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobG9jYXRpb24oKS5tYXJrZXIuZ2V0TWFwKCkgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbigpLm1hcmtlci5zZXRNYXAoc2VsZi5tYXBSZWZlcmVuY2UpO1xyXG5cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24oKS5tYXJrZXIuc2V0TWFwKG51bGwpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9O1xyXG5cclxuICAgIEFjdGl2aXR5LnByb3RvdHlwZS50b2dnbGVDaGVja2VkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBzZWxmLmNoZWNrZWQoICEoc2VsZi5jaGVja2VkKCkpKTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH07XHJcblxyXG5cclxuXHJcbiAgICB3aW5kb3cuQWN0aXZpdHkgPSBBY3Rpdml0eTtcclxuXHJcbn0pKCk7XHJcblxyXG5cclxuIiwiXHJcbihmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIHZhciBMb2NhdGlvbiA9IGZ1bmN0aW9uIExvY2F0aW9uKGRhdGEpIHtcclxuXHJcbiAgICAgICAgdGhpcy5uYW1lID0ga28ub2JzZXJ2YWJsZShkYXRhLm5hbWUpO1xyXG4gICAgICAgIHRoaXMudmlzaWJsZSA9IGtvLm9ic2VydmFibGUodHJ1ZSk7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZCA9IGtvLm9ic2VydmFibGUoZmFsc2UpO1xyXG4gICAgICAgIHRoaXMucGxhY2VfaWQgPSBrby5vYnNlcnZhYmxlKGRhdGEucGxhY2VfaWQpO1xyXG4gICAgICAgIHRoaXMuZm9ybWF0dGVkX2FkZHJlc3MgPSBrby5vYnNlcnZhYmxlKGRhdGEuZm9ybWF0dGVkX2FkZHJlc3MpO1xyXG4gICAgICAgIHRoaXMuZ2VvbWV0cnkgPSBrby5vYnNlcnZhYmxlKGRhdGEuZ2VvbWV0cnkpO1xyXG4gICAgICAgIHRoaXMudHlwZXMgPSBrby5vYnNlcnZhYmxlQXJyYXkoZGF0YS50eXBlcyk7XHJcbiAgICAgICAgdGhpcy5tYXJrZXIgPSBudWxsO1xyXG5cclxuICAgICAgICB0aGlzLmZvdXJzcXVhcmVRdWVyeVVybCA9IGtvLm9ic2VydmFibGUoJycpO1xyXG5cclxuICAgICAgICB0aGlzLmNoZWNraW5zID0ga28ub2JzZXJ2YWJsZSgpO1xyXG4gICAgfTtcclxuXHJcbi8vIFRPRE86IEFsc28gc2VhcmNoIGZvciBgc3RyYCB3aXRoaW4gYExvY2F0aW9uLnR5cGVzYC5cclxuICAgIExvY2F0aW9uLnByb3RvdHlwZS5jb250YWlucyA9IGZ1bmN0aW9uIChzdHIsIGNhc2VTZW5zaXRpdmUpIHtcclxuICAgICAgICBpZiAoY2FzZVNlbnNpdGl2ZSA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5uYW1lKCkuaW5jbHVkZXMoc3RyKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5uYW1lKCkudG9Mb3dlckNhc2UoKS5pbmRleE9mKHN0ci50b0xvd2VyQ2FzZSgpKSA+IC0xO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgTG9jYXRpb24ucHJvdG90eXBlLnNob3J0TGF0TG5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiAoTWF0aC5yb3VuZCh0aGlzLmdlb21ldHJ5KCkubG9jYXRpb24ubGF0KCkgKiAxMDAwKSAvIDEwMDApICsgJywnICtcclxuICAgICAgICAgICAgICAgIChNYXRoLnJvdW5kKHRoaXMuZ2VvbWV0cnkoKS5sb2NhdGlvbi5sbmcoKSAqIDEwMDApIC8gMTAwMCk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIEkga25vdyB0aGlzIHN3aXRjaCBpcyB0ZXJyaWJsZSwgYnV0IEkgdXNlZCBpbiBwbGFjZSBvZiBhIGZvcm11bGEgYmVjYXVzZSBJIHdhbnRlZCB0byBiZSBhYmxlIHRvIGVhc2lseSB0d2VhayB0aGVcclxuICAgIC8vIHRocmVzaG9sZHMgKHRoZXNlIGFyZSBhcmJpdHJhcnkpIHdoZXJlIGRpZmZlcmVudCBtYXJrZXIgY29sb3JzIGFyZSB1c2VkLlxyXG4gICAgTG9jYXRpb24ucHJvdG90eXBlLmdldENvbG9yID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBjaGVja2lucyA9IHRoaXMuY2hlY2tpbnMoKTtcclxuICAgICAgICBzd2l0Y2ggKHRydWUpIHtcclxuICAgICAgICAgICAgY2FzZSAoY2hlY2tpbnMgPiAxMDAwKTpcclxuICAgICAgICAgICAgICAgIHJldHVybiAnMSc7XHJcbiAgICAgICAgICAgIGNhc2UgKGNoZWNraW5zID4gNjAwKTpcclxuICAgICAgICAgICAgICAgIHJldHVybiAnMic7XHJcbiAgICAgICAgICAgIGNhc2UgKGNoZWNraW5zID4gMzUwKTpcclxuICAgICAgICAgICAgICAgIHJldHVybiAnMyc7XHJcbiAgICAgICAgICAgIGNhc2UgKGNoZWNraW5zID4gMTIwKTpcclxuICAgICAgICAgICAgICAgIHJldHVybiAnNCc7XHJcbiAgICAgICAgICAgIGNhc2UgKGNoZWNraW5zID4gNjApOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICc1JztcclxuICAgICAgICAgICAgY2FzZSAoY2hlY2tpbnMgPiAzMCk6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJzYnO1xyXG4gICAgICAgICAgICBjYXNlIChjaGVja2lucyA+IDE2KTpcclxuICAgICAgICAgICAgICAgIHJldHVybiAnNyc7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJzcnO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgd2luZG93LkxvY2F0aW9uID0gTG9jYXRpb247XHJcblxyXG59KSgpO1xyXG4iLCJcclxuKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgdmFyIE1hcFZpZXdNb2RlbCA9IGZ1bmN0aW9uKGZvdXJzcXVhcmVTZXJ2aWNlKSB7XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRvcC1sZXZlbCB2YXJpYWJsZXMgYW5kIHByb3BlcnRpZXMgZm9yIGBNYXBWaWV3TW9kZWwoKWBcclxuICAgICAgICAgKi9cclxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG5cclxuICAgICAgICAvLyBJbml0aWFsaXplIGBtYXBgLCBgaW5mb1dpbmRvd2AsIGFuZCBgZ2VvY29kZXJgIHZhcmlhYmxlcyB3aGljaCBhcmUgbmVlZGVkIGluIG91ciBgaW5pdE1hcCgpYCBjYWxsYmFjayBmdW5jdGlvbi5cclxuICAgICAgICB3aW5kb3cubWFwID0gbnVsbDtcclxuICAgICAgICB2YXIgZ2VvY29kZXI7XHJcblxyXG4gICAgICAgIC8vIEluaXRpYWxpemUgZW1wdHkgcHJvcGVydHkgdG8gaG9sZCB0aGUgbWFya2VyIGluZm8gd2luZG93LlxyXG4gICAgICAgIHZtLmluZm9XaW5kb3cgPSBrby5vYnNlcnZhYmxlKCk7XHJcblxyXG4gICAgICAgIC8vIGByZWFkeVN0YXRlYCBpcyBzZXQgdG8gYHRydWVgIGluc2lkZSB0aGUgYGluaXRNYXAoKWAgZnVuY3Rpb24gb25seSB3aGVuIHRoZSBtYXAgaXMgaW4gYGlkbGVgIHN0YXRlIChpbmRpY2F0aW5nXHJcbiAgICAgICAgLy8gdGhhdCBpdCBoYXMgc3VjY2Vzc2Z1bGx5IGxvYWRlZCksIGFuZCBhbHNvIG9uY2UgR29vZ2xlIFBsYWNlcyBTZXJ2aWNlIGlzIGluaXRpYWxpemVkLiBgQWN0aXZpdGllc1ZpZXdNb2RlbGBcclxuICAgICAgICAvLyBsaXN0ZW5zIGZvciBhIGNoYW5nZSB0byBgcmVhZHlTdGF0ZWAgaW4gb3JkZXIgdG8gZXhlY3V0ZSB0aGUgZGVmYXVsdCBhY3Rpdml0aWVzIEdvb2dsZSBQbGFjZXMgcXVlcnkgKG90aGVyd2lzZVxyXG4gICAgICAgIC8vIHRoZSBzZWFyY2ggZXhlY3V0ZXMgYmVmb3JlIHRoZSBtYXAgYW5kIFBsYWNlcyBTZXJ2aWNlIGFyZSBmdWxseSBpbml0aWFsaXplZCAmIHdlJ2xsIHNlZSBlcnJvcnMpLlxyXG4gICAgICAgIHZtLnJlYWR5U3RhdGUgPSBrby5vYnNlcnZhYmxlKGZhbHNlKTtcclxuXHJcbiAgICAgICAgLy8gRGVmYXVsdCBsb2NhdGlvblxyXG4gICAgICAgIHZhciBsb25nQmVhY2hDQSA9IHtcclxuICAgICAgICAgICAgc2VhcmNoU3RyOiAnTG9uZyBCZWFjaCwgQ0EnLFxyXG4gICAgICAgICAgICBjZW50ZXI6IHtsYXQ6IDMzLjc3MCwgbG5nOiAtMTE4LjE5NH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvLyBJbml0aWFsaXplIGBnZW9sb2NhdGlvbk5hbWVgIG9ic2VydmFibGUgd2l0aCBhIGRlZmF1bHQgbG9jYXRpb24gdGV4dCB0byBhcHBlYXIgaW4gdGhlIGxvY2F0aW9uIHNlYXJjaCBpbnB1dC5cclxuICAgICAgICB2bS5nZW9sb2NhdGlvbk5hbWUgPSBrby5vYnNlcnZhYmxlKGxvbmdCZWFjaENBLnNlYXJjaFN0cik7XHJcbiAgICAgICAgdm0uY2FjaGVkZ2VvbG9jYXRpb25OYW1lID0ga28ub2JzZXJ2YWJsZShsb25nQmVhY2hDQS5zZWFyY2hTdHIpO1xyXG5cclxuICAgICAgICAvLyBJbml0aWFsaXplIGFuIGVtcHR5IGtvLm9ic2VydmFibGUgb2JqZWN0IHRvIHN0b3JlIHRoZSBjdXJyZW50IGxvY2F0aW9uLlxyXG4gICAgICAgIHZtLmN1cnJlbnRHZW9sb2NhdGlvbiA9IGtvLm9ic2VydmFibGUoKTtcclxuXHJcbiAgICAgICAgLy8gV2Ugd2lsbCB1c2UgYGxvY2F0aW9uc1ZtYCBhcyBhIHJlZmVyZW5jZSB0byBgTG9jYXRpb25zVmlld01vZGVsKClgLiBUaGVzZSBwcm9wZXJ0aWVzIGFyZSB1c2VkIGZvciBkYXRhXHJcbiAgICAgICAgLy8gYmluZGluZyBpbnNpZGUgb2YgbG9jYXRpb24gaW5mbyB3aW5kb3dzLlxyXG4gICAgICAgIHZtLmxvY2F0aW9uc1ZtID0ge307XHJcbiAgICAgICAgdm0uc2VsZWN0ZWRMb2NhdGlvbiA9IGtvLm9ic2VydmFibGUoKTtcclxuXHJcblxyXG4gICAgICAgIC8qKipcclxuICAgICAgICAgKiBHb29nbGUgTWFwcyBBUEkgY2FsbHNcclxuICAgICAgICAgKi9cclxuXHJcbiAgICAgICAgLy8gYHVwZGF0ZUdlb2xvY2F0aW9uKClgIGlzIHRoZSBzdWJtaXQgZnVuY3Rpb24gY2FsbGVkIGZyb20gdGhlIGxvY2F0aW9uIGZvcm0gaW4gJ3NlYXJjaGJhci5odG1sLidcclxuICAgICAgICB2bS51cGRhdGVHZW9sb2NhdGlvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKHZtLmdlb2xvY2F0aW9uTmFtZSgpLnRyaW0oKSAhPT0gJycpIHtcclxuICAgICAgICAgICAgICAgIHZtLmdlbyh2bS5nZW9sb2NhdGlvbk5hbWUoKSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB2bS5nZW9sb2NhdGlvbk5hbWUodm0uY2FjaGVkZ2VvbG9jYXRpb25OYW1lKCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBvdXIgbWFwLiBUaGlzIGlzIHRoZSBjYWxsYmFjayBmdW5jdGlvbiBwYXJhbWV0ZXIgaW4gb3VyIEdvb2dsZSBNYXBzIEFQSSByZXF1ZXN0IGluICdpbmRleC5odG1sJy5cclxuICAgICAgICB3aW5kb3cuaW5pdE1hcCA9IGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSB0aGUgYG1hcGAuXHJcbiAgICAgICAgICAgIHdpbmRvdy5tYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAnKSwge1xyXG4gICAgICAgICAgICAgICAgem9vbTogMTUsXHJcbiAgICAgICAgICAgICAgICBtYXBUeXBlSWQ6IGdvb2dsZS5tYXBzLk1hcFR5cGVJZC5URVJSQUlOXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ0dvb2dsZSBNYXBzIEFQSSBoYXMgYmVlbiBjYWxsZWQuJyk7XHJcblxyXG4gICAgICAgICAgICAvLyBJbml0aWFsaXplIHRoZSBgZ2VvY29kZXJgLlxyXG4gICAgICAgICAgICBnZW9jb2RlciA9IG5ldyBnb29nbGUubWFwcy5HZW9jb2RlcigpO1xyXG4gICAgICAgICAgICB2bS5nZW8odm0uZ2VvbG9jYXRpb25OYW1lKCkpO1xyXG5cclxuICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSB0aGUgbWFya2VyIGluZm8gd2luZG93cy5cclxuICAgICAgICAgICAgdm0uaW5pdEluZm9XaW5kb3coKTtcclxuXHJcbiAgICAgICAgICAgIC8vIEluaXRpYWxpemUgUGxhY2VzIFNlcnZpY2UuXHJcbiAgICAgICAgICAgIHZtLnBsYWNlc1NlcnZpY2UgPSBuZXcgZ29vZ2xlLm1hcHMucGxhY2VzLlBsYWNlc1NlcnZpY2UobWFwKTtcclxuXHJcbiAgICAgICAgICAgIGlmICh2bS5wbGFjZXNTZXJ2aWNlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnR29vZ2xlIFBsYWNlcyBzZXJ2aWNlIGhhcyBiZWVuIGluaXRpYWxpemVkLicpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIFNldCBgcmVhZHlTdGF0ZWAgcHJvcGVydHkgdG8gYHRydWVgIG9uY2UgUGxhY2VzIFNlcnZpY2UgaXMgYXZhaWxhYmxlIGFuZCB0aGUgbWFwIGhhcyBsb2FkZWQgc3VjY2Vzc2Z1bGx5LlxyXG4gICAgICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXJPbmNlKG1hcCwgJ2lkbGUnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1hcC5jZW50ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdm0ucmVhZHlTdGF0ZSh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0dvb2dsZSBNYXBzIGhhcyBsb2FkZWQgc3VjY2Vzc2Z1bGx5LicpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGVydCgnVGhlcmUgd2FzIGEgcHJvYmxlbSBsb2FkaW5nIHRoZSBtYXAuJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgYWxlcnQoJ1RoZXJlIHdhcyBhbiBlcnJvciBpbml0aWFsaXppbmcgR29vZ2xlIFBsYWNlcyBzZXJ2aWNlLicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcblxyXG4gICAgICAgIHZtLmdlbyA9IGZ1bmN0aW9uIChnZW9sb2NhdGlvbk5hbWUpIHtcclxuICAgICAgICAgICAgZ2VvY29kZXIuZ2VvY29kZSggeyAnYWRkcmVzcyc6IGdlb2xvY2F0aW9uTmFtZSB9LCBmdW5jdGlvbiAocmVzdWx0cywgc3RhdHVzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc3RhdHVzID09IGdvb2dsZS5tYXBzLkdlb2NvZGVyU3RhdHVzLk9LKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZtLmNhY2hlZGdlb2xvY2F0aW9uTmFtZShnZW9sb2NhdGlvbk5hbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBtYXAuc2V0Q2VudGVyKHJlc3VsdHNbMF0uZ2VvbWV0cnkubG9jYXRpb24pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBTdG9yZSB0aGUgc3VjY2Vzc2Z1bGx5IGdlb2NvZGVkIGNvb3JkaW5hdGVzLiBMb2NhdGlvbnNWaWV3TW9kZWwgc3Vic2NyaWJlcyB0byB0aGlzIHByb3BlcnR5IGluXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gb3JkZXIgdG8gc2VhcmNoIGZvciBuZXcgYWN0aXZpdHkgbG9jYXRpb25zIHdoZW5ldmVyIHRoZSBtYXAgZ2VvbG9jYXRpb24gY2hhbmdlcy5cclxuICAgICAgICAgICAgICAgICAgICB2bS5jdXJyZW50R2VvbG9jYXRpb24oe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjZW50ZXI6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhdDogcmVzdWx0c1swXS5nZW9tZXRyeS5sb2NhdGlvbi5sYXQoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxuZzogcmVzdWx0c1swXS5nZW9tZXRyeS5sb2NhdGlvbi5sbmcoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIFJlbG9hZCBtYXJrZXIgaW5mbyB3aW5kb3dzIHdoZW5ldmVyIHRoZSBnZW9sb2NhdGlvbiBjaGFuZ2VzLlxyXG4gICAgICAgICAgICAgICAgICAgIHZtLmluaXRJbmZvV2luZG93KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdMb2NhdGlvbiBoYXMgYmVlbiBzZXQgdG86ICcgKyBnZW9sb2NhdGlvbk5hbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdm0uZ2VvbG9jYXRpb25OYW1lKHZtLmNhY2hlZGdlb2xvY2F0aW9uTmFtZSgpKTtcclxuICAgICAgICAgICAgICAgICAgICBhbGVydChcIkdlb2NvZGluZyB3YXMgdW5zdWNjZXNzZnVsIGZvciB0aGUgZm9sbG93aW5nIHJlYXNvbjogXCIgKyBzdGF0dXMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuXHJcbiAgICAgICAgdm0uaW5pdEluZm9XaW5kb3cgPSBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICAvLyBJbml0aWFsaXplIGluZm9XaW5kb3csIGxvYWQgdGhlIHRlbXBsYXRlIGFuZCBhcHBseSBiaW5kaW5ncy5cclxuICAgICAgICAgICAgdm0uaW5mb1dpbmRvdyhuZXcgZ29vZ2xlLm1hcHMuSW5mb1dpbmRvdygpKTtcclxuXHJcbiAgICAgICAgICAgICQuYWpheCgnLi9idWlsZC9jb21wb25lbnRzL2luZm93aW5kb3cvaW5mb3dpbmRvdy5odG1sJylcclxuICAgICAgICAgICAgICAgIC5kb25lKGZ1bmN0aW9uICh0ZW1wbGF0ZSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2bS5pbmZvV2luZG93KCkuc2V0Q29udGVudCh0ZW1wbGF0ZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIE9wZW5pbmcgdGhlIGluZm8gd2luZG93IHdpdGggdGhlIGBtYXBgIHBhcmFtIHNldCB0byBgbnVsbGAgc3RpbGwgYWxsb3dzIHVzIHRvIHBlcmZvcm0ga25vY2tvdXRcclxuICAgICAgICAgICAgICAgICAgICAvLyBkYXRhIGJpbmRpbmcgKGlmIHdlIGhhZCBzZXQgdG8gYG1hcGAgd2Ugd291bGQgc2VlIGFuIGVtcHR5IGluZm8gd2luZG93IGluIHRoZSB1cHBlci1sZWZ0IHdoZW4gdGhlXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gYXBwIHN0YXJ0cykuXHJcbiAgICAgICAgICAgICAgICAgICAgdm0uaW5mb1dpbmRvdygpLm9wZW4obnVsbCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBrb0JvdW5kID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIodm0uaW5mb1dpbmRvdygpLCAnZG9tcmVhZHknLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrb0JvdW5kID09PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAga28uYXBwbHlCaW5kaW5ncyh2bSwgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2luZm93aW5kb3ctb3ZlcmxheScpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtvQm91bmQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIFdoZW4gdGhlIGluZm8gd2luZG93IGlzIGNsaWNrZWQgY2xvc2VkLCB3ZSBsb3NlIGl0cyBrbm9ja291dCBiaW5kaW5nLiBXaGVuIHRoaXMgaGFwcGVucywgaW52b2tlXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gYGluaXRJbmZvV2luZG93KClgIGFnYWluIHRvIG1ha2UgaXQgd29yayB1cG9uIHJlb3BlbmluZy5cclxuICAgICAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcih2bS5pbmZvV2luZG93KCksICdjbG9zZWNsaWNrJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBrb0JvdW5kID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZtLmluaXRJbmZvV2luZG93KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvLyBJdCB3b3VsZCBiZSBuaWNlIGlmIHRoZXJlIHdhcyBhbiBgb25jbG9zZWAgZXZlbnQgZm9yIGluZm8gd2luZG93cy4gU2luY2Ugd2Ugc29tZXRpbWVzIG5lZWQgdG8gY2xvc2UgdGhlXHJcbiAgICAgICAgLy8gaW5mbyB3aW5kb3cgcHJvZ3JhbW1hdGljYWxseSwgYXMgaXMgdGhlIGNhc2Ugd2hlbiB0aGUgc2VsZWN0ZWQgbG9jYXRpb24gaXMgaGlkZGVuIHZpYSB0aGUgZmlsdGVyLCBvciB3aGVuXHJcbiAgICAgICAgLy8gdGhlIGFjdGl2aXR5IGNvbnRhaW5pbmcgdGhlIHNlbGVjdGVkIGxvY2F0aW9uIGlzIHVuY2hlY2tlZCwgd2UgbmVlZCB0byByZXNldCB0aGUgaW5mbyB3aW5kb3cgZm9yIGtub2Nrb3V0XHJcbiAgICAgICAgLy8gYmluZGluZ3MgdG8gd29yayBwcm9wZXJseS5cclxuICAgICAgICB2bS5yZXNldEluZm9XaW5kb3cgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZtLmluZm9XaW5kb3coKS5vcGVuKG51bGwpOyAvLyBoYWNrLiBpbmZvV2luZG93LmNsb3NlKCkgd2FzIG5vdCB3b3JraW5nIGZvciBtZSBoZXJlLlxyXG4gICAgICAgICAgICB2bS5pbml0SW5mb1dpbmRvdygpO1xyXG4gICAgICAgIH07XHJcblxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiAgTWFwIG9yaWVudGF0aW9uIG1ldGhvZHNcclxuICAgICAgICAgKi9cclxuICAgICAgICB2bS5jZW50ZXJNYXBBdCA9IGZ1bmN0aW9uIChsb2NhdGlvbikge1xyXG4gICAgICAgICAgICB2YXIgbGF0TG5nID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhsb2NhdGlvbi5nZW9tZXRyeSgpLmxvY2F0aW9uLmxhdCgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5nZW9tZXRyeSgpLmxvY2F0aW9uLmxuZygpKTtcclxuICAgICAgICAgICAgbWFwLnBhblRvKGxhdExuZyk7XHJcbiAgICAgICAgfTtcclxuXHJcblxyXG5cclxuICAgICAgICAvLyBUT0RPOiBpbmZvIHdpbmRvdyBrbyBiaW5kaW5nIGlzIGxvc3QgaWYgaW5mbyB3aW5kb3cgaXMgY2xvc2VkLlxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqICBNYXAgbWFya2VyIG1ldGhvZHNcclxuICAgICAgICAgKi9cclxuICAgICAgICAvLyBDaGFuZ2luZyBjb2xvciBvZiB0aGUgbWFya2VycyBiYXNlZCBvbiBmb3Vyc3F1YXJlIGNoZWNraW5zIHdhcyBhIGJpdCBvZiBhbiBhZnRlcnRob3VnaHQuIFJhdGhlciB0aGFuXHJcbiAgICAgICAgLy8gb3ZlcmhhdWwgbXkgY29kZSwgSSBvcHRlZCB0byBnZXQgYSBsaXR0bGUgbWVzc3kgd2l0aCBwYXNzaW5nIHRvbyBtYW55IHBhcmFtZXRlcnMgJiBjYWxsYmFjayBmdW5jdGlvbiBpblxyXG4gICAgICAgIC8vIG9yZGVyIHRvIG1ha2UgdGhpcyB3b3JrLiBTb3JyeSBpdCdzIGEgaGFja3khIVxyXG4gICAgICAgIHZtLmFkZE1hcmtlciA9IGZ1bmN0aW9uIChsb2NhdGlvbiwgYWN0aXZpdHksIGNvbG9yKSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgdmlzaWJsZVN0YXRlID0gYWN0aXZpdHkoKS52aXNpYmxlKCkgPyBtYXAgOiBudWxsO1xyXG5cclxuICAgICAgICAgICAgdmFyIG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xyXG4gICAgICAgICAgICAgICAgbWFwOiB2aXNpYmxlU3RhdGUsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogbG9jYXRpb24oKS5uYW1lKCksXHJcbiAgICAgICAgICAgICAgICBpY29uOiAnYnVpbGQvaW1hZ2VzL21hcmtlcnMvbWFya2VyXycgKyBjb2xvciArICcucG5nJyxcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBsb2NhdGlvbigpLmdlb21ldHJ5KCkubG9jYXRpb24sXHJcbiAgICAgICAgICAgICAgICBpZDogbG9jYXRpb24oKS5wbGFjZV9pZCgpLFxyXG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uOiBnb29nbGUubWFwcy5BbmltYXRpb24uRFJPUH0pO1xyXG5cclxuICAgICAgICAgICAgKGZ1bmN0aW9uIChtYXJrZXJDb3B5KSB7XHJcbiAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXJDb3B5LCAnY2xpY2snLCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdm0ubG9jYXRpb25zVm0uc2VsZWN0TG9jYXRpb24obG9jYXRpb24oKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZtLnNob3dJbmZvV2luZG93KGxvY2F0aW9uKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZtLmJvdW5jZUFuaW1hdGUodGhpcyk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSkobWFya2VyKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBtYXJrZXI7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdm0uc2hvd0luZm9XaW5kb3cgPSBmdW5jdGlvbiAobG9jYXRpb24pIHtcclxuICAgICAgICAgICAgdm0uaW5mb1dpbmRvdygpLm9wZW4obWFwLCBsb2NhdGlvbi5tYXJrZXIpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZtLnNob3dNYXJrZXJzRm9yVmlzaWJsZUFjdGl2aXRpZXMgPSBmdW5jdGlvbiAoYWN0aXZpdGllcykge1xyXG4gICAgICAgICAgICBfLmVhY2goYWN0aXZpdGllcygpLCBmdW5jdGlvbihhY3Rpdml0eSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGFjdGl2aXR5KCkudmlzaWJsZSgpID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgXy5lYWNoKGFjdGl2aXR5KCkucmVzdWx0cygpLCBmdW5jdGlvbihsb2NhdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2bS5zaG93TWFya2VyKGxvY2F0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdm0uaGlkZU1hcmtlciA9IGZ1bmN0aW9uIChsb2NhdGlvbikge1xyXG4gICAgICAgICAgICBsb2NhdGlvbigpLm1hcmtlci5zZXRNYXAobnVsbCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gVE9ETzogaW5mbyB3aW5kb3dzIG5vdCB3b3JraW5nIGFmdGVyIGZpbHRlciBwZXJmb3JtZWQuIEkgdGhpbmsgdGhpcyBtYXkgaGFwcGVuIHdoZW4gaW5mbyB3aW5kb3cgaXMgb3BlbiAmIGdldHMgaGlkZGVuIGR1cmluZyBmaWx0ZXIuXHJcbiAgICAgICAgdm0uc2hvd01hcmtlciA9IGZ1bmN0aW9uIChsb2NhdGlvbikge1xyXG4gICAgICAgICAgICAvLyBPbmx5IGRpc3BsYXkgdGhlIG1hcmtlciBpZiBpdCBpcyBub3QgYWxyZWFkeSB2aXNpYmxlLlxyXG4gICAgICAgICAgICBpZiAobG9jYXRpb24oKS5tYXJrZXIuZ2V0TWFwKCkgIT0gbWFwKSB7XHJcbiAgICAgICAgICAgICAgICB2bS5kcm9wQW5pbWF0ZShsb2NhdGlvbigpLm1hcmtlcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2bS5kcm9wQW5pbWF0ZSA9IGZ1bmN0aW9uIChtYXJrZXIpIHtcclxuICAgICAgICAgICAgbWFya2VyLnNldE1hcChtYXApO1xyXG4gICAgICAgICAgICBtYXJrZXIuc2V0QW5pbWF0aW9uKGdvb2dsZS5tYXBzLkFuaW1hdGlvbi5EUk9QKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2bS5ib3VuY2VBbmltYXRlID0gZnVuY3Rpb24gKG1hcmtlcikge1xyXG4gICAgICAgICAgICBtYXJrZXIuc2V0QW5pbWF0aW9uKGdvb2dsZS5tYXBzLkFuaW1hdGlvbi5CT1VOQ0UpO1xyXG5cclxuICAgICAgICAgICAgLy8gVHVybiBvZmYgYW5pbWF0aW9uIGFmdGVyIHNob3J0IHRpbWUuXHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgbWFya2VyLnNldEFuaW1hdGlvbihudWxsKTtcclxuICAgICAgICAgICAgfSwgMjEyNSk7XHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcblxyXG4gICAgd2luZG93Lk1hcFZpZXdNb2RlbCA9IE1hcFZpZXdNb2RlbDtcclxuXHJcbn0pKCk7XHJcbiIsIihmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIHZhciBmb3Vyc3F1YXJlU2VydmljZSA9IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgdmFyIGZvdXJzcXVhcmUgPSB0aGlzO1xyXG5cclxuICAgICAgICBmb3Vyc3F1YXJlLm1ha2VRdWVyeVVybCA9IGZ1bmN0aW9uIChsb2NhdGlvbikge1xyXG5cclxuICAgICAgICAgICAgLy8gcGVyIEFQSSBkb2NzLCAnL3NlYXJjaCcgaXMgcHJvYmFibHkgYmV0dGVyIGZvciBmaW5kaW5nIHNwZWNpZmljIGxvY2F0aW9uLCB3aGVyZWFzICcvZXhwbG9yZScgbWlnaHQgYmUgdXNlZCB0b1xyXG4gICAgICAgICAgICAvLyBmaW5kIG1vc3QgcG9wdWxhciBsb2NhdGlvbnMgb2YgYSBjYXRlZ29yeSBpbiBhIGdpdmVuIGFyZWEuXHJcbiAgICAgICAgICAgIHZhciBiYXNlVXJsID0gJ2h0dHBzOi8vYXBpLmZvdXJzcXVhcmUuY29tL3YyL3ZlbnVlcy9zZWFyY2gnLFxyXG5cclxuICAgICAgICAgICAgLy8gVE9ETzogcmVtb3ZlIGNsaWVudElkLlxyXG4gICAgICAgICAgICAgICAgY2xpZW50SWQgPSAnP2NsaWVudF9pZD1QVVhCSkNQNEI0SEIyS0lESUdRUEhYRUJBS1daUFpPNEhPV0paQUpUNDVNT1lXRE8nLFxyXG5cclxuICAgICAgICAgICAgLy8gVE9ETzogcmVtb3ZlIGNsaWVudFNlY3JldC5cclxuICAgICAgICAgICAgICAgIGNsaWVudFNlY3JldCA9ICcmY2xpZW50X3NlY3JldD1EM05GQTNQVDVOQzU0NDBFNVNKRU9CSllZRE4xQlkyMEFBU0dYR0YwMTJGNVkxTkQnLFxyXG4gICAgICAgICAgICAgICAgdmVyc2lvbiA9ICcmdj0yMDEzMDgxNScsXHJcbiAgICAgICAgICAgICAgICBsYXRMbmcgPSAnJmxsPScgKyBsb2NhdGlvbigpLnNob3J0TGF0TG5nKCksXHJcbiAgICAgICAgICAgICAgICBxdWVyeSA9ICcmcXVlcnk9JyArIGxvY2F0aW9uKCkubmFtZSgpLnNwbGl0KCcgJykuam9pbignJTIwJyksXHJcbiAgICAgICAgICAgICAgICBsaW1pdCA9ICcmbGltaXQ9MSc7XHJcblxyXG5cclxuICAgICAgICAgICAgbG9jYXRpb24oKS5mb3Vyc3F1YXJlUXVlcnlVcmwoICBiYXNlVXJsICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGllbnRJZCArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpZW50U2VjcmV0ICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXRMbmcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5ICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW1pdCk7XHJcblxyXG4gICAgICAgIH07XHJcblxyXG5cclxuICAgICAgICBmb3Vyc3F1YXJlLmdldENoZWNraW5zQ291bnRGb3IgPSBmdW5jdGlvbiAobG9jYXRpb24sIGFjdGl2aXR5LCBjYWxsYmFjaykge1xyXG5cclxuICAgICAgICAgICAga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgICAgICQuZ2V0SlNPTihsb2NhdGlvbigpLmZvdXJzcXVhcmVRdWVyeVVybCgpKVxyXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXMpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMucmVzcG9uc2UudmVudWVzLmxlbmd0aCA+IDApIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbG9jYXRpb25DaGVja2lucyA9IHJlcy5yZXNwb25zZS52ZW51ZXNbMF0uc3RhdHMuY2hlY2tpbnNDb3VudDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbkNoZWNraW5zID8gbG9jYXRpb24oKS5jaGVja2lucyhsb2NhdGlvbkNoZWNraW5zKSA6IGxvY2F0aW9uKCkuY2hlY2tpbnMoMCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24oKS5jaGVja2lucygwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbG9yID0gbG9jYXRpb24oKS5nZXRDb2xvcigpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24oKS5tYXJrZXIgPSBjYWxsYmFjayhsb2NhdGlvbiwgYWN0aXZpdHksIGNvbG9yKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5mYWlsKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJyoqKioqVGhlcmUgd2FzIGFuIGVycm9yIHJldHJpZXZpbmcgZm91cnNxdWFyZSBpbmZvIGZvciAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uKCkubmFtZSgpICsgJyoqKioqJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB9LCB0aGlzKTtcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuXHJcbiAgICB3aW5kb3cuZm91cnNxdWFyZVNlcnZpY2UgPSBmb3Vyc3F1YXJlU2VydmljZTtcclxuXHJcbn0oKSk7IiwiXHJcbihmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIC8vIEEgYExvY2F0aW9uYCByZXByZXNlbnRzIGFueSBwbGFjZSByZXN1bHQgb2YgYW4gYWN0aXZpdHkgcXVlcnk7IG5vdCB0byBiZSBjb25mdXNlZCB3aXRoIGEgZ2VvbG9jYXRpb24gd2hpY2hcclxuICAgIC8vIHJlcHJlc2VudHMgYSBjaXR5IG9yIGdlb2dyYXBoaWMgcmVnaW9uIHByZXNlbnRlZCBvbiB0aGUgbWFwLlxyXG4gICAgdmFyIExvY2F0aW9uc1ZpZXdNb2RlbCA9IGZ1bmN0aW9uIChtYXBWbSwgZm91cnNxdWFyZVNlcnZpY2UpIHtcclxuXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqICBUb3AtbGV2ZWwgdmFyaWFibGVzIGFuZCBwcm9wZXJ0aWVzIGZvciBgTG9jYXRpb25zVmlld01vZGVsKClgXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdmFyIHZtID0gdGhpcztcclxuXHJcbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBgZmlsdGVyUXVlcnlgIG9ic2VydmFibGUgdG8gYmluZCB0byB1c2VyIGlucHV0IGluIHRoZSBsb2NhdGlvbnMgZmlsdGVyIGZvcm0uXHJcbiAgICAgICAgdm0uZmlsdGVyUXVlcnkgPSBrby5vYnNlcnZhYmxlKCcnKTtcclxuXHJcbiAgICAgICAgdm0uc2VsZWN0ZWRMb2NhdGlvbiA9IGtvLm9ic2VydmFibGUoJ2hlbGxvJyk7XHJcblxyXG4gICAgICAgIHZtLmFjdGl2aXRpZXMgPSBrby5vYnNlcnZhYmxlQXJyYXkoW10pO1xyXG5cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogIEFjdGl2aXR5IGxvY2F0aW9ucyBzZWFyY2ggZnVuY3Rpb25cclxuICAgICAgICAgKi9cclxuICAgICAgICB2bS5zZWFyY2hMb2NhdGlvbnMgPSBmdW5jdGlvbiAoYWN0aXZpdHkpIHtcclxuXHJcbiAgICAgICAgICAgIHZhciBtYXBCb3VuZHMgPSB3aW5kb3cubWFwLmdldEJvdW5kcygpO1xyXG5cclxuICAgICAgICAgICAgbWFwVm0ucGxhY2VzU2VydmljZS50ZXh0U2VhcmNoKHtcclxuICAgICAgICAgICAgICAgIGJvdW5kczogbWFwQm91bmRzLFxyXG4gICAgICAgICAgICAgICAgcXVlcnk6IGFjdGl2aXR5KCkudGl0bGVcclxuICAgICAgICAgICAgfSwgY2FsbGJhY2spO1xyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gY2FsbGJhY2socmVzdWx0cywgc3RhdHVzKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHN0YXR1cyA9PT0gZ29vZ2xlLm1hcHMucGxhY2VzLlBsYWNlc1NlcnZpY2VTdGF0dXMuT0sgJiZcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHRzLmxlbmd0aCA+IDApIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluQm91bmRMb2NhdGlvbnMgPSBzdXBwcmVzc091dE9mQm91bmRzTG9jYXRpb25zKHJlc3VsdHMpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiBsb2NhdGlvbnMgYXJlIGZvdW5kIGluc2lkZSBvZiB2aXNpYmxlIG1hcCBib3VuZGFyaWVzLlxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpbkJvdW5kTG9jYXRpb25zLmxlbmd0aCA+IDApIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENvbnN0cnVjdCBgTG9jYXRpb25gIG9ic2VydmFibGVzIGFuZCBwdXNoIHRvIGBhY3Rpdml0eSgpLnJlc3VsdHNgLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfLmVhY2goaW5Cb3VuZExvY2F0aW9ucywgZnVuY3Rpb24gKGxvY2F0aW9uRGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxvYyA9IGtvLm9ic2VydmFibGUobmV3IExvY2F0aW9uKGxvY2F0aW9uRGF0YSkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlcXVlc3QgZm91cnNxdWFyZSBkYXRhIGZvciBlYWNoIGxvY2F0aW9uICYgc2F2ZSB0aGUgcmVzdWx0cyBhcyBhIGxvY2F0aW9uIHByb3BlcnR5LlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdm0ucmVxdWVzdEZvdXJzcXVhcmVEYXRhKGxvYywgYWN0aXZpdHksIG1hcFZtLmFkZE1hcmtlcik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHkoKS5yZXN1bHRzLnB1c2gobG9jKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgdGhlIGFjdGl2aXR5IHdhcyBwcmV2aW91c2x5IG1hZGUgaW52aXNpYmxlIGR1ZSB0byB0aGVyZSBiZWluZyBubyBsb2NhdGlvbiByZXN1bHRzIGZvciBhXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHByZXZpb3VzIGdlb2xvY2F0aW9uLCBzZXQgdGhlIHZpc2liaWxpdHkgdG8gdHJ1ZSBzbyB0aGF0IHRoZSByZXN1bHRzIHdpbGwgYmUgZGlzcGxheWVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aXZpdHkoKS5ub1Jlc3VsdHNGb3JMYXN0R2VvbG9jYXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5KCkubm9SZXN1bHRzRm9yTGFzdEdlb2xvY2F0aW9uID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpdml0eSgpLnZpc2libGUodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZtLmFjdGl2aXRpZXMucHVzaChhY3Rpdml0eSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpdml0eSgpLnZpc2libGUoZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpdml0eSgpLm5vUmVzdWx0c0Zvckxhc3RHZW9sb2NhdGlvbiA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBzdGlsbCB3YW50IHRvIHNhdmUgdGhlIGFjdGl2aXR5IHNvIHRoYXQgaXQgY2FuIGJlIHF1ZXJpZWQgYWdhaW4gZm9yIG5ldyBnZW9sb2NhdGlvbnMuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZtLmFjdGl2aXRpZXMucHVzaChhY3Rpdml0eSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGVydCgnU29ycnksIHRoZXJlIGFyZSBubyBsb2NhdGlvbnMgZm9yICcgKyBhY3Rpdml0eSgpLnRpdGxlICsgJyBpbiB0aGUgY3VycmVudCBtYXAgYm91bmRzLicpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KCdTb3JyeSwgdGhlcmUgd2FzIGEgcHJvYmxlbSByZXRyaWV2aW5nIHJlc3VsdHMgZm9yIHRoZSBmb2xsb3dpbmcgcmVhc29uOiAnICsgc3RhdHVzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gc3VwcHJlc3NPdXRPZkJvdW5kc0xvY2F0aW9ucyhsb2NhdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgIHZhciBsb2NMYXQsIGxvY0xuZztcclxuICAgICAgICAgICAgICAgIHZhciBpbkJvdW5kTG9jYXRpb25zID0gW107XHJcbiAgICAgICAgICAgICAgICBfLmVhY2gobG9jYXRpb25zLCBmdW5jdGlvbiAobG9jYXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBsb2NMYXQgPSBsb2NhdGlvbi5nZW9tZXRyeS5sb2NhdGlvbi5sYXQoKTtcclxuICAgICAgICAgICAgICAgICAgICBsb2NMbmcgPSBsb2NhdGlvbi5nZW9tZXRyeS5sb2NhdGlvbi5sbmcoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gU3RvcmUgZWFjaCBgbG9jYXRpb25gIG9ubHkgaWYgaXQgaXMgY29udGFpbmVkIHdpdGhpbiB0aGUgbWFwIGJvdW5kYXJpZXMgYXQgY3VycmVudCB6b29tIGxldmVsLlxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChtYXBCb3VuZHMuSC5IIDwgbG9jTGF0ICYmIGxvY0xhdCA8IG1hcEJvdW5kcy5ILmogJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWFwQm91bmRzLmouSCA+IGxvY0xuZyAmJiBsb2NMbmcgPiBtYXBCb3VuZHMuai5qKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbkJvdW5kTG9jYXRpb25zLnB1c2gobG9jYXRpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBpbkJvdW5kTG9jYXRpb25zO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqICBSZXRyaWV2ZSBmb3Vyc3F1YXJlIGRhdGFcclxuICAgICAgICAgKi9cclxuICAgICAgICB2bS5yZXF1ZXN0Rm91cnNxdWFyZURhdGEgPSBmdW5jdGlvbiAobG9jYXRpb24sIGFjdGl2aXR5LCBjYWxsYmFjaykge1xyXG4gICAgICAgICAgICBmb3Vyc3F1YXJlU2VydmljZS5tYWtlUXVlcnlVcmwobG9jYXRpb24pO1xyXG4gICAgICAgICAgICBmb3Vyc3F1YXJlU2VydmljZS5nZXRDaGVja2luc0NvdW50Rm9yKGxvY2F0aW9uLCBhY3Rpdml0eSwgY2FsbGJhY2spO1xyXG4gICAgICAgIH07XHJcblxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiAgTG9jYXRpb25zIGZpbHRlciBmdW5jdGlvblxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHZtLmZpbHRlclF1ZXJ5LnN1YnNjcmliZShmdW5jdGlvbiBmaWx0ZXJBbGdvcml0aG0oKSB7XHJcblxyXG4gICAgICAgICAgICBpZiAoZmlsdGVySW5wdXRJc0VtcHR5KCkpIHtcclxuICAgICAgICAgICAgICAgIHVuZmlsdGVyUmVzdWx0cygpO1xyXG4gICAgICAgICAgICAgICAgbWFwVm0uc2hvd01hcmtlcnNGb3JWaXNpYmxlQWN0aXZpdGllcyh2bS5hY3Rpdml0aWVzKTtcclxuXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBmaWx0ZXJSZXN1bHRzKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIFRPRE86IHJlZGlzcGxheSBzZWxlY3RlZCBsb2NhdGlvbiBpbmZvIHdpbmRvdyBhZnRlciBmaWx0ZXIuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGZpbHRlclJlc3VsdHMoKSB7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIHZhciBhY3Rpdml0eVZpc2liaWxpdHlEdXJpbmdGaWx0ZXI7XHJcblxyXG4gICAgICAgICAgICAgICAgXy5lYWNoKHZtLmFjdGl2aXRpZXMoKSwgZnVuY3Rpb24gKGFjdGl2aXR5KSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChhY3Rpdml0eSgpLnJlc3VsdHMoKS5sZW5ndGggPiAwKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfLmVhY2goYWN0aXZpdHkoKS5yZXN1bHRzKCksIGZ1bmN0aW9uIChsb2NhdGlvbikge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEhpZGUgdGhlIGxvY2F0aW9uIGxpc3QgaXRlbXMgYW5kIG1hcCBtYXJrZXJzIGZvciBmaWx0ZXJlZC1vdXQgbG9jYXRpb25zLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoICEobG9jYXRpb24oKS5jb250YWlucyh2bS5maWx0ZXJRdWVyeSgpKSkgKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uKCkudmlzaWJsZShmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwVm0uaGlkZU1hcmtlcihsb2NhdGlvbik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsb2NhdGlvbigpLnNlbGVjdGVkKCkgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwVm0ucmVzZXRJbmZvV2luZG93KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGUgYGFjdGl2aXR5VmlzaWJpbGl0eUR1cmluZ0ZpbHRlcmAgYW5kIGBoYXNGaWx0ZXJSZXN1bHRzYCBzdGF0ZXMgd2lsbCBvbmx5IHJlbWFpblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZhbHNlIGlmIHRoZXJlIGFyZSB6ZXJvIGxvY2F0aW9uIHJlc3VsdHMgd2l0aGluIGFuIGFjdGl2aXR5IGNvbnRhaW5pbmcgdGhlIGZpbHRlclxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHF1ZXJ5IHN0cmluZy5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpdml0eVZpc2liaWxpdHlEdXJpbmdGaWx0ZXIgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpdml0eSgpLmhhc0ZpbHRlclJlc3VsdHMoZmFsc2UpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlLWRpc3BsYXkgcHJldmlvdXNseSBoaWRkZW4gbG9jYXRpb25zIGFuZCBtYXJrZXJzICh3aGVuIGBiYWNrc3BhY2VgIGlzIHByZXNzZWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZm9yIGluc3RhbmNlKS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbigpLnZpc2libGUodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHkoKS5oYXNGaWx0ZXJSZXN1bHRzKHRydWUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aXZpdHkoKS5jaGVja2VkKCkgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwVm0uc2hvd01hcmtlcihsb2NhdGlvbik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW9wZW4gaW5mbyB3aW5kb3cgZm9yIHNlbGVjdGVkIGxvY2F0aW9uLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobG9jYXRpb24oKS5zZWxlY3RlZCgpID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXBWbS5pbmZvV2luZG93KCkub3Blbih3aW5kb3cubWFwLCBsb2NhdGlvbigpLm1hcmtlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgYW55IGFjdGl2aXR5IGxvY2F0aW9ucyBoYXZlIGFyZSB2aXNpYmxlIGFnYWluLCBhbmQgaWYgc28gc2V0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGBhY3Rpdml0eVZpc2liaWxpdHlEdXJpbmdGaWx0ZXJgIHRvIHRydWUgKHNvIGxvbmcgYXMgdGhlIGFjdGl2aXR5IHdhcyBgY2hlY2tlZGAgcHJpb3IgdG9cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc3RhcnRpbmcgdGhlIGZpbHRlciBxdWVyeSkuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF8uc29tZShhY3Rpdml0eSgpLnJlc3VsdHMoKSwgZnVuY3Rpb24gKGxvY2F0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobG9jYXRpb24oKS52aXNpYmxlKCkgJiYgYWN0aXZpdHkoKS5jaGVja2VkKCkgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpdml0eVZpc2liaWxpdHlEdXJpbmdGaWx0ZXIgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5KCkuaGFzRmlsdGVyUmVzdWx0cyh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgdGhlIFVJIGFmdGVyIGV2ZXJ5IGtleXN0cm9rZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHkoKS52aXNpYmxlKGFjdGl2aXR5VmlzaWJpbGl0eUR1cmluZ0ZpbHRlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGZpbHRlcklucHV0SXNFbXB0eSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB2bS5maWx0ZXJRdWVyeSgpLnRyaW0oKSA9PT0gJyc7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIHVuZmlsdGVyUmVzdWx0cygpIHtcclxuICAgICAgICAgICAgICAgIF8uZWFjaCh2bS5hY3Rpdml0aWVzKCksIGZ1bmN0aW9uIChhY3Rpdml0eSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBfLmVhY2goYWN0aXZpdHkoKS5yZXN1bHRzKCksIGZ1bmN0aW9uIChsb2NhdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbigpLnZpc2libGUodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJlc2V0SW5pdGlhbFZpc2liaWxpdHkoYWN0aXZpdHkpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gcmVzZXRJbml0aWFsVmlzaWJpbGl0eShhY3Rpdml0eSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChhY3Rpdml0eSgpLnJlc3VsdHMoKS5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHkoKS52aXNpYmxlKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChhY3Rpdml0eSgpLmNoZWNrZWQoKSA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aXZpdHkoKS5yZXN1bHRzKCkubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHkoKS52aXNpYmxlKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHkoKS5oYXNGaWx0ZXJSZXN1bHRzKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGl2aXR5KCkucmVzdWx0cygpLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5KCkuaGFzRmlsdGVyUmVzdWx0cyh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gSGFjayB0byBwcmV2ZW50IHBhZ2UgcmVsb2FkIG9uIHRoZSBmaWx0ZXIgZm9ybSBzdWJtaXNzaW9uLlxyXG4gICAgICAgIHZtLnByZXZlbnREZWZhdWx0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAvLyAoZG8gbm90aGluZy4pXHJcbiAgICAgICAgfTtcclxuXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqICBVcGRhdGUgbG9jYXRpb25zIHdoZW4gdGhlIGdlb2xvY2F0aW9uIGNoYW5nZXNcclxuICAgICAgICAgKi9cclxuICAgICAgICBtYXBWbS5jdXJyZW50R2VvbG9jYXRpb24uc3Vic2NyaWJlKGZ1bmN0aW9uIHVwZGF0ZUxvY2F0aW9ucygpIHtcclxuXHJcbiAgICAgICAgICAgIHZhciBjb3B5O1xyXG5cclxuICAgICAgICAgICAgaWYgKHZtLmFjdGl2aXRpZXMoKSlcclxuICAgICAgICAgICAgICAgIGNvcHkgPSB2bS5hY3Rpdml0aWVzKCk7XHJcblxyXG4gICAgICAgICAgICAvLyBDbGVhciBjdXJyZW50bHkgZGlzcGxheWVkIG1hcCBtYXJrZXJzLCBhbmQgY2xlYXIgc3RvcmVkIExvY2F0aW9uIHJlc3VsdHMuIE9ubHkgY2xlYXJpbmcgdGhlIGVudGlyZVxyXG4gICAgICAgICAgICAvLyBgdm0uYWN0aXZpdGllcygpYCwgYXMgYmVsb3cgb2JqZWN0IGRvZXMgbm90IHVwZGF0ZSB0aGUgVUkgaW4gdGhlIHdheSBvbmUgd291bGQgZXhwZWN0OyB3aXRob3V0IGl0ZXJhdGluZ1xyXG4gICAgICAgICAgICAvLyBvdmVyIHRoZSBhY3Rpdml0eSByZXN1bHRzLCB0aGUgbG9jYXRpb24gcmVzdWx0cyBmb3IgdGhlIHByZXZpb3VzIGdlb2xvY2F0aW9uIGNvbnRpbnVlIHRvIGFwcGVhci5cclxuICAgICAgICAgICAgXy5lYWNoKHZtLmFjdGl2aXRpZXMoKSwgZnVuY3Rpb24gKGFjdGl2aXR5KSB7XHJcbiAgICAgICAgICAgICAgICBfLmVhY2goYWN0aXZpdHkoKS5yZXN1bHRzKCksIGZ1bmN0aW9uIChsb2NhdGlvbil7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24oKS5tYXJrZXIuc2V0TWFwKG51bGwpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBhY3Rpdml0eSgpLnJlc3VsdHMoW10pO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHZtLmFjdGl2aXRpZXMoW10pO1xyXG5cclxuICAgICAgICAgICAgLy8gVXBkYXRlIExvY2F0aW9uIHJlc3VsdHMgZm9yIG5ldyBHZW9sb2NhdGlvblxyXG4gICAgICAgICAgICBfLmVhY2goY29weSwgZnVuY3Rpb24gKGFjdGl2aXR5KSB7XHJcbiAgICAgICAgICAgICAgICB2bS5zZWFyY2hMb2NhdGlvbnMoYWN0aXZpdHkpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqICBTZWxlY3RlZCBsb2NhdGlvbiBmdW5jdGlvbnNcclxuICAgICAgICAgKi9cclxuICAgICAgICB2bS5zZWxlY3RMb2NhdGlvbiA9IGZ1bmN0aW9uIChsb2NhdGlvbikge1xyXG5cclxuICAgICAgICAgICAgLy8gVW4tc2VsZWN0IGFsbCBsb2NhdGlvbnMgc28gdGhhdCBvbmx5IG9uZSBsb2NhdGlvbiBhcHBlYXJzIHNlbGVjdGVkIGF0IGEgdGltZS5cclxuICAgICAgICAgICAgdm0uY2xlYXJDdXJyZW50U2VsZWN0aW9ucygpO1xyXG5cclxuICAgICAgICAgICAgLy8gVGhlIGBzZWxlY3RlZCgpYCBvYnNlcnZhYmxlIHByb3BlcnR5IGlzIHVzZWQgdG8gY29udHJvbCB0aGUgY3NzIGBiYWNrZ3JvdW5kLWNvbG9yYCBvZiB0aGUgbG9jYXRpb24gZWxlbWVudC5cclxuICAgICAgICAgICAgbG9jYXRpb24uc2VsZWN0ZWQodHJ1ZSk7XHJcbiAgICAgICAgICAgIHZtLnNlbGVjdGVkTG9jYXRpb24obG9jYXRpb24pO1xyXG5cclxuICAgICAgICAgICAgbWFwVm0uc2hvd0luZm9XaW5kb3cobG9jYXRpb24pO1xyXG4gICAgICAgICAgICBtYXBWbS5jZW50ZXJNYXBBdChsb2NhdGlvbik7XHJcbiAgICAgICAgICAgIG1hcFZtLmJvdW5jZUFuaW1hdGUobG9jYXRpb24ubWFya2VyKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2bS5jbGVhckN1cnJlbnRTZWxlY3Rpb25zID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBfLmVhY2godm0uYWN0aXZpdGllcygpLCBmdW5jdGlvbiAoYWN0aXZpdHkpIHtcclxuICAgICAgICAgICAgICAgIF8uZWFjaChhY3Rpdml0eSgpLnJlc3VsdHMoKSwgZnVuY3Rpb24gKGxvY2F0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24oKS5zZWxlY3RlZChmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdm0uYXNzaWduQ29sb3JzVG9Mb2NhdGlvbnMgPSBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZtLmdldFJlZmVyZW5jZVRvQWN0aXZpdGllc09iamVjdCA9IGZ1bmN0aW9uIChhY3Rpdml0aWVzKSB7XHJcbiAgICAgICAgICAgIHZtLmFjdGl2aXRpZXMgPSBhY3Rpdml0aWVzO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZtLnBhc3NTZWxmVG9NYXBWbSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgbWFwVm0ubG9jYXRpb25zVm0gPSB2bTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZtLnBhc3NTZWxmVG9NYXBWbSgpO1xyXG5cclxuICAgICAgICB2bS5wYXNzU2VsZWN0ZWRMb2NhdGlvblRvTWFwVm0gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIG1hcFZtLnNlbGVjdGVkTG9jYXRpb24odm0uc2VsZWN0ZWRMb2NhdGlvbik7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdm0uc2VsZWN0ZWRMb2NhdGlvbi5zdWJzY3JpYmUoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgIHZtLnBhc3NTZWxlY3RlZExvY2F0aW9uVG9NYXBWbSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICB3aW5kb3cuTG9jYXRpb25zVmlld01vZGVsID0gTG9jYXRpb25zVmlld01vZGVsO1xyXG5cclxufSkoKTtcclxuXHJcbiIsIlxyXG4oZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICB2YXIgQWN0aXZpdGllc1ZpZXdNb2RlbCA9IGZ1bmN0aW9uIChtYXBWbSwgbG9jYXRpb25zVm0pIHtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogIFRvcC1sZXZlbCB2YXJpYWJsZXMgYW5kIHByb3BlcnRpZXMgZm9yIGBBY3Rpdml0aWVzVmlld01vZGVsKClgXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdmFyIHZtID0gdGhpcztcclxuXHJcbiAgICAgICAgdm0uZGVmYXVsdEFjdGl2aXRpZXMgPSBbXHJcbiAgICAgICAgICAgICdDb2ZmZWUnLFxyXG4gICAgICAgICAgICAnVmVnZXRhcmlhbicsXHJcbiAgICAgICAgICAgICdQYXJrJyxcclxuICAgICAgICAgICAgJ01leGljYW4nLFxyXG4gICAgICAgICAgICAnQXJ0IEdhbGxlcnknXTtcclxuXHJcbiAgICAgICAgdm0uYWN0aXZpdGllcyA9IGtvLm9ic2VydmFibGVBcnJheSgpO1xyXG4gICAgICAgIHZtLmFjdGl2aXR5UXVlcnkgPSBrby5vYnNlcnZhYmxlKCk7XHJcblxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiAgRGlzcGxheSBsb2NhdGlvbnMgZm9yIGRlZmF1bHQgYWN0aXZpdGllc1xyXG4gICAgICAgICAqL1xyXG5cclxuICAgICAgICAgICAgLy8gU2VhcmNoIGZvciAoYW5kIGRpc3BsYXkpIGxvY2F0aW9ucyBmb3IgdGhlIGRlZmF1bHQgYWN0aXZpdGllcyBvbmNlIHRoZSBtYXAgaGFzIGZ1bGx5IGxvYWRlZCBhbmQgR29vZ2xlIFBsYWNlc1xyXG4gICAgICAgICAgICAvLyBTZXJ2aWNlIGlzIHJlYWR5IHRvIHJlY2VpdmUgcXVlcmllcy5cclxuICAgICAgICBtYXBWbS5yZWFkeVN0YXRlLnN1YnNjcmliZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChtYXBWbS5yZWFkeVN0YXRlKCkgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgIHZtLmRpc3BsYXlEZWZhdWx0QWN0aXZpdGllcygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHZtLmRpc3BsYXlEZWZhdWx0QWN0aXZpdGllcyA9IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgIHZtLnBhc3NSZWZlcmVuY2VUb0xvY2F0aW9uc1ZtKCk7XHJcblxyXG4gICAgICAgICAgICBfLmVhY2godm0uZGVmYXVsdEFjdGl2aXRpZXMsIGZ1bmN0aW9uIChhY3Rpdml0eU5hbWUpIHtcclxuICAgICAgICAgICAgICAgIHZhciBhY3Rpdml0eSA9IGtvLm9ic2VydmFibGUobmV3IEFjdGl2aXR5KGFjdGl2aXR5TmFtZSkpO1xyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25zVm0uc2VhcmNoTG9jYXRpb25zKGFjdGl2aXR5KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqICBOZXcgYWN0aXZpdHkgZnVuY3Rpb25zXHJcbiAgICAgICAgICovXHJcblxyXG4gICAgICAgICAgICAvLyBUT0RPOiBWYWxpZGF0ZSBpbnB1dCBhbmQgaGFuZGxlIGR1cGxpY2F0ZXMgKGFsc28gd2hhdCBkbyBkbyBhZnRlciBtYXAgaXMgcmVzaXplZCkuXHJcbiAgICAgICAgdm0uYWRkQWN0aXZpdHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBhY3Rpdml0eSA9IGtvLm9ic2VydmFibGUobmV3IEFjdGl2aXR5KHZtLmFjdGl2aXR5UXVlcnkoKSkpO1xyXG4gICAgICAgICAgICBsb2NhdGlvbnNWbS5zZWFyY2hMb2NhdGlvbnMoYWN0aXZpdHkpO1xyXG4gICAgICAgICAgICB2bS5hY3Rpdml0eVF1ZXJ5KCcnKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2bS5wYXNzUmVmZXJlbmNlVG9Mb2NhdGlvbnNWbSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgbG9jYXRpb25zVm0uZ2V0UmVmZXJlbmNlVG9BY3Rpdml0aWVzT2JqZWN0KHZtLmFjdGl2aXRpZXMpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZtLmFjdGl2aXRpZXMuc3Vic2NyaWJlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdm0ucGFzc1JlZmVyZW5jZVRvTG9jYXRpb25zVm0oKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdm0ucmVzZXRJbmZvV2luZG93V2hlblNlbGVjdGVkTG9jYXRpb25Ub2dnbGVkVmlzaWJsZSA9IGZ1bmN0aW9uIChhY3Rpdml0eSkge1xyXG5cclxuICAgICAgICAgICAgXy5lYWNoKGFjdGl2aXR5LnJlc3VsdHMoKSwgZnVuY3Rpb24gKGxvY2F0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobG9jYXRpb24oKS5zZWxlY3RlZCgpID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChhY3Rpdml0eS5jaGVja2VkKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBmYWxzZTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcFZtLnJlc2V0SW5mb1dpbmRvdygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgdHJ1ZTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcFZtLmluZm9XaW5kb3coKS5vcGVuKHdpbmRvdy5tYXAsIGxvY2F0aW9uKCkubWFya2VyKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIFxyXG4gICAgfTtcclxuXHJcbiAgICB3aW5kb3cuQWN0aXZpdGllc1ZpZXdNb2RlbCA9IEFjdGl2aXRpZXNWaWV3TW9kZWw7XHJcblxyXG59KCkpO1xyXG4iLCJcclxuKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBNYXN0ZXIgVmlld01vZGVsIGNvbnN0cnVjdG9yXHJcbiAgICAgKi9cclxuICAgIHZhciBBcHBWaWV3TW9kZWwgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHZtID0gdGhpcztcclxuXHJcbiAgICAgICAgdm0uZm91cnNxdWFyZVNlcnZpY2UgPSBuZXcgZm91cnNxdWFyZVNlcnZpY2UoKTtcclxuXHJcbiAgICAgICAgdm0uTWFwVmlld01vZGVsID0gbmV3IE1hcFZpZXdNb2RlbCh2bS5mb3Vyc3F1YXJlU2VydmljZSk7XHJcbiAgICAgICAgdm0uTG9jYXRpb25zVmlld01vZGVsID0gbmV3IExvY2F0aW9uc1ZpZXdNb2RlbCh2bS5NYXBWaWV3TW9kZWwsIHZtLmZvdXJzcXVhcmVTZXJ2aWNlKTtcclxuICAgICAgICB2bS5BY3Rpdml0aWVzVmlld01vZGVsID0gbmV3IEFjdGl2aXRpZXNWaWV3TW9kZWwodm0uTWFwVmlld01vZGVsLCB2bS5Mb2NhdGlvbnNWaWV3TW9kZWwpO1xyXG5cclxuICAgIH07XHJcblxyXG4gICAgd2luZG93LkFwcFZpZXdNb2RlbCA9IEFwcFZpZXdNb2RlbDtcclxuXHJcbn0oKSk7XHJcblxyXG5cclxuIiwiXHJcbihmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogIEluaXRpYWxpemUgdGhlIG1hc3RlciBWaWV3TW9kZWxcclxuICAgICAqL1xyXG4gICAgdmFyIGFwcCA9IG5ldyBBcHBWaWV3TW9kZWwoKTtcclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiAgUmVuZGVyIHRoZSBVSSBjb21wb25lbnRzLCBhbmQgYXBwbHkga25vY2tvdXQgZGF0YSBiaW5kaW5nc1xyXG4gICAgICovXHJcbiAgICBkaXNwbGF5Q29tcG9uZW50cyhbJ3NlYXJjaGJhcicsICdzaWRlYmFyJ10pO1xyXG5cclxuICAgIC8vIEZvciB0aGlzIHByb2plY3QsIEkgZGVjaWRlZCB0byBtYWtlIHRoaXMgY29tcG9uZW50IGxvYWRlciBpbiBsaWV1IG9mIHVzaW5nIHNvbWV0aGluZyBsaWtlIHJlcXVpcmVqcy4gSSBkaWRcclxuICAgIC8vIGF0dGVtcHQgdG8gaW1wbGVtZW50IHJlcXVpcmVqcywgYnV0IHRoZSBjb25zb2xlIGVycm9ycyBkaWRuJ3QgcHJvdmlkZSBtZSB3aXRoIHNwZWNpZmljIGVub3VnaCBpbmZvcm1hdGlvbiB0b1xyXG4gICAgLy8gc29ydCBvdXQgd2hhdCB3YXMgd3Jvbmcgd2l0aCBteSBjb2RlLiBJbiBhbnkgY2FzZSwgZm9yIHRoZSBzY29wZSBvZiB0aGlzIHNpbmdsZS1wYWdlLWFwcCwgbXkgc29sdXRpb24gc2VlbXMgdG9cclxuICAgIC8vIHdvcmsgZmluZS5cclxuICAgIGZ1bmN0aW9uIGRpc3BsYXlDb21wb25lbnRzKGNvbXBvbmVudHMpIHtcclxuXHJcbiAgICAgICAgdmFyICRjb21wb25lbnQsIHRlbXBsYXRlVXJsLCBpZCwgaHRtbDtcclxuICAgICAgICBfLmVhY2goY29tcG9uZW50cywgZnVuY3Rpb24gKGNvbXBvbmVudCkge1xyXG5cclxuICAgICAgICAgICAgdmFyIGNvbnRhaW5lciA9ICcjb3ZlcmxheS0nICsgY29tcG9uZW50O1xyXG4gICAgICAgICAgICAkY29tcG9uZW50ID0gJCgnPGRpdj4nKTtcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmwgPSAnLi9idWlsZC9jb21wb25lbnRzLycgKyBjb21wb25lbnQgKyAnLycgKyBjb21wb25lbnQgKyAnLmh0bWwnO1xyXG4gICAgICAgICAgICBpZCA9ICcjJyArIGNvbXBvbmVudDtcclxuXHJcbiAgICAgICAgICAgICRjb21wb25lbnQubG9hZCh0ZW1wbGF0ZVVybCwgaWQsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGh0bWwgPSAkKHRoaXMpLnByb3AoJ291dGVySFRNTCcpO1xyXG4gICAgICAgICAgICAgICAgJChjb250YWluZXIpLmFwcGVuZChodG1sKTtcclxuXHJcbiAgICAgICAgICAgICAgICBrby5hcHBseUJpbmRpbmdzKGFwcCwgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY29tcG9uZW50KSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqICBNYWtlIHRoZSBVSSBjb21wb25lbnRzIGRyYWdnYWJsZVxyXG4gICAgICovXHJcbiAgICAvLyBTb3JyeSEgSSBzdGlsbCBoYWQgdG8gc2xhbmcgYSBsaXR0bGUgYml0IG9mIGpRdWVyeSB1cCBpbiB0aGlzIGFwcC5cclxuICAgICQoZG9jdW1lbnQpLnJlYWR5KFxyXG4gICAgICAgIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgJCgnI292ZXJsYXktc2VhcmNoYmFyJykuZHJhZ2dhYmxlKCk7XHJcbiAgICAgICAgICAgICQoJyNvdmVybGF5LXNpZGViYXInKS5kcmFnZ2FibGUoKTtcclxuXHJcbiAgICAgICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjdG9nZ2xlLW1pbmltaXplLXNpZGViYXInLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICQodGhpcykucGFyZW50KCkudG9nZ2xlQ2xhc3MoJ3Nob3cnKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIH0pO1xyXG5cclxufSgpKTtcclxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
